// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{

}

useadrenaline()
{
    self endon( "disconnect" );
    self endon( "removeAdrenaline" );
    self notify( "force_regeneration" );
    scripts\mp\gamelogic::sethasdonecombat( self, 1 );
    adrenaline_missiononuse();
    self.adrenalinepoweractive = 1;
    self refreshsprinttime();
    childthread adrenaline_removeonplayernotifies();
    childthread adrenaline_removeondamage();
    childthread adrenaline_removeongameend();
    self setclientomnvar( "ui_health_regen_hud", 1 );
    return 1;
}

removeadrenaline()
{
    if ( istrue( self.adrenalinepoweractive ) )
    {
        self notify( "removeAdrenaline" );
        self.adrenalinepoweractive = undefined;
    }
}

onequipmenttaken( var_0, var_1 )
{
    removeadrenaline();
}

onequipmentfired( var_0, var_1, var_2 )
{
    if ( self isthrowingbackgrenade() )
    {
        self _meth_87A7();

        if ( isdefined( var_2 ) )
        {
            var_3 = self getweaponammoclip( var_2 );
            var_4 = int( max( var_3 - 1, 0 ) );
            self setweaponammoclip( var_2, var_4 );
        }
    }

    useadrenaline();
}

gethealthperframe()
{
    return 8;
}

adrenaline_removeonplayernotifies()
{
    scripts\engine\utility::_id_133EF( "death", "healed" );
    thread removeadrenaline();
}

adrenaline_removeondamage()
{
    for (;;)
    {
        self waittill( "damage", var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9 );

        if ( level.gametype == "br" && ( var_4 == "MOD_TRIGGER_HURT" || var_4 == "MOD_UNKNOWN" ) )
            continue;

        thread removeadrenaline();
        return;
    }
}

adrenaline_removeongameend()
{
    level waittill( "game_ended" );
    thread removeadrenaline();
}

adrenaline_missiononuse()
{
    if ( self.health >= self.maxhealth )
    {
        self.usedadrenalineatfullhp = 1;
        thread adrenaline_missionondeaththink();
    }
}

adrenaline_missionondeaththink()
{
    self endon( "disconnect" );
    level endon( "game_ended" );
    self notify( "adrenaline_missionOnDeathThink" );
    self endon( "adrenaline_missionOnDeathThink" );
    self waittill( "death" );
    self.usedadrenalineatfullhp = undefined;
}
