// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

initgulag()
{
    level._id_11F51 = getdvarfloat( "scr_br_respawn_circleInterpPct", 0.75 );

    if ( !istrue( level.usegulag ) )
        return;

    if ( scripts\mp\gametypes\br_gametypes.gsc::roof_enemy_groups( "gulag" ) )
    {
        level.usegulag = 0;
        return;
    }

    setomnvar( "ui_gulag_state", 1 );
    setomnvar( "ui_gulag_show_closing_state", 0 );
    level.gulag = spawnstruct();
    level.gulag.arenaflag = getdvarint( "scr_br_fc_flag", 1 );
    level.gulag.maxplayers = getmaxplayers();
    level.gulag.maxuses = getdvarint( "scr_br_fc_max_uses", 1 );
    level.gulag.endonshutdown = getdvarint( "scr_br_fc_end_on_shutdown", 3 );
    level.gulag.timelimit = getdvarint( "scr_br_fc_timelimit", 15.0 );
    level.gulag.maxqueue = getdvarint( "scr_br_fc_max_queue_wait", 3 );
    level.gulag.onekillwin = getdvarint( "scr_br_fc_one_kill_win", 1 );
    level.gulag.multiarena = getdvarint( "scr_br_fc_multi_arena", 1 );
    level.gulag.planerespawn = getdvarint( "scr_br_fc_plane_respawn", 0 );
    level.gulag.remove_on_death = getdvarint( "scr_br_fc_intro_cinematic", 1 );
    level.gulag._id_130FD = getdvarint( "scr_br_fc_useCellSpawns", 1 );
    level.gulag._id_13113 = getdvarint( "scr_br_fc_useFloorRocks", 0 );
    level.gulag._id_127F4 = getdvarint( "scr_br_fc_spawnLoot", 0 );
    level.gulag.lethaldelay = getdvarint( "scr_br_fc_lethalDelay", 4 );
    level.gulag._id_12A77 = getdvarint( "scr_br_fc_prestream_geo_timeout", 9 );
    level.gulag.trial_trigger_activated_func = getdvarint( "scr_br_fc_numArmorHealth", 0 );
    level.gulag.trial_start_time = getdvarint( "scr_br_gulag_nuketown", 0 );
    level.gulag.gas_cloud_vfx = getdvarint( "scr_br_fc_countdownTime", 3 );
    level.gulag.give_player_class_abilities = getdvarint( "scr_br_fc_defaultPlunder", 5 );
    level.gulag.droporigin = getdvarint( "scr_br_gulag_chair", 0 );
    level.gulag._id_1334C = getdvarint( "scr_br_gulag_voices", 1 );
    _setdomflagiconinfo( "waypoint_captureneutral", "neutral", "MP_BR_INGAME/DOM_CAPTURE", 0 );
    _setdomflagiconinfo( "waypoint_capture", "enemy", "MP_BR_INGAME/DOM_CAPTURE", 0 );
    _setdomflagiconinfo( "waypoint_defend", "friendly", "MP_INGAME_ONLY/OBJ_DEFEND_CAPS", 0 );
    _setdomflagiconinfo( "waypoint_defending", "friendly", "MP_INGAME_ONLY/OBJ_DEFENDING_CAPS", 0 );
    _setdomflagiconinfo( "waypoint_contested", "contest", "MP_INGAME_ONLY/OBJ_CONTESTED_CAPS", 1 );
    _setdomflagiconinfo( "waypoint_taking", "friendly", "MP_INGAME_ONLY/OBJ_TAKING_CAPS", 1 );
    _setdomflagiconinfo( "waypoint_losing", "enemy", "MP_INGAME_ONLY/OBJ_LOSING_CAPS", 1 );
    level.gulag.settings_group = [];

    if ( istrue( level.gulag.arenaflag ) )
        scripts\mp\gametypes\br_dom_quest.gsc::_id_12442();

    _id_12481();
    level.gulag.arenas = gulaggetarenas();
    gulaggesturesinit();
    gulaginitloadouts();

    if ( level.gulag.remove_on_death )
        scripts\mp\utility\lui_game_event_aggregator::registeronluieventcallback( ::weapon_class );

    if ( level.gulag._id_13113 )
        scripts\engine\scriptable::_id_1219E( "brloot_rock", ::rockused );

    level.gulag.betting = getdvarint( "scr_br_fc_betting", 0 );

    if ( level.gulag.betting )
    {
        if ( !istrue( level.br_plunder_enabled ) )
            level.gulag.betting = 0;

        if ( getdvarint( "scr_br_fc_countdownTime", 3 ) == 3 )
            level.gulag.gas_cloud_vfx = 15;
    }

    if ( !isdefined( level.gulag.arenas[0].jailspawns[0].chair ) )
        level.gulag.droporigin = 0;

    foreach ( var_1 in level.gulag.arenas )
        level thread monitorgulag( var_1 );

    thread spawnac130();
    relic_nuketimer_waitforcompleteobjectives();
    level.lootchopper_createobjective = ::_id_11D87;
    level.lootchopper_getspawnlocations = ::_id_11D89;
}

_setdomflagiconinfo( var_0, var_1, var_2, var_3 )
{
    level.waypointcolors[var_0] = var_1;
    level.waypointbgtype[var_0] = 1;
    level.waypointstring[var_0] = var_2;
    level.waypointshader[var_0] = "ui_mp_br_mapmenu_icon_gulag_overtime_objective";
    level.waypointpulses[var_0] = var_3;
}

relic_nuketimer_waitforcompleteobjectives()
{
    game["dialog"]["gulag_spawn"] = "gulag_spawn";
    game["dialog"]["gulag_spawn_rules"] = "gulag_spawn_rules";
    game["dialog"]["gulag_objective"] = "gulag_objective";
    game["dialog"]["gulag_next"] = "gulag_next";
    game["dialog"]["gulag_win"] = "gulag_win";
    game["dialog"]["gulag_lose"] = "gulag_lose";
    game["dialog"]["gulag_teammate_gulag"] = "gulag_teammate_gulag";
    game["dialog"]["gulag_teammate_lose"] = "gulag_teammate_lose";
    game["dialog"]["gulag_teammate_win"] = "gulag_teammate_win";
    game["dialog"]["gulag_gulag_active"] = "gulag_gulag_active";
    game["dialog"]["gulag_gulag_close"] = "gulag_gulag_close";
    game["dialog"]["gulag_noenemy"] = "gulag_noenemy";
    game["dialog"]["gulag_timeout"] = "gulag_timeout";
    game["dialog"]["gulag_buyback"] = "gulag_buyback";
    game["dialog"]["gulag_taunt"] = "gulag_taunt";
    game["dialog"]["gulag_obj_wait"] = "gulag_obj_wait";
}

gulaggetarenas()
{
    var_0 = never_kill_off_after_stealth();

    if ( scripts\mp\gametypes\br_public.gsc::revive_or_disconnect_monitor() )
        var_0 = scripts\engine\utility::getstructarray( "gulag_tutorial", "targetname" );

    for ( var_1 = 0; var_1 < var_0.size; var_1++ )
    {
        var_2 = var_0[var_1];
        var_2.pickup_saw_and_start_mission = var_1;
        setuparena( var_2 );
    }

    return var_0;
}

never_kill_off_after_stealth()
{
    var_0 = scripts\engine\utility::getstructarray( "gulag", "targetname" );
    var_1 = [];

    foreach ( var_3 in var_0 )
    {
        var_4 = isdefined( var_3.script_noteworthy ) && var_3.script_noteworthy == "nuketown";

        if ( istrue( level.gulag.trial_start_time ) && var_4 || !istrue( level.gulag.trial_start_time ) && !var_4 )
            var_1[var_1.size] = var_3;
    }

    if ( var_1.size > 0 )
        var_0 = var_1;

    if ( var_0.size > 1 )
        var_0 = scripts\engine\utility::array_randomize( var_0 );

    return var_0;
}

setuparena( var_0 )
{
    var_0.jailspawns = [];
    var_0.fightspawns = [];
    var_0.dropoff = [];
    var_0.gates = [];
    var_0.floor = [];
    var_0.weapons = [];
    var_0.molotovs = [];
    var_0._id_12C44 = [];
    var_0.dropped_weapon_cleanup = [];
    var_0._id_12033 = [];
    var_0.jailedplayers = [];
    var_0.arenaplayers = [];
    var_0.matches = [];
    var_0.loadingplayers = [];
    var_0.fightover = 1;
    var_0.tutdmzonplayerkilled = [];
    var_0.tutdmzonplayerkilled["ui_br_gulag_players_1"] = 0;
    var_0.tutdmzonplayerkilled["ui_br_gulag_data"] = 0;
    var_1 = [];
    var_2 = scripts\engine\utility::getstructarray( var_0.target, "targetname" );

    foreach ( var_4 in var_2 )
    {
        if ( var_4.script_noteworthy == "prison_spawn" )
        {
            var_0.jailspawns[var_0.jailspawns.size] = var_4;
            continue;
        }

        if ( var_4.script_noteworthy == "fight_spawn" )
        {
            var_0.fightspawns[var_0.fightspawns.size] = var_4;
            continue;
        }

        if ( var_4.script_noteworthy == "cell_spawn" )
        {
            var_0.dropoff[var_0.dropoff.size] = var_4;
            continue;
        }

        if ( var_4.script_noteworthy == "gulag_center" )
        {
            var_0.center = var_4.origin;
            continue;
        }

        if ( var_4.script_noteworthy == "spectator" )
        {
            var_0._id_12858 = var_4;
            continue;
        }

        if ( isdefined( var_4.script_parameters ) && var_4.script_parameters == "gulag_loot" )
        {
            var_1[var_1.size] = var_4;
            continue;
        }

        if ( var_4.script_noteworthy == "voices" )
            var_0._id_12033[var_0._id_12033.size] = var_4;
    }

    if ( !isdefined( var_0.center ) )
        var_0.center = getgulagcenter( var_0 );

    if ( getdvarint( "scr_br_fc_shifted_spawns", 1 ) > 0 )
        var_0.fightspawns = scripts\engine\utility::array_sort_with_func( var_0.fightspawns, ::forced_revive );
    else
        var_0.fightspawns = scripts\engine\utility::array_sort_with_func( var_0.fightspawns, ::forcedisablelaststand );

    foreach ( var_7 in var_0.dropoff )
        _id_12438( var_0, var_7 );

    var_0.dropoff = scripts\engine\utility::array_sort_with_func( var_0.dropoff, ::forcedisablelaststand );

    foreach ( var_10 in var_0.jailspawns )
        _id_1245B( var_0, var_10 );

    if ( istrue( level.gulag._id_127F4 ) )
        var_0.weapons = spawnlootweapons( var_1 );

    spawnrocks( var_0 );

    if ( istrue( level.gulag.arenaflag ) )
        _id_12443( var_0 );

    thread _id_129EA( var_0 );
}

gulaggesturesinit()
{
    level.gulag.gestures_enabled = getdvarint( "scr_br_fc_gestures", 0 );

    if ( !istrue( level.gulag.gestures_enabled ) )
        return;

    level.gulag.gestures = [];
    level.gulag.gestures["fc_gesture_neg"] = [ "iw8_ges_plyr_gesture_crush", "iw8_ges_plyr_gesture_rally", "iw8_ges_plyr_gesture_revive" ];
    level.gulag.gestures["fc_gesture_pos"] = [ "iw8_ges_plyr_gesture_doubletime", "iw8_ges_plyr_gesture_hold", "iw8_ges_plyr_gesture_ok", "iw8_ges_plyr_gesture_thumbs_up" ];
    level.gulag.gesturesounds["fc_gesture_neg"] = [ "tmp_gulag_gesture_neg_crush", "tmp_gulag_gesture_neg_rally", "tmp_gulag_gesture_neg_revive" ];
    level.gulag.gesturesounds["fc_gesture_pos"] = [ "tmp_gulag_gesture_pos_doubletime", "tmp_gulag_gesture_pos_hold", "tmp_gulag_gesture_pos_ok", "tmp_gulag_gesture_pos_thumbs_up" ];
}

getmaxplayers()
{
    var_0 = int( clamp( getdvarint( "scr_br_fc_max_players", 2 ), 2, 2 ) );

    if ( var_0 % 2 != 0 )
        var_0 = var_0 - 1;

    return var_0;
}

forcedisablelaststand( var_0, var_1 )
{
    return var_0.script_index < var_1.script_index;
}

forced_revive( var_0, var_1 )
{
    if ( var_0.script_index == 4 )
        return 1;
    else if ( var_0.script_index == 5 )
        return 1;
    else if ( var_1.script_index == 4 )
        return 0;
    else if ( var_1.script_index == 5 )
        return 0;

    return forcedisablelaststand( var_0, var_1 );
}

copystructwithoffset( var_0, var_1, var_2 )
{
    var_3 = spawnstruct();
    var_3.origin = var_0.origin + var_1;
    var_3.angles = var_0.angles;
    var_3.script_index = var_2;
    return var_3;
}

getgulagcenter( var_0 )
{
    var_1 = ( 0, 0, 0 );

    foreach ( var_3 in var_0.fightspawns )
        var_1 = var_1 + var_3.origin;

    var_1 = var_1 / var_0.fightspawns.size;
    return var_1;
}

spawnweapon( var_0, var_1, var_2 )
{
    var_3 = scripts\mp\gametypes\br_weapons.gsc::createspawnweaponatpos( getgroundposition( var_0.origin + ( 0, 0, 12 ), 12 ), var_0.angles + ( 0, 0, 90 ), var_1, [] );
    var_3 thread outlinewatchplayerprox( var_2 );
    return var_3;
}

spawnlootweapons( var_0 )
{
    var_1 = [];
    var_2 = [];
    var_2["none"] = [ "none" ];
    var_2["tactical"] = scripts\mp\gametypes\br_pickups.gsc::getgulagpickupsforclass( "tactical" );
    var_2["lethal"] = scripts\mp\gametypes\br_pickups.gsc::getgulagpickupsforclass( "lethal" );
    var_3 = [];

    foreach ( var_5 in var_2 )
    {
        foreach ( var_7 in var_5 )
        {
            var_8 = 1;

            if ( isdefined( var_3[var_7] ) )
                continue;

            var_9 = level.br_lootiteminfo[var_7];

            if ( isdefined( var_9 ) )
            {
                var_10 = level.br_lootiteminfo[var_7].baseweapon + "_mp";
                var_8 = weaponclipsize( var_10 ) * 1;
            }

            var_3[var_7] = var_8;
        }
    }

    var_13 = [ "tactical", "tactical", "lethal", "lethal", "lethal" ];
    var_13 = scripts\engine\utility::array_randomize( var_13 );
    var_14 = [];
    var_14["floor_center_01"] = scripts\engine\utility::random( var_2[var_13[0]] );
    var_14["floor_center_02"] = scripts\engine\utility::random( var_2[var_13[1]] );
    var_14["floor_right_01"] = scripts\engine\utility::random( var_2[var_13[2]] );
    var_14["floor_left_01"] = scripts\engine\utility::random( var_2[var_13[3]] );
    var_14["floor_mid_01"] = scripts\engine\utility::random( var_2[var_13[4]] );

    if ( getdvarint( "scr_br_fc_shifted_spawns", 1 ) > 0 )
        var_14["floor_left_01"] = var_14["floor_right_01"];

    foreach ( var_16 in var_0 )
    {
        if ( !isdefined( var_16.script_noteworthy ) )
            continue;

        var_17 = var_14[var_16.script_noteworthy];

        if ( !isdefined( var_17 ) )
            continue;

        if ( var_17 == "none" )
            continue;

        var_18 = var_16.origin;
        var_19 = var_16.angles;

        if ( !isdefined( var_19 ) )
            var_19 = ( 0, 0, 0 );
        else
            var_19 = ( 0, var_19[1], 0 );

        var_7 = easepower( var_17, var_18, var_19 );

        if ( isdefined( var_7 ) )
        {
            var_7.part = var_17;
            scripts\mp\gametypes\br_pickups.gsc::spawn_lmg_soldiers_04( var_7, var_3[var_17] );
            var_7.keepinmap = 1;
            var_1[var_1.size] = var_7;
            continue;
        }
    }

    return var_1;
}

zombiehealth( var_0 )
{
    if ( zombiehud( var_0 ) )
    {
        var_1 = var_0.matches[0];

        foreach ( var_3 in var_1 )
        {
            if ( var_3 == self )
                continue;
            else if ( rungwperifeffets( var_3, var_0 ) )
                return 0;
        }

        return 1;
    }

    return 0;
}

zombiehud( var_0 )
{
    if ( ismatchpending( var_0 ) )
    {
        var_1 = var_0.matches[0];

        foreach ( var_3 in var_1 )
        {
            if ( var_3 == self )
                return 1;
        }
    }

    return 0;
}

ismatchpending( var_0 )
{
    if ( var_0.matches.size == 0 )
        return 0;

    var_1 = var_0.matches[0];

    if ( var_1.size < 2 )
        return 0;

    return 1;
}

isfightready( var_0 )
{
    if ( !ismatchpending( var_0 ) )
        return 0;

    var_1 = var_0.matches[0];

    foreach ( var_3 in var_1 )
    {
        if ( istrue( var_3.entergulagwait ) || !istrue( var_3.jailed ) )
            return 0;
    }

    return 1;
}

pickrandomvehiclespawn( var_0 )
{
    var_1 = 5000;

    if ( !isdefined( var_0.train_get_num_of_anim_ents ) )
    {
        var_0.train_get_num_of_anim_ents = gettime() + var_1;
        return;
    }

    if ( gettime() > var_0.train_get_num_of_anim_ents )
    {
        var_0.jailedplayers = scripts\engine\utility::array_removeundefined( var_0.jailedplayers );
        updatematchqueuepositions( var_0 );

        if ( var_0.pickup_saw_and_start_mission == 0 )
        {
            level.gulag.settings_group = scripts\engine\utility::array_removeundefined( level.gulag.settings_group );

            foreach ( var_3 in level.gulag.settings_group )
            {
                if ( !istrue( var_3.inlaststand ) )
                    level.gulag.settings_group = scripts\engine\utility::array_remove( level.gulag.settings_group, var_3 );
            }
        }

        var_0.train_get_num_of_anim_ents = gettime() + var_1;
    }
}

monitorgulag( var_0 )
{
    level endon( "game_ended" );
    var_1 = mp_hardhat_patch();

    for (;;)
    {
        pickrandomvehiclespawn( var_0 );

        if ( istrue( level.br_prematchstarted ) )
        {
            if ( istrue( level.gulag.shutdown ) )
            {
                if ( var_0.loadingplayers.size != 0 )
                    var_0 scripts\engine\utility::waittill_notify_or_timeout( "loadingPlayersEmpty", var_1 );

                if ( level.gulag.endonshutdown == 1 )
                {
                    foreach ( var_3 in var_0.jailedplayers )
                    {
                        var_3.gulagloser = 1;
                        var_3 kill();
                    }

                    var_0.shutdown = 1;
                }
                else if ( level.gulag.endonshutdown == 2 )
                    thread dojailbreak( var_0 );
                else if ( level.gulag.endonshutdown == 3 && ( istrue( var_0.shutdown ) || !ismatchpending( var_0 ) && !bot_gametype_human_player_always_attacker() ) )
                {
                    foreach ( var_3 in var_0.jailedplayers )
                    {
                        if ( isalive( var_3 ) )
                        {
                            var_3 playergulagarenaready();
                            thread gulagvictory( var_0, var_3, 1, 0, "shutdown" );
                        }
                    }

                    var_0.shutdown = 1;
                }
            }

            if ( rotations() )
            {
                waitframe();
                continue;
            }

            if ( isfightready( var_0 ) )
                beginnewfight( var_0 );
            else
                _id_1238C( var_0 );
        }

        waitframe();
    }
}

vehicle_compass_shouldbevisibletoplayer( var_0 )
{
    if ( !istrue( level.usegulag ) )
        return;

    level.gulag.paused = var_0;
}

rotations()
{
    return istrue( level.usegulag ) && istrue( level.gulag.paused );
}

bot_start()
{
    if ( !istrue( level.usegulag ) )
        return 0;

    foreach ( var_1 in level.gulag.arenas )
    {
        if ( !var_1.fightover )
            return 1;
    }

    return 0;
}

scriptable_carriable_use()
{
    if ( isdefined( self ) && isalive( self ) )
        gulagvictory( self.arena, self, 1, 1, "jailbreakEvent" );
}

circletimer( var_0 )
{
    if ( istrue( level.usegulag ) && !istrue( level.gulag.shutdown ) )
    {
        var_1 = nextstar();

        if ( var_0 >= var_1 )
            shutdowngulag( "circle_index", var_0 );
    }
}

shutdowngulag( var_0, var_1, var_2 )
{
    if ( !istrue( level.usegulag ) || istrue( level.gulag.shutdown ) )
        return;

    setomnvar( "ui_gulag_state", 0 );
    setomnvar( "ui_gulag_show_closing_state", 2 );
    level.gulag.shutdown = 1;
    thread makeac130flyaway();

    if ( !istrue( var_2 ) )
    {
        foreach ( var_4 in level.players )
        {
            if ( istrue( var_4.inlaststand ) )
            {
                level.gulag.settings_group[level.gulag.settings_group.size] = var_4;
                continue;
            }

            if ( !isdefined( var_4 ) || !isalive( var_4 ) || isdefined( var_4.gulag ) )
                continue;

            var_4 playergulagdonesplash();
        }
    }

    getentitylessscriptablearray( "dlog_event_br_gulag_shutdown", [ "reason", var_0, "reason_count", var_1 ] );
}

bot_gametype_human_player_always_attacker()
{
    return level.gulag.settings_group.size > 0;
}

yaw_delta()
{
    if ( !istrue( level.usegulag ) || !istrue( level.gulag.shutdown ) )
        return 0;

    return scripts\engine\utility::array_contains( level.gulag.settings_group, self );
}

pickup_truck_initdamage( var_0 )
{
    if ( istrue( level.gulag.shutdown ) && bot_gametype_human_player_always_attacker() )
    {
        if ( isdefined( var_0 ) && var_0 yaw_delta() )
        {
            level.gulag.settings_group = scripts\engine\utility::array_remove( level.gulag.settings_group, var_0 );
            return 1;
        }
        else
            level.gulag.settings_group = scripts\engine\utility::array_removeundefined( level.gulag.settings_group );
    }

    return 0;
}

onplayerdisconnect( var_0 )
{
    if ( !istrue( level.usegulag ) )
        return;

    pickup_truck_initdamage( var_0 );
}

weapon_xp_iw8_sm_mpapa7( var_0 )
{
    if ( !istrue( level.usegulag ) )
        return;

    if ( istrue( var_0 ) )
    {
        self.setroundwinstreakspecialcamos = undefined;

        if ( pickup_truck_initdamage( self ) )
            playergulagdonesplash();
    }
}

nextstar()
{
    if ( !isdefined( level.br_level ) || !isdefined( level.br_level.br_circledelaytimes ) )
        return 0;

    var_0 = level.br_level.cleanupafterweaponswitch;

    if ( !isdefined( var_0 ) )
        var_0 = 0;

    return level.br_level.br_circledelaytimes.size - 1 - getdvarint( "scr_br_fc_circle_disable", 3 ) - var_0;
}

_id_12450()
{
    var_0 = onplayerconnectrisk();
    var_1 = gettime() + var_0 * 1000;
    setomnvar( "ui_gulag_timer", var_1 );
    thread _id_12533( var_0 );
}

_id_12533( var_0 )
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    var_1 = getdvarint( "scr_br_display_gulag_close_message", 90 );
    var_2 = var_0 - var_1;

    if ( 0 < var_2 )
    {
        wait( var_2 );
        setomnvar( "ui_gulag_show_closing_state", 1 );
    }
}

onplayerconnectrisk()
{
    var_0 = 0;

    if ( isdefined( level.br_level ) && isdefined( level.br_level.circleradius ) )
    {
        var_1 = nextstar();

        for ( var_2 = 0; var_2 < var_1; var_2++ )
        {
            var_3 = level.br_level.br_circledelaytimes[var_2];
            var_4 = level.br_level.br_circleclosetimes[var_2];
            var_0 = var_0 + var_3 + var_4;
        }
    }

    return int( var_0 );
}

playergulagdonesplash()
{
    if ( istrue( self.gulagdone ) )
        return;

    self.gulagdone = 1;
    scripts\mp\gametypes\br_killstreaks.gsc::getfilterformodifier( self, "gulag_closed", undefined, 2 );
    scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_gulag_close", self );

    if ( istrue( level.br_pickups._id_11F65 ) && scripts\mp\gametypes\br_public.gsc::hasrespawntoken() )
    {
        scripts\mp\gametypes\br_pickups.gsc::removerespawntoken();
        thread scripts\mp\hud_message::showsplash( "br_respawn_token_disabled" );
        thread scripts\mp\utility\points::giveunifiedpoints( "br_respawn_token_convert" );
    }
}

dojailbreak( var_0 )
{
    if ( var_0.jailedplayers.size == 0 )
    {
        var_0.shutdown = 1;
        return;
    }

    var_0.isjailbreak = 1;
    var_0.arenaplayers = scripts\engine\utility::array_removeundefined( var_0.jailedplayers );
    jailbreaktimerwait( var_0 );
    var_1 = getloadoutindex();

    foreach ( var_3 in var_0.arenaplayers )
    {
        var_3 thread pilot_linkto_origin_offset( var_0 );
        var_3 initplayerarena( var_0, 1, var_1 );

        if ( istrue( level.gulag.gestures_enabled ) && !isbot( var_3 ) )
            var_3 playergulaggesturesdisable();

        if ( getdvarint( "scr_br_fc_outline_countdown", 1 ) > 0 && var_0.arenaplayers.size > 0 )
            var_3 hudoutlinedisableforclients( var_0.arenaplayers );
    }

    playsoundatpos( var_0.center, "iw8_mp_snatch_fight_start" );
    var_0.fightover = 0;

    if ( !isoneteamleft( var_0 ) )
    {
        var_0.time = level.gulag.timelimit;
        updatematchtimerhud( var_0, var_0.time );
        waittillgulagmatchend( var_0, 0 );
    }
    else
    {
        var_0.time = 8;
        updatematchtimerhud( var_0, var_0.time );
        wait( var_0.time );
    }

    foreach ( var_3 in var_0.arenaplayers )
    {
        if ( isdefined( var_3 ) && isdefined( var_3.gulagjailbreakhud ) )
            var_3.gulagjailbreakhud destroy();
    }

    handleendarena( var_0 );
    var_0.shutdown = 1;
}

jailbreaktimerwait( var_0 )
{
    foreach ( var_2 in var_0.arenaplayers )
    {
        if ( !isdefined( var_2 ) )
            continue;

        var_2 thread scripts\mp\hud_message::showsplash( "br_gulag_jail_break" );

        if ( getdvarint( "scr_br_fc_outline_countdown", 1 ) > 0 )
            var_2 hudoutlineenableforclients( var_0.arenaplayers, "outline_nodepth_red" );
    }

    wait 3;

    foreach ( var_2 in var_0.arenaplayers )
    {
        if ( !isdefined( var_2 ) )
            continue;

        var_2 playeraddjailbreaktimer();
    }

    gulagcountdowntimer( var_0, 0 );

    foreach ( var_2 in var_0.arenaplayers )
    {
        if ( !isdefined( var_2 ) )
            continue;

        var_2 setclientomnvar( "ui_match_start_countdown", 0 );
        var_2 setclientomnvar( "ui_match_in_progress", 1 );

        if ( isdefined( var_2 ) && isdefined( var_2.gulagjailbreakhud ) )
            var_2.gulagjailbreakhud.label = &"MP/BR_GULAG_JAILBREAK";
    }
}

playeraddjailbreaktimer()
{
    self.gulagjailbreakhud = scripts\mp\hud_util::createfontstring( "default", 2 );
    self.gulagjailbreakhud scripts\mp\hud_util::setpoint( "CENTER", "CENTER", 0, -150 );
    self.gulagjailbreakhud.label = &"MP/BR_GULAG_JAILBREAK_IN";
}

resetequipment( var_0 )
{
    if ( !istrue( level.gulag._id_127F4 ) )
        return;

    for ( var_1 = 0; var_1 < var_0.weapons.size; var_1++ )
    {
        var_2 = var_0.weapons[var_1];
        var_2 setscriptablepartstate( var_2.part, "visible" );
    }
}

validateplayers( var_0 )
{
    return var_0.arenaplayers.size >= 2;
}

beginnewfight( var_0 )
{
    level endon( "game_ended" );
    var_0 endon( "fight_over_early" );
    var_0.fightover = 0;
    resetequipment( var_0 );
    _id_11F22( var_0 );
    var_0.arenaplayers = popnextmatch( var_0 );
    var_1 = 0;

    foreach ( var_4, var_3 in var_0.arenaplayers )
    {
        if ( isdefined( var_3 ) )
            var_0.jailedplayers = scripts\engine\utility::array_remove( var_0.jailedplayers, var_3 );

        if ( !isdefined( var_3 ) )
        {
            var_1 = 1;
            continue;
        }

        if ( var_3.gulag == 0 || var_3.jailed == 0 || var_3.gulagarena == 1 )
        {
            scripts\mp\utility\script::handle_train_veh_collision( "Player: " + var_3.name + " - invalid for gulag - p.gulag = " + var_3.gulag + ", p.jailed = " + var_3.jailed + ", p.gulagArena = " + var_3.gulagarena );
            var_1 = 1;
            continue;
        }

        var_3.fighterindex = var_4;
    }

    foreach ( var_6 in var_0.jailedplayers )
    {
        if ( !isdefined( var_6 ) )
            continue;

        var_6.gulagposition--;
        var_6 setweaponammoclip( "rock_mp", 5 );
    }

    if ( var_1 )
    {
        var_0.jailedplayers = scripts\engine\utility::array_removeundefined( var_0.jailedplayers );
        var_0.arenaplayers = scripts\engine\utility::array_removeundefined( var_0.arenaplayers );

        if ( !validateplayers( var_0 ) )
        {
            handleendarena( var_0, undefined, 1 );
            return;
        }
    }

    var_8 = startbetting( var_0, var_0.arenaplayers );

    if ( getdvarint( "scr_br_fc_spectate_outlines", 0 ) )
        thread manageoutlines( var_0, var_0.arenaplayers, var_8 );

    var_0.arenaspawncounter = 0;
    var_9 = getloadoutindex();

    foreach ( var_6 in var_0.arenaplayers )
    {
        if ( !isdefined( var_6 ) )
            continue;

        var_6 thread pilot_linkto_origin_offset( var_0, var_8 );
        var_6 thread initplayerarena( var_0, 0, var_9 );
    }

    thread watchlethaldelay( var_0 );
    wait 2;

    if ( !validateplayers( var_0 ) )
    {
        handleendarena( var_0, var_8, 1 );
        return;
    }

    _id_13068( var_0 );
    _id_13067( var_0 );
    var_12 = gulagcountdowntimer( var_0, 1, var_8 );

    if ( !var_12 )
        return;

    endbetting( var_0, var_8 );

    foreach ( var_6 in var_0.arenaplayers )
    {
        var_6 playergulagarenaready();
        var_6 thread _id_119C1();
    }

    thread _id_129B7( var_0 );
    var_0.time = level.gulag.timelimit;
    updatematchtimerhud( var_0, var_0.time );
    waittillgulagmatchend( var_0, 1 );
    handleendarena( var_0, var_8 );

    if ( !isfightready( var_0 ) )
        _id_130A7( var_0 );
}

watchlethaldelay( var_0 )
{
    var_0 endon( "fight_over" );
    var_0 endon( "matchEnded" );
    level endon( "game_ended" );

    if ( level.gulag.lethaldelay <= 0 )
        return;

    var_0.lethaldelaystarttime = gettime();
    var_0.lethaldelayendtime = var_0.lethaldelaystarttime + level.gulag.lethaldelay * 1000 + level.gulag.gas_cloud_vfx * 1000 + 2000;

    while ( gettime() < var_0.lethaldelayendtime )
        waitframe();

    var_0 notify( "lethal_delay_end" );
}

watchlethaldelayplayer( var_0 )
{
    self endon( "death_or_disconnect" );
    level endon( "game_ended" );

    if ( level.gulag.lethaldelay == 0 )
        return;

    if ( !isai( self ) )
    {
        self notifyonplayercommand( "lethal_attempt_gulag", "+frag" );
        self notifyonplayercommand( "lethal_attempt_gulag", "+smoke" );
    }

    scripts\mp\equipment::allow_equipment_slot( "primary", 0 );
    scripts\mp\equipment::allow_equipment_slot( "secondary", 0 );
    watchlethaldelayfeedbackplayer( var_0, self );
    scripts\mp\equipment::allow_equipment_slot( "primary", 1 );
    scripts\mp\equipment::allow_equipment_slot( "secondary", 1 );

    if ( scripts\cp_mp\utility\game_utility::isrealismenabled() )
        self playlocalsound( "ui_restock_lethals" );

    self setclientomnvar( "ui_recharge_notify", 2 );

    if ( !isai( self ) )
    {
        self notifyonplayercommandremove( "lethal_attempt_gulag", "+frag" );
        self notifyonplayercommandremove( "lethal_attempt_gulag", "+smoke" );
    }
}

watchlethaldelayfeedbackplayer( var_0, var_1 )
{
    level endon( "game_ended" );
    var_0 endon( "matchEnded" );
    var_0 endon( "lethal_delay_end" );

    for (;;)
    {
        self waittill( "lethal_attempt_gulag" );
        var_2 = ( var_0.lethaldelayendtime - gettime() ) / 1000;
        var_2 = int( max( 0, ceil( var_2 ) ) );
        var_1 scripts\mp\hud_message::showerrormessage( "MP/LETHALS_UNAVAILABLE_FOR_N", var_2 );
    }
}

_id_129B7( var_0 )
{
    var_0 endon( "matchEnded" );
    playsoundatpos( var_0.center, "iw8_mp_snatch_fight_start" );
    wait 1;
    scripts\mp\gametypes\br_public.gsc::brleaderdialog( "gulag_gulag_active", 0, var_0.jailedplayers );
    scripts\mp\gametypes\br_public.gsc::brleaderdialog( "gulag_objective", 0, var_0.arenaplayers );
    wait 2;

    foreach ( var_2 in var_0.jailedplayers )
    {
        if ( var_2.gulagposition <= 1 )
        {
            scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_next", var_2, 0 );
            continue;
        }

        if ( var_2.gulagposition == 2 )
            scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_taunt", var_2, 0 );
    }
}

_id_119C1()
{
    self endon( "disconnect" );
    self setclientomnvar( "ui_objective_text", 0 );
    wait 3;
    self setclientomnvar( "ui_objective_text", -1 );
}

handleonekillwin( var_0, var_1, var_2, var_3 )
{
    if ( isdefined( var_2 ) && isplayer( var_2 ) && var_1 != var_2 && isalive( var_2 ) && scripts\engine\utility::array_contains( var_0.arenaplayers, var_2 ) )
    {
        thread gulagvictory( var_0, var_2, 0, 0, "winner" );
        payoutbet( var_3, var_2, 1 );
    }

    payoutbet( var_3, var_1, 0 );
}

manageoutlines( var_0, var_1, var_2 )
{
    manageoutlineactive( var_0, var_1, var_2 );

    if ( istrue( level.gulag.onekillwin ) )
        return;

    manageoutlinecleanup( var_0, var_1 );
}

manageoutlineswatchplayersaddedtojail( var_0 )
{
    var_0 endon( "fight_over" );

    for (;;)
    {
        var_0 waittill( "player_added_to_jail" );
        updateoutlines( var_0 );
    }
}

manageoutlineactive( var_0, var_1, var_2 )
{
    var_0 endon( "fight_over" );
    thread manageoutlineswatchplayersaddedtojail( var_0 );

    for (;;)
    {
        if ( var_0.jailedplayers.size )
        {
            var_3 = scripts\engine\utility::array_removeundefined( var_0.jailedplayers );

            foreach ( var_5 in var_1 )
            {
                if ( !isdefined( var_5 ) )
                    continue;

                var_5 hudoutlineenableforclients( var_3, "outline_nodepth_white" );
            }
        }

        if ( isdefined( var_2 ) )
        {
            foreach ( var_8 in var_2.bets )
            {
                if ( !isdefined( var_8.owner ) )
                    continue;

                var_9 = scripts\engine\utility::ter_op( var_2.bettingopen, var_8.playerfocus, var_8.playerbeton );

                if ( var_9 != -1 )
                {
                    var_10 = var_2.fighters[var_9];

                    if ( isdefined( var_10 ) )
                        var_10 hudoutlineenableforclient( var_8.owner, "outline_nodepth_green" );
                }
            }
        }

        var_0 waittill( "update_outlines" );
    }
}

manageoutlinecleanup( var_0, var_1 )
{
    var_2 = scripts\engine\utility::array_removeundefined( var_0.jailedplayers );

    if ( !var_2.size )
        return;

    foreach ( var_4 in var_1 )
    {
        if ( !isdefined( var_4 ) )
            continue;

        var_4 hudoutlinedisableforclients( var_2 );
    }
}

updateoutlines( var_0 )
{
    var_0 notify( "update_outlines" );
}

playergulagarenaready()
{
    _id_119DE( 1 );
    self setclientomnvar( "ui_br_infil_started", 1 );
    self setclientomnvar( "ui_match_start_countdown", 0 );
    self setclientomnvar( "ui_match_in_progress", 1 );

    if ( istrue( level.gulag.gestures_enabled ) && !isbot( self ) )
        playergulaggesturesdisable();
}

gulagcountdowntimer( var_0, var_1, var_2 )
{
    var_3 = level.gulag.gas_cloud_vfx;

    while ( var_3 > 0 )
    {
        foreach ( var_5 in var_0.arenaplayers )
        {
            var_5 setclientomnvar( "ui_match_in_progress", 0 );
            var_5 setclientomnvar( "ui_match_start_countdown", var_3 );
        }

        var_3 = var_3 - 1;
        wait 1;

        if ( istrue( var_1 ) && !validateplayers( var_0 ) )
        {
            handleendarena( var_0, var_2, 1 );
            return 0;
        }
    }

    return 1;
}

pilot_clean_up_monitor( var_0, var_1, var_2 )
{
    var_0 endon( "matchEnded" );

    while ( var_1 > 0 )
    {
        if ( level.gameended )
            return;

        var_3 = var_1;

        if ( !istrue( var_0.overtime ) )
            var_3 = var_3 - var_2;

        if ( var_3 <= 5 )
        {
            var_4 = scripts\mp\gamelogic::mp_oilrig_patches( var_3 );
            hover_radius( var_0, var_4 );
        }

        if ( var_1 > 1 )
            var_1 = var_1 - 1;

        wait 1;
    }
}

hover_radius( var_0, var_1 )
{
    foreach ( var_3 in var_0.jailedplayers )
    {
        if ( isdefined( var_3 ) )
            var_3 playlocalsound( var_1 );
    }

    foreach ( var_3 in var_0.arenaplayers )
    {
        if ( isdefined( var_3 ) )
            var_3 playlocalsound( var_1 );
    }
}

obj_cleanup()
{
    return getdvarint( "scr_br_fc_overtime", 15.0 );
}

waittillgulagmatchend( var_0, var_1 )
{
    var_2 = obj_cleanup();
    var_0.time = var_0.time + var_2;
    thread pilot_clean_up_monitor( var_0, var_0.time, var_2 );

    for (;;)
    {
        if ( !isanyonealive( var_0 ) || isoneteamleft( var_0 ) )
            break;

        var_0.time = var_0.time - level.framedurationseconds;

        if ( istrue( level.gulag.arenaflag ) && !istrue( var_0.overtime ) && var_0.time <= var_2 )
        {
            var_0.overtime = 1;
            var_0.i_see_player_vehicle_watcher.arenaflag br_add_player_commands( 1 );
            var_0.i_see_player_vehicle_watcher.arenaflag br_allowdropspawnafterprematch( var_0, 1 );
            var_0.i_see_player_vehicle_watcher.arenaflag.flagmodel playsoundonmovingent( "flag_spawned" );
        }

        if ( istrue( var_0.overtime ) )
        {
            var_3 = clamp( var_0.time / var_2, 0.0, 1.0 );
            _id_123B3( var_0, var_3 );
        }

        if ( var_0.time <= 0 )
        {
            _id_13437( var_0 );

            if ( istrue( var_1 ) )
            {
                foreach ( var_5 in var_0.arenaplayers )
                {
                    var_5 thread pilot_linkto_angles_offset( var_0 );
                    var_5 setplayermusicstate( "br_gulag_lose" );
                    var_5 playsoundtoplayer( "gulag_crowd_boo_loser", var_5 );
                    var_5 clearclienttriggeraudiozone( 2 );
                }
            }

            break;
        }

        waitframe();
    }

    var_0 notify( "matchEnded" );
}

_id_13437( var_0 )
{
    while ( isdefined( var_0.i_see_player_vehicle_watcher.arenaflag.claimteam ) && var_0.i_see_player_vehicle_watcher.arenaflag.claimteam != "none" && !istrue( var_0.i_see_player_vehicle_watcher.arenaflag.stalemate ) )
        waitframe();
}

isanyonealive( var_0 )
{
    foreach ( var_2 in var_0.arenaplayers )
    {
        if ( isalive( var_2 ) )
            return 1;
    }

    return 0;
}

isoneteamleft( var_0 )
{
    var_1 = undefined;

    foreach ( var_3 in var_0.arenaplayers )
    {
        if ( isalive( var_3 ) )
        {
            if ( !isdefined( var_1 ) )
            {
                var_1 = var_3.team;
                continue;
            }

            if ( var_1 != var_3.team )
                return 0;
        }
    }

    return 1;
}

handleendarena( var_0, var_1, var_2, var_3, var_4, var_5 )
{
    var_0 notify( "lethal_delay_end" );
    var_0 notify( "fight_over" );
    var_0.fightover = 1;

    if ( !isdefined( var_4 ) )
        var_4 = "winner";

    endbetting( var_0, var_1 );
    updatematchtimerhud( var_0, 0 );
    var_6 = undefined;

    foreach ( var_8 in var_0.arenaplayers )
    {
        if ( !isdefined( var_8 ) )
            continue;

        if ( isalive( var_8 ) )
        {
            var_6 = var_8;

            if ( istrue( var_2 ) )
                var_6 playergulagarenaready();

            if ( isdefined( var_5 ) && var_8.team == var_5.team )
            {
                thread gulagvictory( var_0, var_8, 0, 0, var_4, 0, var_5, var_3 );
                continue;
            }

            thread gulagvictory( var_0, var_8, 0, 0, "winner" );
        }
    }

    if ( istrue( level.gulag.arenaflag ) && istrue( var_0.overtime ) )
        var_0.i_see_player_vehicle_watcher.arenaflag br_add_player_commands( 0 );

    payoutremainingbets( var_6, var_1 );
    wait 2.0;

    if ( istrue( level.gulag.arenaflag ) && istrue( var_0.overtime ) )
    {
        var_0.overtime = 0;
        var_0.i_see_player_vehicle_watcher.arenaflag br_allowdropspawnafterprematch( var_0, 0 );
    }

    failedmission( var_0 );
    wait 1.0;
}

_id_11978( var_0, var_1 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "gulag_end" );

    if ( !isdefined( self.arena ) )
        return;

    var_2 = self.arena;

    if ( istrue( self._id_13480 ) )
    {
        self notify( "pull_out_of_gulag" );

        if ( !isalive( self ) )
        {
            thread playergulagautowin( "playerPullOutOfGulagWin", var_0 );
            return;
        }
        else if ( istrue( self.clean_up_search ) )
        {
            scripts\mp\gametypes\br.gsc::_id_12FD8( self, "playerPullOutOfGulagWin" );
            level thread scripts\mp\gametypes\br.gsc::_id_130A4();
        }
    }
    else if ( istrue( self.gulagarena ) )
    {
        if ( !var_2.fightover )
        {
            var_2 notify( "matchEnded" );
            var_2 notify( "fight_over_early" );
            thread handleendarena( var_2, undefined, 1, 1, var_1, var_0 );
        }

        return;
    }
    else
    {
        var_2.jailedplayers = scripts\engine\utility::array_remove( var_2.jailedplayers, self );
        updatematchqueuepositions( var_2 );

        if ( istrue( self.gulag ) && !istrue( self.jailed ) )
            self waittill( "gulag_start" );
    }

    thread gulagvictory( var_2, self, 1, 0, var_1, 0, var_0, 1 );
}

getnextjailspawn( var_0 )
{
    if ( isdefined( var_0.jailspawncounter ) )
    {
        var_0.jailspawncounter++;
        var_0.jailspawncounter = var_0.jailspawncounter % var_0.jailspawns.size;
    }
    else
        var_0.jailspawncounter = 0;

    var_1 = var_0.jailspawns[var_0.jailspawncounter];
    return var_1;
}

_id_1245B( var_0, var_1 )
{
    if ( isdefined( var_1.target ) )
    {
        var_2 = scripts\engine\utility::getstruct( var_1.target, "targetname" );

        if ( isdefined( var_2 ) )
            var_1.chair = var_2;
    }
}

outlinewatchplayerprox( var_0 )
{
    self endon( "death" );
    self endon( "trigger" );
    self.outlinedplayers = [];

    switch ( var_0 )
    {
        case 0:
        default:
            var_1 = "outline_depth_white";
            break;
        case 1:
            var_1 = "outline_depth_green";
            break;
        case 2:
            var_1 = "outline_depth_cyan";
            break;
        case 3:
            var_1 = "outline_depth_red";
            break;
        case 4:
            var_1 = "outline_depth_orange";
            break;
    }

    for (;;)
    {
        var_2 = scripts\common\utility::playersinsphere( self.origin, 2000 );
        var_3 = scripts\engine\utility::array_difference( level.players, var_2 );

        foreach ( var_5 in var_2 )
        {
            var_6 = distancesquared( self.origin, var_5.origin );
            var_7 = var_5 getentitynumber();

            if ( !isdefined( self.outlinedplayers[var_7] ) )
                self.outlinedplayers[var_7] = scripts\mp\utility\outline::outlineenableforplayer( self, var_5, var_1, "level_script" );
        }

        foreach ( var_5 in var_3 )
        {
            var_7 = var_5 getentitynumber();

            if ( isdefined( self.outlinedplayers[var_7] ) )
            {
                scripts\mp\utility\outline::outlinedisable( self.outlinedplayers[var_7], self );
                self.outlinedplayers[var_7] = undefined;
            }
        }

        waitframe();
    }
}

gulagstreamlocationstart( var_0 )
{
    if ( ( isbot( self ) || self isplayerheadless() ) && !istrue( self.spawn_fulton_rope_mdl ) )
        return 0;

    self setallstreamloaddist( 10000.0 );
    self setadditionalstreampos( var_0, 1 );
    return !self isadditionalstreamposready();
}

gulagstreamlocationwait()
{
    if ( !istrue( self.spawn_fulton_rope_mdl ) )
    {
        self endon( "gulagStreamLocationComplete" );
        thread gulagstreamlocationwaittimeout( level.gulag._id_12A77 );

        while ( !self isadditionalstreamposready() )
            waitframe();

        self notify( "gulagStreamLocationComplete" );
    }
    else
        wait( level.gulag._id_12A77 );
}

gulagstreamlocationwaittimeout( var_0 )
{
    self endon( "disconnect" );
    self endon( "gulagStreamLocationComplete" );
    wait( var_0 );
    self notify( "gulagStreamLocationComplete" );
}

gulagstreamlocationend()
{
    self clearadditionalstreampos();
    self notify( "gulagStreamLocationComplete" );
}

pilot_model()
{
    self setallstreamloaddist( 0.0 );
}

addloadingplayer( var_0, var_1 )
{
    var_1.entergulagwait = 1;
    var_0.loadingplayers[var_0.loadingplayers.size] = var_1;
    thread addloadingplayerdisconnectwatch( var_0, var_1 );
}

addloadingplayerdisconnectwatch( var_0, var_1 )
{
    var_1 endon( "removeLoadingPlayer" );
    var_1 waittill( "disconnect" );
    thread removeloadingplayer( var_0, var_1 );
}

removeloadingplayer( var_0, var_1 )
{
    var_1 notify( "removeLoadingPlayer" );

    if ( isdefined( var_1 ) )
        var_0.loadingplayers = scripts\engine\utility::array_remove( var_0.loadingplayers, var_1 );
    else
        var_0.loadingplayers = scripts\engine\utility::array_removeundefined( var_0.loadingplayers );

    if ( var_0.loadingplayers.size == 0 )
        var_0 notify( "loadingPlayersEmpty" );
}

rungwperifeffets( var_0, var_1 )
{
    return scripts\engine\utility::array_contains( var_1.loadingplayers, var_0 );
}

entergulag( var_0 )
{
    var_0 notify( "enter_gulag" );
    var_0.entergulagwait = 0;
    scripts\mp\deathicons::playerstartpowers( var_0 );
}

entergulagwait( var_0 )
{
    if ( var_0.entergulagwait )
        var_0 waittill( "enter_gulag" );
}

playergetnextarena()
{
    if ( !istrue( level.gulag.multiarena ) )
        return level.gulag.arenas[0];

    var_1 = undefined;
    var_2 = undefined;

    foreach ( var_4 in level.gulag.arenas )
    {
        foreach ( var_6 in var_4.matches )
        {
            if ( var_6.size == 1 && isdefined( var_6[0] ) && var_6[0].team != self.team && ( !isdefined( var_1 ) || var_6[0].scriptable_door_freeze_open < var_2 ) )
            {
                var_1 = var_4;
                var_2 = var_6[0].scriptable_door_freeze_open;
            }
        }
    }

    if ( isdefined( var_1 ) )
        return var_1;

    var_9 = [];

    for ( var_10 = 0; var_10 < level.gulag.arenas.size; var_10++ )
    {
        var_4 = level.gulag.arenas[var_10];

        if ( var_4.matches.size > 0 && var_4.matches.size < level.gulag.maxqueue )
            var_9[var_9.size] = var_4;
    }

    if ( var_9.size > 0 )
    {
        foreach ( var_4 in var_9 )
        {
            foreach ( var_6 in var_4.matches )
            {
                foreach ( var_14 in var_6 )
                {
                    if ( isdefined( var_14 ) && var_14.team == self.team )
                        return var_4;
                }
            }
        }

        var_4 = var_9[randomint( var_9.size )];
        return var_4;
    }

    var_1 = undefined;
    var_18 = undefined;

    for ( var_10 = 0; var_10 < level.gulag.arenas.size; var_10++ )
    {
        var_4 = level.gulag.arenas[var_10];

        if ( var_4.matches.size == 0 )
            return var_4;
        else if ( !isdefined( var_18 ) || var_4.matches.size < var_18 )
        {
            var_1 = var_4;
            var_18 = var_4.matches.size;
        }
    }

    return var_1;
}

runheliextraction( var_0, var_1 )
{
    if ( !ismatchpending( var_0 ) )
        return 0;

    var_2 = var_1.gulagposition - 1;

    if ( var_2 >= 0 && var_0.matches[var_2].size > 1 )
        return 1;

    return 0;
}

_id_1238C( var_0 )
{
    foreach ( var_2 in var_0.jailedplayers )
    {
        if ( !runheliextraction( var_0, var_2 ) && isdefined( var_2.scriptable_door_get_in_radius ) && !isdefined( var_2.scriptable_door_is_double_door_pair ) )
        {
            var_2 setclientomnvar( "ui_br_gulag_match_end_time", var_2.scriptable_door_get_in_radius );
            var_2.scriptable_door_is_double_door_pair = 1;
        }
    }
}

weapon_xp_iw8_ar_falima( var_0 )
{
    self.scriptable_door_get_in_radius = undefined;
    self.scriptable_door_is_double_door_pair = undefined;
    self setclientomnvar( "ui_br_gulag_match_end_time", 0 );
}

zombiejumplink( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "initPlayerArena" );
    self endon( "gulag_end" );
    var_1 = getdvarint( "scr_br_fc_jailTimeout", 95 );

    if ( var_1 <= 0 )
        return;

    self.scriptable_door_get_in_radius = gettime() + var_1 * 1000;
    wait( var_1 );

    if ( runheliextraction( var_0, self ) )
    {
        var_2 = self.gulagposition * ( level.gulag.timelimit + obj_cleanup() + level.gulag.gas_cloud_vfx + 2 + 2.0 + 1.0 + 1 );
        var_3 = gettime() + var_2 * 1000;

        while ( var_3 > gettime() && runheliextraction( var_0, self ) )
            waitframe();
    }

    while ( rotations() )
        waitframe();

    thread gulagvictory( var_0, self, 1, 0, "timeout" );
}

initplayerjail( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "gulag_end" );
    self.scriptable_door_freeze_open = gettime();
    scripts\mp\gametypes\br_analytics.gsc::close_c130crate_gate( self, scripts\engine\utility::ter_op( istrue( var_0 ), "default", "debug" ) );
    _id_11975();
    var_1 = playergetnextarena();
    self.arena = var_1;

    if ( !scripts\engine\utility::array_contains( var_1.jailedplayers, self ) )
    {
        var_1 notify( "player_added_to_jail", self );
        var_1.jailedplayers[var_1.jailedplayers.size] = self;
    }

    playergulaghud( var_1 );
    thread playerwatchdisconnect( var_1 );
    updatematchqueuepositions( var_1 );
    addloadingplayer( var_1, self );
    pickup_truck_initdamage( self );

    if ( !isdefined( self.gulaguses ) )
        self.gulaguses = 0;

    self.gulaguses++;
    setplayervargulag( 1 );
    setplayervargulagarena( 0 );
    _id_123BF( 1 );
    _id_123BC( var_1 );
    scripts\mp\outofbounds::enableoobimmunity( self );

    if ( isdefined( level.end_freight_lift ) )
        [[ level.end_freight_lift ]]();

    var_2 = getnextjailspawn( var_1 );
    var_3 = getgroundposition( var_2.origin, 12 );
    var_4 = ( 0, 0, 0 );

    if ( isdefined( var_2.angles ) )
        var_4 = var_2.angles;

    var_5 = gulagstreamlocationstart( var_3 );
    self.pickup_truck_initomnvars = 1;
    self._id_12A76 = spawnstruct();
    self._id_12A76.origin = var_3;
    self._id_12A76.angles = var_4;

    if ( istrue( var_0 ) )
        entergulagwait( self );
    else
        entergulag( self );

    scripts\mp\gametypes\br_quest_util.gsc::unset_relic_healthpacks();
    scripts\mp\gametypes\br_alt_mode_escape.gsc::isfeaturedisabled();
    var_6 = gettime();

    if ( scripts\mp\gametypes\br_public.gsc::revive_or_disconnect_monitor() )
        self notify( "play_gulag_vo" );

    if ( level.gulag.betting )
    {
        var_7 = level.gulag.give_player_class_abilities;

        if ( isdefined( self.plundercountondeath ) )
            var_7 = int( max( var_7, int( self.plundercountondeath / 2 ) ) );

        scripts\mp\gametypes\br_plunder.gsc::playersetplundercount( var_7 );
    }

    _id_11950();

    if ( var_5 )
    {
        scripts\mp\gametypes\br.gsc::spawnintermission( var_3 + ( 0, 0, 100 ), self.angles );
        scripts\mp\spectating::setdisabled();
        gulagstreamlocationstart( var_3 );
    }

    if ( var_5 )
        gulagstreamlocationwait();

    if ( scripts\mp\gametypes\br_gametypes.gsc::revive_stim( "playerPreSpawnGulagJail" ) )
        scripts\mp\gametypes\br_gametypes.gsc::_id_1209E( "playerPreSpawnGulagJail" );

    scripts\mp\class::loadout_emptycacheofloadout( "gamemode" );
    self.pers["gamemodeLoadout"] = level.gulag.scriptable_damaged_funcs;
    self.class = "gamemode";
    self.forcespawnangles = var_4;
    self.forcespawnorigin = var_3;
    scripts\mp\playerlogic::spawnplayer( undefined, 0 );
    scripts\cp_mp\execution::_clearexecution();
    self setclientomnvar( "ui_gulag", 1 );
    self._id_12A76 = undefined;
    self.pickup_truck_initomnvars = 0;
    _id_11F30();

    if ( var_5 )
        gulagstreamlocationend();

    _id_119C3();
    _id_11A10( var_6 );

    if ( scripts\mp\gametypes\br_public.gsc::revive_or_disconnect_monitor() )
        self clearsoundsubmix( "iw8_br_gulag_tutorial", 2 );
    else
        self clearsoundsubmix( "fade_to_black_all_except_music_and_scripted5", 2 );

    self setclientomnvar( "ui_br_infil_started", 1 );
    var_8 = var_1.fightover && zombiehealth( var_1 );
    var_9 = undefined;

    if ( level.gulag.droporigin )
        var_9 = 0.5;

    if ( !var_8 )
        gulagfadefromblack( var_9 );

    gulagloadingtextclear();

    if ( !var_8 )
    {
        scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_spawn", self, 0 );
        thread waypoints_creation( var_1, var_2 );
    }

    var_10 = scripts\mp\gametypes\br_public.gsc::ondefuse( self.team, self.squadindex );

    foreach ( var_12 in var_10 )
    {
        if ( !isdefined( var_12 ) || !isalive( var_12 ) )
            continue;

        if ( var_12 != self )
        {
            var_12 thread scripts\mp\hud_message::showsplash( "br_gulag_teammate_in", undefined, self );
            scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_teammate_gulag", var_12 );
        }
    }

    if ( !istrue( self.jailed ) )
    {
        _id_123C6( 1 );
        scripts\mp\utility\perk::blockperkfunction( "specialty_scavenger" );
    }

    removeloadingplayer( var_1, self );
    scripts\mp\gametypes\br_pickups.gsc::initplayer( 1 );

    if ( istrue( level.gulag.gestures_enabled ) && !isbot( self ) )
        thread playergulaggestures();

    _id_119E1( 0 );

    if ( istrue( level.gulag.arenaflag ) && istrue( var_1.overtime ) )
        var_1.i_see_player_vehicle_watcher.arenaflag thread br_alt_mode_impulse_player( 1, self );

    thread zombiejumplink( var_1 );
    thread zombiekilledlootcachecount( var_1 );
    self notify( "gulag_start" );
}

zombiekilledlootcachecount( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "initPlayerArena" );
    self endon( "gulag_end" );
    wait 5;

    if ( ismatchpending( var_0 ) )
        return;

    scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_obj_wait", self, 0 );
}

_id_119E1( var_0 )
{
    if ( var_0 )
        self enableoffhandthrowback();
    else
        self disableoffhandthrowback();
}

playergulaggestures()
{
    level endon( "game_ended" );
    self endon( "death" );
    self endon( "disconnect" );
    self endon( "gulag_gestures_stop" );
    self enableoffhandweapons();
    self allowfire( 0 );
    self allowads( 0 );
    self notifyonplayercommand( "fc_gesture_neg", "+attack" );
    self notifyonplayercommand( "fc_gesture_pos", "+speed_throw" );
    var_0 = 0;

    for (;;)
    {
        var_1 = scripts\engine\utility::_id_133F7( "fc_gesture_neg", "fc_gesture_pos" );

        if ( self isgestureplaying() || self isswitchingweapon() || self isreloading() || self ismantling() || self isthrowinggrenade() || self israisingweapon() || self ismeleeing() )
            continue;

        if ( getdvarint( "scr_br_fc_gestures_test", 0 ) > 0 )
        {
            if ( var_0 >= level.gulag.gestures[var_1].size )
                var_0 = 0;

            var_2 = level.gulag.gesturesounds[var_1][var_0];
            var_3 = level.gulag.gestures[var_1][var_0];
            var_0++;
        }
        else
        {
            var_0 = randomint( level.gulag.gestures[var_1].size );
            var_2 = level.gulag.gesturesounds[var_1][var_0];
            var_3 = level.gulag.gestures[var_1][var_0];
        }

        if ( isdefined( var_2 ) && var_2 != "" )
            self playsound( var_2 );

        var_4 = getcompleteweaponname( var_3 );

        if ( isdefined( var_4 ) && !nullweapon( var_4 ) )
            scripts\cp_mp\gestures::watchradialgesture( var_4 );
    }
}

playergulaggesturesdisable()
{
    self notify( "gulag_gestures_stop" );
    self notifyonplayercommandremove( "fc_gesture_neg", "+attack" );
    self notifyonplayercommandremove( "fc_gesture_pos", "+speed_throw" );
    self allowfire( 1 );
    self allowads( 1 );
}

fadeoutin( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );

    if ( !isdefined( var_0 ) )
        var_0 = 1.0;

    gulagfadetoblack();
    wait( var_0 );
    gulagfadefromblack();
}

gulagfadetoblack( var_0 )
{
    weapon_pick_up_monitor();

    if ( istrue( var_0 ) )
        pickrandomspawn();
}

gulagfadefromblack( var_0 )
{
    thread weapon_should_not_get_ammo( var_0 );
    pickprematchrandomloadout();
}

pickrandomspawn()
{
    var_0 = scripts\mp\gametypes\br_spectate.gsc::ondamagepredamagemodrelicfocusfire( self );

    foreach ( var_2 in var_0 )
        var_2 weapon_pick_up_monitor();
}

pickprematchrandomloadout()
{
    var_0 = scripts\mp\gametypes\br_spectate.gsc::ondamagepredamagemodrelicfocusfire( self );

    foreach ( var_2 in var_0 )
        var_2 thread weapon_should_not_get_ammo();
}

keywatcher( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );

    if ( !isdefined( var_0 ) )
        var_0 = 1.0;

    pickrandomspawn();
    wait( var_0 );
    pickprematchrandomloadout();
}

pickup_sound_hvt_handler()
{
    if ( zlimit() )
        return 1;

    return 0;
}

gulagloadingtext()
{
    var_0 = scripts\mp\hud_util::createfontstring( "default", 1.5 );
    var_0 scripts\mp\hud_util::setpoint( "CENTER", "CENTER", 0, -100 );
    var_0.label = &"MP/BR_GULAG_TRAVEL";
    self.gulagloadingtext = var_0;
}

gulagloadingtextclear()
{
    if ( isdefined( self.gulagloadingtext ) )
        self.gulagloadingtext destroy();
}

_id_119F1( var_0, var_1 )
{
    self cancelmantle();
    self setorigin( var_0, 1 );
    self setplayerangles( var_1 );
}

initplayerarena( var_0, var_1, var_2 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self notify( "initPlayerArena" );
    weapon_box_cache_use();
    scripts\mp\gametypes\br_pickups.gsc::initplayer();
    self allowprone( 0 );
    self allowcrouch( 0 );
    _id_119E1( 1 );
    _id_119DE( 0 );
    playertakeawayrock( var_0 );
    weapon_xp_iw8_ar_falima( var_0 );
    scripts\mp\equipment::allow_equipment_slot( "primary", 0 );
    scripts\mp\equipment::allow_equipment_slot( "secondary", 0 );
    thread x1playerspawnoverride( var_0 );

    if ( istrue( var_1 ) )
    {
        _id_123C6( 0 );
        setplayervargulagarena( 1 );
        playergivearenaloadout( var_0, var_2 );

        if ( level.gulag.lethaldelay > 0 )
            thread watchlethaldelayplayer( var_0 );

        return;
    }

    scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_spawn_rules", self, 0 );
    var_3 = pickup_sound_hvt_handler();

    if ( !var_3 )
        thread fadeoutin();

    thread keywatcher();
    wait 1;
    playergivearenaloadout( var_0, var_2 );
    thread _id_119F5( 3 );

    if ( getdvarint( "scr_br_verify_gulag_loadouts", 0 ) == 1 )
    {
        level.gulag.lethaldelay = 0;
        thread _id_132F2( var_0 );
    }

    if ( level.gulag.lethaldelay > 0 )
        thread watchlethaldelayplayer( var_0 );

    var_4 = getnextarenaspawn( var_0 );
    var_5 = getgroundposition( var_4.origin, 1 );
    var_6 = var_4.angles;

    if ( !isdefined( var_4.angles ) )
        var_6 = ( 0, 0, 0 );

    _id_119F1( var_5, var_6 );
    _id_123C6( 0 );
    setplayervargulagarena( 1 );
    self.health = self.maxhealth;
    scripts\mp\gametypes\br_armor.gsc::packsplashparambits( level.gulag.trial_trigger_activated_func );

    if ( getdvarint( "scr_br_fc_outline_countdown", 1 ) > 0 )
        self hudoutlineenableforclients( var_0.arenaplayers, "outline_nodepth_red" );

    if ( var_3 )
        gulagfadefromblack();

    wait 1;
    self allowprone( 1 );
    self allowcrouch( 1 );
    wait( level.gulag.gas_cloud_vfx - 1 );
    wait 1;

    if ( getdvarint( "scr_br_fc_outline_countdown", 1 ) > 0 && var_0.arenaplayers.size > 0 )
        self hudoutlinedisableforclients( var_0.arenaplayers );
}

_id_119DE( var_0 )
{
    if ( var_0 )
    {
        self allowmelee( 1 );
        self allowmovement( 1 );
        self enableusability();
        self enableoffhandweapons();
        self allowads( 1 );
        self allowfire( 1 );
    }
    else
    {
        self allowmelee( 0 );
        self allowmovement( 0 );
        self disableusability();
        self disableoffhandweapons();
        self allowads( 0 );
        self allowfire( 0 );
    }
}

getnextarenaspawn( var_0 )
{
    if ( !isdefined( var_0.arenaspawncounter ) )
        var_0.arenaspawncounter = 0;

    var_1 = undefined;

    if ( _id_130FD( var_0 ) )
        var_1 = var_0.dropoff[var_0.arenaspawncounter];
    else
        var_1 = var_0.fightspawns[var_0.arenaspawncounter];

    var_0.arenaspawncounter++;
    var_0.arenaspawncounter = var_0.arenaspawncounter % var_0.fightspawns.size;
    return var_1;
}

_id_119F5( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self.plotarmor = 1;
    scripts\engine\utility::_id_1340A( var_0, "death", "gulagRespawn" );
    self.plotarmor = undefined;
}

gulagvictory( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7 )
{
    level endon( "game_ended" );
    var_1 endon( "death_or_disconnect" );
    var_1 notify( "gulag_end" );

    if ( !isdefined( var_5 ) )
        var_5 = 0;

    var_1 thread weapon_box_cache_use();
    var_1 weapon_xp_iw8_ar_falima();
    var_1 thread _id_119F5( 5 );
    var_1.gulagloser = 0;

    if ( var_0.jailedplayers.size > 0 && getdvarint( "scr_br_fc_spectate_outlines", 0 ) )
        var_1 hudoutlinedisableforclients( var_0.jailedplayers );

    if ( var_0.arenaplayers.size > 0 && getdvarint( "scr_br_fc_outline_countdown", 1 ) > 0 )
        var_1 hudoutlinedisableforclients( var_0.arenaplayers );

    var_0.arenaplayers = scripts\engine\utility::array_remove( var_0.arenaplayers, var_1 );
    var_8 = scripts\mp\gametypes\br_public.gsc::ondefuse( var_1.team, var_1.squadindex );

    foreach ( var_10 in var_8 )
    {
        if ( !isdefined( var_10 ) || !isalive( var_10 ) )
            continue;

        if ( var_10 != var_1 )
        {
            var_10 thread scripts\mp\hud_message::showsplash( "br_gulag_teammate_out", undefined, var_1 );
            scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_teammate_win", var_10 );
        }
    }

    var_12 = "";

    if ( isdefined( var_4 ) )
        var_12 = var_4;

    if ( !istrue( var_3 ) && !istrue( var_5 ) && !istrue( var_7 ) )
        var_1 thread _id_12E9D( 3 );

    if ( var_2 )
    {
        if ( !istrue( var_3 ) )
        {
            if ( var_4 == "timeout" )
                scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_timeout", var_1, 0 );
            else
                scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_noenemy", var_1, 0 );
        }

        var_0.jailedplayers = scripts\engine\utility::array_remove( var_0.jailedplayers, var_1 );
        updatematchqueuepositions( var_0 );
    }
    else
        scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_win", var_1, 0 );

    var_1 playsoundtoplayer( "gulag_crowd_cheer_winner", var_1 );
    var_1 setplayermusicstate( "br_gulag_win" );

    if ( istrue( level.gulag.onekillwin ) && ( istrue( var_0.isjailbreak ) || level.gulag.maxplayers > 2 ) )
        var_1 playerhide();

    var_1 _id_119E1( 1 );
    var_1 _id_119DE( 1 );
    var_1 x1opsnpcweaponmagmodel( 0 );
    var_1 scripts\mp\gametypes\br_public.gsc::updatebrscoreboardstat( "isRespawning", 1 );
    var_1 scripts\mp\weapons::deleteplacedequipment();
    var_13 = scripts\mp\gametypes\br_public.gsc::musictriggerthink() / 1000;
    var_14 = var_1 x1opsnpcweaponbarrelmodel( 0, var_13 );
    var_15 = var_1 _id_11977( var_14 );
    wait 2.0;

    if ( istrue( level.gulag.arenaflag ) )
        var_0.i_see_player_vehicle_watcher.arenaflag thread br_alt_mode_impulse_player( 0, var_1 );

    var_1 clearclienttriggeraudiozone( 2 );
    var_1 gulagfadetoblack( 1 );
    wait 1;
    var_1 gulagwinnerrespawn( var_5, var_4, var_14, 1, var_15, undefined, var_6, var_3, var_7 );
}

_id_11977( var_0 )
{
    var_1 = scripts\mp\gametypes\br_public.gsc::_id_119E6( var_0.origin, var_0.height );
    self setpredictedstreamloaddist( 0.0 );
    scripts\mp\gametypes\br_public.gsc::_id_119E7( var_1 );
    return var_1;
}

pilot_linkto_origin_offset( var_0, var_1 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "gulag_end" );
    self endon( "gulagLost" );
    self waittill( "death", var_2 );

    if ( istrue( level.gulag.onekillwin ) )
        handleonekillwin( var_0, self, var_2, var_1 );

    thread pilot_linkto_angles_offset( var_0 );
}

pilot_linkto_angles_offset( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "pull_out_of_gulag" );
    self notify( "gulagLost" );

    if ( istrue( self.gulagloser ) )
        return;

    self.gulagloser = 1;
    self._id_12858 = var_0._id_12858;
    thread _id_119BD( 1 );
    var_0.jailedplayers = scripts\engine\utility::array_removeundefined( var_0.jailedplayers );

    if ( var_0.jailedplayers.size > 0 && getdvarint( "scr_br_fc_spectate_outlines", 0 ) )
        self hudoutlinedisableforclients( var_0.jailedplayers );

    var_0.arenaplayers = scripts\engine\utility::array_removeundefined( var_0.arenaplayers );

    if ( var_0.arenaplayers.size > 0 && getdvarint( "scr_br_fc_outline_countdown", 1 ) > 0 )
        self hudoutlinedisableforclients( var_0.arenaplayers );

    var_0.arenaplayers = scripts\engine\utility::array_remove( var_0.arenaplayers, self );

    if ( isdefined( self ) )
        var_1 = self.name;
    else
        var_1 = "<undefined>";

    self setplayermusicstate( "br_gulag_lose" );
    scripts\mp\weapons::deleteplacedequipment();
    scripts\mp\gametypes\br.gsc::ss_circletick( self, "gulagPlayerLost" );
    level thread scripts\mp\gametypes\br.gsc::_id_130A4();
    scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_lose", self, 0, 1 );
    scripts\mp\gametypes\br_public.gsc::cpoperationcratecapturecallback( "gulag_teammate_lose", self.team, self, 0, 0 );

    if ( isalive( self ) )
    {
        thread scripts\mp\gametypes\br_spectate.gsc::_id_12E96();
        self.plotarmor = 1;
        self freezecontrols( 1 );
    }

    wait 2.0;
    self clearclienttriggeraudiozone( 2 );

    if ( istrue( level.gulag.arenaflag ) )
        var_0.i_see_player_vehicle_watcher.arenaflag thread br_alt_mode_impulse_player( 0, self );

    scripts\cp\helicopter\chopper_boss::unlockables( 2 );
    scripts\mp\gametypes\br_analytics.gsc::close_assassination_door( self, "loser" );
    playerdestroyhud( var_0 );
    setplayervargulag( 0 );
    setplayervargulagarena( 0, 1 );
    _id_123C6( 0 );

    if ( isalive( self ) )
    {
        if ( !scripts\mp\gametypes\br_gametypes.gsc::roof_enemy_groups( "teamSpectate" ) )
            scripts\mp\gametypes\br_spectate.gsc::steam_damage_player( self, undefined, 1 );

        gulagfadetoblack();
        wait 1;

        if ( !scripts\mp\gametypes\br_gametypes.gsc::roof_enemy_groups( "teamSpectate" ) )
            scripts\mp\gametypes\br_spectate.gsc::steam_damage_player( self, undefined, 1 );

        if ( isalive( self ) )
        {
            var_2 = spawnstruct();
            var_2.origin = self.origin;
            var_2.angles = self.angles;
            var_2.attacker = self.lastattacker;
            self.health = 0;
            self notify( "death" );
            self notify( "death_or_disconnect" );
            scripts\mp\gametypes\br_spectate.gsc::spawnspectator( var_2, 1, 1 );
            scripts\mp\playerlogic::removefromalivecount( 0, "gulagPlayerLost" );
        }

        gulagfadefromblack();
    }

    self.plotarmor = undefined;
}

_id_119BD( var_0 )
{
    if ( istrue( level.usegulag ) )
    {
        if ( var_0 )
        {
            self._id_13480 = var_0;
            self setclientomnvar( "ui_gulag", var_0 );
        }
        else
        {
            self._id_13480 = undefined;
            self setclientomnvar( "ui_gulag", 0 );
        }

        _id_123BE( var_0 );
    }
}

_id_119D8()
{
    if ( istrue( level.usegulag ) && istrue( self._id_13480 ) && scripts\mp\gametypes\br_public.gsc::ondamagerelicfocusfire( self.team, self.squadindex ) > 0 )
        scripts\mp\gametypes\br_public.gsc::cpcpammoarmorcratecapturecallback( "gulag_buyback", self, 0, 1 );
}

_id_11D87( var_0, var_1 )
{
    if ( istrue( var_1.gulagarena ) )
    {
        var_2 = var_1.arena;
        var_2.molotovs[var_2.molotovs.size] = var_0;
    }
}

_id_11D89( var_0, var_1 )
{
    if ( istrue( var_1.gulagarena ) )
    {
        var_2 = var_1.arena;
        var_2._id_12C44[var_2._id_12C44.size] = var_0;
    }
}

failedmission( var_0 )
{
    foreach ( var_2 in var_0.molotovs )
    {
        if ( isdefined( var_2 ) )
            thread scripts\mp\equipment\molotov::tabletreplacefrequency( var_2 );
    }

    var_0.molotovs = [];

    foreach ( var_5 in var_0._id_12C44 )
    {
        if ( isdefined( var_5 ) )
            var_5 thread scripts\mp\equipment\thermite::thermite_destroy();
    }

    var_0._id_12C44 = [];
}

pickup_timeout( var_0 )
{
    var_1 = isdefined( level.br_circle ) && isdefined( level.br_circle.safecircleent );

    if ( !var_1 )
        return 1;

    var_2 = scripts\mp\gametypes\br_circle.gsc::getsafecircleorigin();
    var_3 = scripts\mp\gametypes\br_circle.gsc::getsafecircleradius();
    var_4 = distance2d( var_0, var_2 );
    return var_4 < var_3;
}

pickup_sound_playerwm_handler( var_0 )
{
    var_1 = isdefined( level.br_circle ) && isdefined( level.br_circle.dangercircleent );

    if ( !var_1 )
        return 1;

    var_2 = scripts\mp\gametypes\br_circle.gsc::getdangercircleorigin();
    var_3 = scripts\mp\gametypes\br_circle.gsc::getdangercircleradius();
    var_4 = distance2d( var_0, var_2 );
    return var_4 < var_3;
}

pickup_sound_playervm_handler( var_0, var_1 )
{
    if ( !scripts\mp\gametypes\br_c130.gsc::ispointinbounds( var_0, 1 ) )
        return 0;

    if ( !isdefined( level.br_circle ) || !isdefined( level.br_circle.safecircleent ) || !isdefined( level.br_circle.dangercircleent ) )
        return 1;

    if ( scripts\mp\utility\game::onfieldupgradeendbuffer() == "truckwar" )
    {
        if ( pickup_sound_playerwm_handler( var_0 ) )
            return 1;
    }
    else
    {
        if ( pickup_timeout( var_0 ) )
            return 1;

        if ( !pickup_sound_playerwm_handler( var_0 ) )
            return 0;
    }

    if ( isdefined( var_1 ) )
    {
        var_2 = scripts\mp\gametypes\br_circle.gsc::getmintimetillpointindangercircle( var_0 );

        if ( var_1 > var_2 )
            return 0;
    }

    var_3 = scripts\mp\gametypes\br_circle.gsc::getsafecircleorigin();
    var_4 = scripts\mp\gametypes\br_circle.gsc::getsafecircleradius();
    var_5 = scripts\mp\gametypes\br_circle.gsc::getdangercircleorigin();
    var_6 = scripts\mp\gametypes\br_circle.gsc::getdangercircleradius();
    var_7 = length( var_5 - var_3 );
    var_8 = vectornormalize( var_5 - var_3 );
    var_9 = level._id_11F51;
    var_10 = var_3 + var_8 * var_7 * var_9;
    var_11 = var_4 + ( var_6 - var_4 ) * var_9;
    var_12 = distance2d( var_0, var_10 );
    return var_12 < var_11;
}

russianletter( var_0, var_1 )
{
    if ( var_0 == self )
        return 0;

    if ( !isalive( var_0 ) || var_0 scripts\mp\gametypes\br_public.gsc::rungwperif_flak() || istrue( var_0.clean_up_search ) )
        return 0;

    if ( !pickup_sound_playervm_handler( var_0.origin, var_1 ) )
        return 0;

    return 1;
}

weaponpickupflyoutbit( var_0, var_1, var_2 )
{
    var_3 = undefined;

    if ( istrue( level.onlinegame ) && self getprivatepartysize() )
    {
        var_4 = undefined;

        foreach ( var_6 in self getfireteammembers() )
        {
            if ( !russianletter( var_6, var_1 ) )
                continue;

            var_4 = var_6;

            if ( var_6 isfireteamleader() )
                break;
        }

        if ( isdefined( var_4 ) && istrue( var_0 ) )
        {
            var_3 = var_4;
            var_4 = undefined;

            foreach ( var_6 in self getfireteammembers() )
            {
                if ( isdefined( var_3 ) && var_3 == var_6 )
                    continue;

                if ( !russianletter( var_6, var_1 ) )
                    continue;

                var_4 = var_6;

                if ( var_6 isfireteamleader() )
                    break;
            }
        }

        if ( isdefined( var_4 ) )
            return var_4;
    }

    if ( isdefined( self.lastdeathpos ) )
    {
        var_10 = undefined;
        var_11 = undefined;
        var_12 = scripts\mp\gametypes\br_public.gsc::ondamagerelicfromabove( self.team, self.squadindex );

        foreach ( var_14 in var_12 )
        {
            if ( isdefined( var_3 ) && var_3 == var_14 )
                continue;

            if ( !russianletter( var_14, var_1 ) )
                continue;

            if ( var_14 isparachuting() || var_14 isskydiving() )
                continue;

            var_15 = distance2dsquared( self.lastdeathpos, var_14.origin );

            if ( !isdefined( var_11 ) || var_15 < var_11 )
            {
                var_10 = var_14;
                var_11 = var_15;
            }
        }

        if ( isdefined( var_10 ) && istrue( var_0 ) && !isdefined( var_3 ) )
        {
            var_3 = var_10;
            var_10 = undefined;
            var_11 = undefined;

            foreach ( var_14 in var_12 )
            {
                if ( isdefined( var_3 ) && var_3 == var_14 )
                    continue;

                if ( !russianletter( var_14, var_1 ) )
                    continue;

                if ( var_14 isparachuting() || var_14 isskydiving() )
                    continue;

                var_15 = distance2dsquared( self.lastdeathpos, var_14.origin );

                if ( !isdefined( var_11 ) || var_15 < var_11 )
                {
                    var_10 = var_14;
                    var_11 = var_15;
                }
            }
        }

        if ( isdefined( var_10 ) )
            return var_10;
    }

    var_10 = undefined;
    var_19 = scripts\engine\utility::array_randomize( scripts\mp\gametypes\br_public.gsc::ondamagerelicfromabove( self.team, self.squadindex ) );

    foreach ( var_21 in var_19 )
    {
        if ( isdefined( var_3 ) && var_3 == var_21 )
            continue;

        if ( !russianletter( var_21, var_1 ) )
            continue;

        var_10 = var_21;

        if ( istrue( var_21 scripts\mp\gametypes\br_public.gsc::runbrgametypefunc6() ) )
            break;
    }

    if ( isdefined( var_10 ) )
        return var_10;
    else if ( !istrue( var_2 ) )
    {
        if ( scripts\mp\utility\game::onfieldupgradeendbuffer() == "dmz" || scripts\mp\utility\game::onfieldupgradeendbuffer() == "risk" )
        {
            var_23 = scripts\mp\utility\teams::getteamdata( self.team, "teamCount" );

            if ( var_23 == 1 && !istrue( self.hide_found_intel ) && !scripts\mp\outofbounds::ispointinoutofbounds( self.origin ) )
                return self;
        }
    }

    return undefined;
}

oldkey( var_0, var_1, var_2 )
{
    var_3 = add_struct( var_0, var_1, var_2 );
    scripts\mp\gametypes\br_analytics.gsc::closeobjectiveiconid( var_0, 0, var_3 );
    return var_3;
}

add_struct( var_0, var_1, var_2 )
{
    var_3 = 3.14159;
    var_4 = scripts\mp\gametypes\br_circle.gsc::getsafecircleorigin();
    var_5 = vectornormalize( var_0 - var_4 );
    var_6 = vectortoangles( var_5 );
    var_7 = randomfloatrange( getdvarfloat( "scr_br_respawn_rand_ang_min", 10.0 ), getdvarfloat( "scr_br_respawn_rand_ang_max", 90.0 ) );

    if ( scripts\mp\utility\game::onfieldupgradeendbuffer() == "dmz" && getdvarint( "scr_dmz_respawn_rand_ang", 0 ) == 1 )
        var_8 = vectornormalize( anglestoforward( var_6 + ( 0, scripts\engine\utility::ter_op( scripts\engine\utility::cointoss(), var_7, var_7 * -1 ), 0 ) ) );
    else
        var_8 = var_5;

    var_9 = var_0 + var_8 * var_1;

    if ( pickup_sound_playervm_handler( var_9, var_2 ) )
        return var_9;

    var_8 = var_8 * -1;
    var_9 = var_0 + var_8 * var_1;

    if ( pickup_sound_playervm_handler( var_9, var_2 ) )
        return var_9;

    var_8 = vectornormalize( var_4 - var_0 );
    var_9 = var_0 + var_8 * var_1;

    if ( pickup_sound_playervm_handler( var_9, var_2 ) )
        return var_9;

    var_10 = var_1;
    var_11 = distance2d( var_0, var_4 );
    var_12 = var_10 / var_11;

    if ( var_12 > var_3 )
        var_12 = var_3;

    var_13 = var_12 * 180 / var_3;
    var_9 = rotatepointaroundvector( ( 0, 0, 1 ), var_0 - var_4, var_13 ) + var_4;

    if ( pickup_sound_playervm_handler( var_9, var_2 ) )
        return var_9;

    var_9 = scripts\mp\gametypes\br_circle.gsc::getrandompointincircle( var_0, var_1 );

    if ( pickup_sound_playervm_handler( var_9, var_2 ) )
        return var_9;

    return undefined;
}

weaponisvalid()
{
    if ( scripts\mp\gametypes\br_gametypes.gsc::roof_enemy_groups( "missions" ) )
        return undefined;

    foreach ( var_5, var_1 in level.questinfo.quests )
    {
        foreach ( var_4, var_3 in var_1.instances )
        {
            if ( var_4 == self.team && !scripts\mp\gametypes\br_quest_util.gsc::sandboxprintlinebold( var_3 ) )
            {
                switch ( var_3.category )
                {
                    case "assassination":
                        if ( isdefined( var_3.targetplayer ) )
                            return var_3.targetplayer.origin;

                        break;
                    case "domination":
                        if ( isdefined( var_3._id_12A93 ) && isdefined( var_3._id_12A93.domflag ) && isdefined( var_3._id_12A93.domflag.curorigin ) )
                            return var_3._id_12A93.domflag.curorigin;

                        break;
                    case "scavenger_adler":
                    case "lep":
                    case "scavenger":
                        if ( isdefined( var_3._id_12A93.deletex1finhud.origin ) && isdefined( var_3._id_12A93.deletex1finhud ) )
                            return var_3._id_12A93.deletex1finhud.origin;

                        break;
                    case "x2_amb_signal":
                    case "x2_stash":
                    case "x2_map":
                    case "x2_signal":
                    case "x2_amb1":
                    case "x2_bomb":
                    case "x1fin":
                    case "x1stash":
                    case "history":
                    case "smokinggun":
                    case "vip":
                        break;
                    default:
                        break;
                }
            }
        }
    }

    return undefined;
}

weaponignoresbrarmor( var_0 )
{
    foreach ( var_2 in level.br_pickups.crates )
    {
        if ( !isdefined( var_2 ) || !isdefined( var_2.team ) || var_2.team != self.team )
            continue;

        if ( isdefined( var_2.playerscaptured ) && isdefined( var_2.playerscaptured[self getentitynumber()] ) )
            continue;

        if ( pickup_sound_playervm_handler( var_2.origin, var_0 ) )
            return var_2.origin;
    }
}

x1opsnpcweaponbarrelmodel( var_0, var_1, var_2 )
{
    var_3 = undefined;
    var_4 = undefined;
    var_5 = var_2;
    var_6 = 1;

    if ( isdefined( self.setspawnpoint ) )
    {
        var_3 = self.setspawnpoint.playerspawnpos;
        var_4 = self.setspawnpoint.playerspawnangles;
    }

    var_7 = getdvarfloat( "scr_br_respawnMaxLastDeathOffset", -1 );

    if ( !isdefined( var_3 ) && var_7 >= 0 && isdefined( self.lastdeathpos ) )
    {
        var_8 = oldkey( self.lastdeathpos, var_7, var_1 );

        if ( isdefined( var_8 ) )
        {
            var_3 = scripts\mp\gametypes\br_public.gsc::init_rpg_spawns( var_8 );
            var_4 = mousetrapwatcher( var_3, self.lastdeathpos );
        }
    }

    var_7 = getdvarfloat( "scr_br_respawnMaxTeammateOffset", 1000 );

    if ( !isdefined( var_3 ) && var_7 >= 0 )
    {
        var_9 = weaponpickupflyoutbit( var_0, var_1 );

        if ( isdefined( var_9 ) )
        {
            var_10 = getdvarfloat( "scr_bmo_respawn_intermission_time", 5.0 ) * 1000;
            var_11 = getdvarfloat( "scr_bmo_redeploy_window", 30.0 ) * 1000;

            if ( ( getdvar( "scr_br_gametype", "" ) == "dmz" || getdvar( "scr_br_gametype", "" ) == "risk" || getdvar( "scr_br_gametype", "" ) == "kingslayer" ) && isdefined( level.teamdata[self.team]["lastParachuteTime"] ) && level.teamdata[self.team]["lastParachuteTime"] + var_11 > gettime() + var_10 && distance2d( level.teamdata[self.team]["lastParachuteOrigin"], var_9.origin ) < getdvarfloat( "scr_br_respawnMaxTeammateOffset", 1000 ) * 1.25 )
            {
                var_3 = level.teamdata[self.team]["lastParachuteOrigin"];
                var_4 = level.teamdata[self.team]["lastParachuteAngles"];
            }
            else
            {
                var_3 = oldkey( var_9.origin, var_7, var_1 );

                if ( isdefined( var_3 ) )
                {
                    var_3 = scripts\mp\gametypes\br_public.gsc::init_rpg_spawns( var_3 );
                    var_4 = mousetrapwatcher( var_3, var_9.origin );
                    level.teamdata[self.team]["lastParachuteOrigin"] = var_3;
                    level.teamdata[self.team]["lastParachuteAngles"] = var_4;
                    level.teamdata[self.team]["lastParachuteTime"] = gettime();
                }
            }
        }
    }

    var_7 = getdvarfloat( "scr_br_respawnMaxMissionOffset", 3000 );

    if ( !isdefined( var_3 ) && var_7 >= 0 )
    {
        var_12 = weaponisvalid();

        if ( isdefined( var_12 ) )
        {
            var_3 = oldkey( var_12, var_7, var_1 );
            var_4 = mousetrapwatcher( var_3, var_12 );
        }
    }

    var_7 = getdvarfloat( "scr_br_respawnMaxCrateOffset", 3000 );

    if ( !isdefined( var_3 ) && var_7 >= 0 )
    {
        var_13 = weaponignoresbrarmor( var_1 );

        if ( isdefined( var_13 ) )
        {
            var_3 = oldkey( var_13, var_7, var_1 );
            var_4 = mousetrapwatcher( var_3, var_13 );
        }
    }

    if ( !isdefined( var_3 ) )
    {
        if ( isdefined( level.br_circle ) && isdefined( level.br_circle.safecircleent ) )
        {
            if ( getdvarint( "scr_br_useClosestSafePointFromSquadmate", 1 ) )
            {
                var_14 = getdvarfloat( "scr_br_closestSafePointTimeOffset", 2.0 );
                var_3 = scripts\mp\gametypes\br_circle.gsc::flares_from_structs( self, var_1, var_14 );
            }

            if ( !isdefined( var_3 ) )
            {
                var_15 = scripts\mp\gametypes\br_circle.gsc::getsafecircleorigin();
                var_16 = scripts\mp\gametypes\br_circle.gsc::getsafecircleradius();
                var_17 = getdvarfloat( "scr_br_minRespawnRadiusPct", 0.5 );
                var_18 = getdvarfloat( "scr_br_maxRespawnRadiusPct", 0.9 );
                var_19 = getdvarint( "scr_br_maxRespawnDropToGround", 1 );
                var_20 = getdvarint( "scr_br_maxRespawnSnapToNavMesh", 1 );
                var_3 = scripts\mp\gametypes\br_circle.gsc::oic_rewardammo( var_15, var_16, var_18, var_18, var_19, var_20, 0, var_1 );
            }
        }
        else if ( isdefined( level.prematchspawnorigins ) )
        {
            if ( isdefined( level.teamdata[self.team]["chosenSpawnWipeOrigin"] ) && isdefined( level.teamdata[self.team]["spawnWipeOriginUseStartTime"] ) && isdefined( level.brplacementchallengeallowed ) && level.teamdata[self.team]["spawnWipeOriginUseStartTime"] + level.brplacementchallengeallowed * 1000 > gettime() )
                var_3 = level.teamdata[self.team]["chosenSpawnWipeOrigin"];
            else
            {
                var_21 = [];

                foreach ( var_23 in level.prematchspawnorigins )
                {
                    if ( distance2dsquared( var_23.origin, self.origin ) > var_7 )
                        var_21[var_21.size] = var_23;
                }

                if ( var_21.size == 0 )
                    var_21 = level.prematchspawnorigins;

                var_21 = scripts\engine\utility::array_randomize( var_21 );
                var_3 = var_21[0].origin;
                var_3 = var_3 + scripts\engine\math::random_vector_2d() * randomfloatrange( 100, 500 );
                level.teamdata[self.team]["chosenSpawnWipeOrigin"] = var_3;
                level.teamdata[self.team]["spawnWipeOriginUseStartTime"] = gettime();
            }

            var_4 = ( 0, 0, 0 );

            if ( var_3[2] > 10000 & !isdefined( var_2 ) )
            {
                var_6 = 0;
                var_5 = scripts\mp\gametypes\br_infils.gsc::getinfilspawnoffset();
            }
        }
        else
        {
            var_3 = ( 0, 0, 0 );
            var_4 = ( 0, 0, 0 );
        }
    }

    if ( !isdefined( var_4 ) )
    {
        var_25 = scripts\mp\gametypes\br_circle.gsc::getsafecircleorigin();
        var_26 = vectortoyaw( var_25 - var_3 );
        var_4 = ( 0, var_26, 0 );
    }

    if ( var_6 )
    {
        if ( !isdefined( var_5 ) )
            var_5 = scripts\cp_mp\parachute::getc130height();

        if ( isdefined( level.br_circle ) )
        {
            var_27 = level.br_circle.circleindex;
            var_28 = nextstar();
            var_29 = isdefined( var_27 ) && var_27 >= var_28;

            if ( var_29 )
                var_5 = var_5 * getdvarfloat( "scr_br_gulagClosedSpawnOffsetScaler", 0.55 );
        }

        if ( isdefined( level._id_11F58 ) )
            var_5 = level._id_11F58;

        var_30 = ( 0, 0, var_5 );
        var_3 = scripts\mp\gametypes\br.gsc::numkilled( var_3, var_30 );
    }

    var_31 = spawnstruct();
    var_31.origin = var_3;
    var_31.angles = var_4;
    var_31.height = var_5;
    return var_31;
}

mousetrapwatcher( var_0, var_1 )
{
    if ( isdefined( var_0 ) && isdefined( var_1 ) )
    {
        var_2 = vectortoyaw( var_1 - var_0 );
        var_3 = ( 0, var_2, 0 );
        return var_3;
    }
}

gulagwinnerrespawn( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9 )
{
    var_10 = !istrue( var_0 );

    if ( !istrue( var_0 ) && !istrue( var_8 ) )
        scripts\cp\helicopter\chopper_boss::unlockables( 1 );

    if ( isdefined( var_1 ) )
        scripts\mp\gametypes\br_analytics.gsc::close_assassination_door( self, var_1 );

    _id_119BD( 0 );
    setplayervargulag( 0 );
    setplayervargulagarena( 0 );

    if ( scripts\mp\utility\game::getgametype() == "br" )
        playerdestroyhud( self.arena );

    _id_123C6( 0 );
    level notify( "update_circle_hide" );
    self.scriptable_door_freeze_open = undefined;
    scripts\mp\gametypes\br.gsc::parachute_get_path( self );
    playertakeawayrock( self.arena );
    pilot_tag( var_0 );

    if ( isdefined( level.gulag ) && istrue( level.gulag.planerespawn ) )
    {
        playerrespawngulagcleanup( var_0 );
        pilot_model();
        playersetupac130();

        if ( isdefined( self.oobimmunity ) )
            scripts\mp\outofbounds::disableoobimmunity( self );

        return;
    }

    if ( !isdefined( var_2 ) )
        var_2 = x1opsnpcweaponbarrelmodel();

    var_11 = var_2.origin;
    var_12 = var_2.angles;
    var_13 = var_11;

    if ( isdefined( var_4 ) )
        var_13 = var_4;

    pilot_model();
    _id_119F1( var_13, var_12 );
    var_14 = spawn( "script_model", var_13 );
    var_14 setmodel( "tag_origin" );
    var_14.angles = var_12;
    var_14 hide();
    var_14 showtoplayer( self );
    self playerlinktoabsolute( var_14, "tag_origin" );
    self playerhide();
    thread weapon_switch_hint( var_14 );
    waitframe();

    if ( isdefined( self.oobimmunity ) )
        scripts\mp\outofbounds::disableoobimmunity( self );

    playerrespawngulagcleanup( var_0 );

    if ( getdvarint( "scr_skip_respawn_gate", 1 ) == 0 )
        scripts\mp\gametypes\br_public.gsc::_id_11A13();

    scripts\mp\gametypes\br_public.gsc::weapon_xp_iw8_ar_kilo433();

    if ( isdefined( var_4 ) )
        var_14.origin = var_11;

    var_14 playsoundtoplayer( "br_ac130_flyby", self );
    wait 1.5;
    self unlink();
    self clearsoundsubmix( "deaths_door_mp" );

    if ( scripts\mp\gametypes\br_public.gsc::revive_or_disconnect_monitor() )
        self clearsoundsubmix( "iw8_br_gulag_tutorial", 2 );
    else
        self clearsoundsubmix( "fade_to_black_all_except_music_and_scripted5", 2 );

    self clearclienttriggeraudiozone( 1 );
    self playershow( 1 );
    x1opsnpcweaponmagmodel( 1 );
    var_15 = 0;

    if ( isdefined( level.validtousesticker ) )
        var_15 = level.validtousesticker;

    if ( !scripts\mp\gametypes\br_public.gsc::risk_flagspawnshiftingcenter() )
        thread scripts\cp_mp\parachute::startfreefall( var_15, 0, undefined, undefined, 1 );

    if ( !istrue( var_3 ) )
        thread _id_12E9D( 7 );

    if ( istrue( var_5 ) )
        self setclientomnvar( "ui_br_transition_type", 0 );

    if ( scripts\mp\utility\game::getgametype() == "br" )
        self setclientomnvar( "ui_show_spectateHud", -1 );

    _id_11F30();
    var_16 = scripts\mp\utility\perk::_hasperk( "specialty_br_reinforced" );
    scripts\mp\gametypes\br_armor.gsc::participantplunder( var_16 );
    scripts\mp\gametypes\br_quest_util.gsc::unset_relic_martyrdom();
    scripts\mp\gametypes\br_rewards.gsc::unset_relic_martyrdom();
    scripts\mp\gametypes\br_alt_mode_escape.gsc::isfeatureenabled();
    scripts\mp\gametypes\br_gametypes.gsc::_id_1209E( "gulagWinnerRespawn", self );
    wait 0.5;

    if ( scripts\mp\utility\game::getgametype() == "br" )
        gulagfadefromblack();

    waitframe();
    var_14 delete();

    if ( istrue( level._id_125C6 ) )
        scripts\mp\gametypes\br_skydive_protection.gsc::relic_amped_wait_till_revived( 1 );

    if ( scripts\mp\gametypes\br_public.gsc::revive_or_disconnect_monitor() )
        self notify( "respawn_from_gulag" );

    self notify( "can_show_splashes" );

    if ( istrue( getdvar( "scr_br_gametype", "" ) == "truckwar" ) && !istrue( var_8 ) )
    {
        var_17 = "br_gulag_winner_redeploy_mogulag";
        var_18 = undefined;
    }

    if ( istrue( getdvar( "scr_br_gametype", "" ) == "dmz" ) || istrue( getdvar( "scr_br_gametype", "" ) == "kingslayer" ) || istrue( getdvar( "scr_br_gametype", "" ) == "rumble" ) || istrue( getdvar( "scr_br_gametype", "" ) == "risk" ) || istrue( getdvar( "scr_br_gametype", "" ) == "sandbox" ) )
    {
        var_17 = "br_gulag_winner_redeploy_mogulag";
        var_18 = undefined;
    }
    else if ( istrue( var_7 ) )
    {
        var_17 = "br_gulag_jailbreak_redeploy";
        var_18 = undefined;
    }
    else if ( istrue( var_0 ) || istrue( var_8 ) )
    {
        var_17 = "br_gulag_kiosk_redeploy";
        var_18 = var_6;
    }
    else
    {
        if ( istrue( isdefined( level.gulag ) && !istrue( level.gulag.shutdown ) ) && checkgulagusecount() )
            var_17 = "br_gulag_winner_redeploy_mogulag";
        else
            var_17 = "br_gulag_winner_redeploy";

        var_18 = undefined;
    }

    if ( !istrue( var_9 ) )
        thread scripts\mp\hud_message::showsplash( var_17, undefined, var_18 );

    if ( isdefined( level.gulag ) && istrue( level.gulag.shutdown ) && !istrue( self.gulagdone ) )
    {
        wait 2.0;
        playergulagdonesplash();
    }
}

weapon_switch_hint( var_0 )
{
    var_0 endon( "death" );
    self waittill( "disconnect" );

    if ( isdefined( var_0 ) )
        var_0 delete();
}

x1opsnpcweaponmagmodel( var_0 )
{
    if ( var_0 )
    {
        self enableoffhandweapons();
        self enableusability();
    }
    else
    {
        self disableoffhandweapons();
        self disableusability();
    }
}

_id_12E9D( var_0 )
{
    self endon( "disconnect" );
    var_1 = scripts\mp\gametypes\br_gametypes.gsc::_id_1209E( "triggerRespawnOverlay" );

    if ( istrue( var_1 ) )
        return;

    _id_12E9E();
}

_id_12E9E()
{
    wait 0.5;
    thread scripts\mp\hud_message::showsplash( "br_gulag_winner" );
}

playerrespawngulagcleanup( var_0 )
{
    self notify( "gulagRespawn" );
    scripts\mp\equipment\molotov::molotov_clear_burning();
    self.health = self.maxhealth;
    scripts\mp\healthoverlay::onexitdeathsdoor( 1 );

    if ( !istrue( var_0 ) )
    {
        scripts\mp\utility\player::enableplayerforspawnlogic( 0 );
        self setclientomnvar( "ui_gulag", 0 );
        scripts\mp\gametypes\br_public.gsc::updatebrscoreboardstat( "isRespawning", 0 );

        if ( isdefined( self.arena ) )
            removeloadingplayer( self.arena, self );

        self.arena = undefined;
    }
}

pilot_tag( var_0 )
{
    if ( getdvarint( "scr_br_fc_keep_gun", 0 ) != 0 && !istrue( var_0 ) )
        gulagwinnerremembergunandammo();
    else if ( isdefined( level.clear_trap_console_activation ) || getdvarint( "scr_br_fc_loadouts", 1 ) != 0 && getdvarint( "scr_br_fc_winner_loadout", -1 ) > -1 )
        self.pilot_setups = 1;
}

pindia_vehicle_registration()
{
    if ( !istrue( level.usegulag ) && !scripts\mp\gametypes\br_gametypes.gsc::roof_enemy_groups( "gulagWinnerRestoreLoadoutUseGulag" ) )
        return 0;

    var_0 = 0;

    if ( getdvarint( "scr_br_fc_keep_gun", 0 ) != 0 )
        var_0 = pindia_headlights();
    else if ( isdefined( level.clear_trap_console_activation ) || getdvarint( "scr_br_fc_loadouts", 1 ) != 0 && getdvarint( "scr_br_fc_winner_loadout", -1 ) > -1 )
        var_0 = ping_response_time();

    return var_0;
}

gulagwinnerremembergunandammo()
{
    self.br_gulagguncurrent = self getcurrentprimaryweapon();
    var_0 = self getweaponslistprimaries();
    var_0 = scripts\engine\utility::array_remove( var_0, getcompleteweaponname( "iw8_knifestab_mp" ) );
    var_0 = scripts\engine\utility::array_remove( var_0, getcompleteweaponname( "iw8_throwingknife_fire_melee_mp" ) );
    var_0 = scripts\engine\utility::array_remove( var_0, getcompleteweaponname( "iw8_throwingknife_electric_melee_mp" ) );
    var_0 = scripts\engine\utility::array_remove( var_0, getcompleteweaponname( "iw8_throwingknife_drill_melee_mp" ) );
    var_0 = scripts\engine\utility::array_remove( var_0, getcompleteweaponname( "iw8_fists_mp" ) );
    self.br_gulagguns = [];
    self.br_gulagammo = [];

    foreach ( var_2 in var_0 )
    {
        var_3 = createheadicon( var_2 );

        if ( getsubstr( var_3, 0, 4 ) == "alt_" )
            continue;

        self.br_gulagguns[self.br_gulagguns.size] = var_2;

        if ( getdvarint( "scr_br_gulag_rememberammo", 0 ) == 1 )
        {
            self.br_gulagammo[var_3] = self getweaponammoclip( var_2 ) + self getweaponammostock( var_2 );
            continue;
        }

        self.br_gulagammo[var_3] = weaponclipsize( var_2 ) * 3;
    }

    var_5 = self getweaponslistoffhands();
    var_6 = "primary";
    self.br_gulagoffhands = [];

    foreach ( var_8 in var_5 )
    {
        var_9 = self getweaponammoclip( var_8 );

        if ( var_9 <= 0 )
        {
            scripts\mp\equipment::takeequipment( var_6 );
            var_6 = "secondary";
            continue;
        }

        var_6 = "secondary";
        self.br_gulagoffhands[self.br_gulagoffhands.size] = var_8;
        var_10 = createheadicon( var_8 );
        self.br_gulagammo[var_10] = weaponstartammo( var_8 );
    }
}

pindia_headlights()
{
    if ( isdefined( self.br_gulagguns ) && isdefined( self.br_gulagoffhands ) && isdefined( self.br_gulagammo ) )
    {
        if ( getdvarint( "scr_br_shutdownloadout", 0 ) == 1 && self.br_gulagguns.size < 2 )
        {
            self.pilot_setups = 1;
            ping_response_time();
            return 0;
        }

        self takeallweapons();
        scripts\mp\gametypes\br_weapons.gsc::br_ammo_player_clear();
        self.equipment["primary"] = undefined;
        self.equipment["secondary"] = undefined;
        self.equipment["health"] = undefined;
        self.equipment["super"] = undefined;

        if ( self.br_gulagguns.size < 2 )
            self giveweapon( getcompleteweaponname( "iw8_fists_mp" ) );

        var_0 = 0;

        foreach ( var_2 in self.br_gulagguns )
        {
            var_3 = createheadicon( var_2 );
            scripts\cp_mp\utility\inventory_utility::_giveweapon( var_2 );
            self setweaponammostock( var_2, 0 );

            if ( !var_0 )
            {
                self assignweaponprimaryslot( var_3 );
                scripts\cp_mp\utility\inventory_utility::_switchtoweapon( var_2 );
                var_0 = 1;
            }

            scripts\mp\weapons::fixupplayerweapons( self, var_3 );
            thread scripts\mp\gametypes\br_respawn.gsc::giveweaponpickup( var_3 );
            var_4 = weaponclipsize( var_2 );
            var_5 = int( min( var_4, 25 ) );

            if ( isdefined( self.br_gulagammo[var_3] ) )
                var_5 = int( max( var_5, self.br_gulagammo[var_3] ) );

            var_6 = 0;

            if ( var_5 > var_4 )
            {
                var_6 = var_5 - var_4;
                var_5 = var_4;
            }

            self setweaponammoclip( var_2, var_5 );

            if ( var_6 > 0 )
            {
                var_7 = scripts\mp\gametypes\br_weapons.gsc::br_ammo_type_for_weapon( var_2 );
                scripts\mp\gametypes\br_weapons.gsc::br_ammo_give_type( self, var_7, var_6 );
            }
        }

        scripts\mp\gametypes\br_weapons.gsc::br_ammo_update_weapons( self );

        foreach ( var_10 in self.br_gulagoffhands )
        {
            var_11 = scripts\mp\equipment::getequipmentreffromweapon( var_10 );

            if ( isdefined( var_11 ) && isdefined( level.br_pickups.br_equipnametoscriptable[var_11] ) )
            {
                var_12 = level.br_pickups.br_equipnametoscriptable[var_11];
                scripts\mp\gametypes\br_pickups.gsc::br_forcegivecustompickupitem( self, var_12, 1 );
                var_3 = createheadicon( var_10 );

                if ( isdefined( self.br_gulagammo[var_3] ) )
                {
                    var_13 = self.br_gulagammo[var_3];
                    self setweaponammoclip( var_10, var_13 );
                }
            }
        }

        if ( isdefined( self.br_gulagguncurrent ) )
            self switchtoweaponimmediate( self.br_gulagguncurrent );

        self.br_gulaggun = undefined;
        self.br_gulagammo = undefined;
        self.br_gulagoffhands = undefined;
        self.br_gulagguncurrent = undefined;
        return 1;
    }

    return 0;
}

ping_response_time()
{
    if ( istrue( self.pilot_setups ) )
    {
        var_0 = getdvarint( "scr_br_fc_winner_loadout", -1 );

        if ( var_0 > -1 )
            self.pers["gamemodeLoadout"] = level.pickuptrigger[var_0];
        else
            self.pers["gamemodeLoadout"] = level.clear_trap_console_activation;

        self.class = "gamemode";
        self.prevweaponobj = undefined;
        var_1 = scripts\mp\class::loadout_getclassstruct();
        var_1 = scripts\mp\class::loadout_updateclass( var_1, "gamemode" );
        scripts\mp\class::preloadandqueueclassstruct( var_1, 1, 1 );
        scripts\mp\class::giveloadout( self.team, "gamemode", 0, 0 );
        self givestartammo( var_1.loadoutprimaryobject );
        self givestartammo( var_1.loadoutsecondaryobject );
        scripts\mp\gametypes\br.gsc::parachute_get_path( self );
        scripts\mp\gametypes\br_weapons.gsc::br_ammo_player_clear();
        scripts\mp\gametypes\br_weapons.gsc::clean_enemy_ai();
        scripts\mp\gametypes\br_weapons.gsc::br_ammo_update_weapons( self );
        self notify( "ammo_update" );
        thread scripts\mp\gametypes\br.gsc::clampstepbulletdamage();

        if ( isdefined( level.isdonetsksubmap ) && level.isdonetsksubmap._id_11CCB == 1 )
            scripts\mp\gametypes\br.gsc::computer_force_player_to_exit();

        self.pilot_setups = undefined;
        return 1;
    }

    return 0;
}

popnextmatch( var_0 )
{
    var_1 = var_0.matches[0];
    var_0.matches = scripts\engine\utility::array_remove_index( var_0.matches, 0 );
    return var_1;
}

checkgulagusecount()
{
    if ( level.gulag.maxuses >= 0 )
    {
        var_0 = self.gulaguses;

        if ( !isdefined( var_0 ) )
            var_0 = 0;

        if ( var_0 >= level.gulag.maxuses )
            return 0;
    }

    return 1;
}

trygulagspawn()
{
    if ( !istrue( self.br_infilstarted ) || !scripts\mp\flags::gameflag( "prematch_done" ) )
        return 0;

    if ( istrue( self.gulag ) )
        return 0;

    if ( scripts\mp\gametypes\br_public.gsc::hasrespawntoken() && !scripts\mp\gametypes\br_pickups.gsc::_id_11F66() )
    {
        thread playergulagautowin( "tryGulagSpawn" );
        return 1;
    }

    if ( !waypoint_radius_think() )
        return 0;

    thread initplayerjail( 1 );
    return 1;
}

waypoint_radius_think()
{
    if ( !istrue( self.br_infilstarted ) || !scripts\mp\flags::gameflag( "prematch_done" ) )
        return 0;

    if ( istrue( self.gulag ) )
        return 0;

    if ( !istrue( level.usegulag ) )
        return 0;

    if ( istrue( level.gulag.shutdown ) && !yaw_delta() )
        return 0;

    if ( getdvarint( "scr_br_all_assassin_version", 0 ) )
        return 0;

    if ( istrue( self.gulagloser ) )
        return 0;

    if ( !checkgulagusecount() )
        return 0;

    return 1;
}

playergulaghud( var_0 )
{
    if ( isdefined( var_0.fightover ) && !var_0.fightover )
        _id_119AA( var_0 );

    if ( isdefined( var_0.fightover ) && !var_0.fightover && isdefined( var_0.time ) && var_0.time > 0 )
    {
        var_1 = var_0.time;

        if ( !istrue( var_0.overtime ) )
        {
            var_2 = obj_cleanup();
            var_1 = var_1 - var_2;
        }

        self setclientomnvar( "ui_br_gulag_match_end_time", gettime() + int( var_1 * 1000 ) );
    }
    else
        self setclientomnvar( "ui_br_gulag_match_end_time", 0 );
}

updatematchtimerhud( var_0, var_1 )
{
    _updatematchtimerhudinternal( var_0.arenaplayers, var_1 );
    _updatematchtimerhudinternal( var_0.jailedplayers, var_1 );
}

_updatematchtimerhudinternal( var_0, var_1 )
{
    foreach ( var_3 in var_0 )
    {
        if ( !isdefined( var_3 ) )
            continue;

        if ( var_1 > 0 )
        {
            var_3 setclientomnvar( "ui_br_gulag_match_end_time", gettime() + int( var_1 * 1000 ) );
            continue;
        }

        var_3 setclientomnvar( "ui_br_gulag_match_end_time", 0 );
    }
}

updatematchqueuepositions( var_0 )
{
    for ( var_1 = 2; var_1 <= level.gulag.maxplayers; var_1 = var_1 + 2 )
    {
        var_2 = [];

        foreach ( var_4 in var_0.jailedplayers )
        {
            if ( !isdefined( var_4 ) )
                continue;

            var_5 = 0;

            foreach ( var_12, var_7 in var_2 )
            {
                if ( var_7.size >= var_1 )
                    continue;

                var_8 = 0;

                foreach ( var_10 in var_7 )
                {
                    if ( var_10.team == var_4.team )
                    {
                        var_8 = 1;
                        break;
                    }
                }

                if ( !var_8 )
                {
                    var_5 = 1;
                    var_4.gulagposition = var_12 + 1;
                    var_2[var_12][var_2[var_12].size] = var_4;
                    break;
                }
            }

            if ( !var_5 )
            {
                var_4.gulagposition = var_2.size + 1;
                var_2[var_2.size] = [ var_4 ];
            }
        }

        var_0.matches = var_2;

        if ( var_2.size <= level.gulag.maxqueue )
            break;
    }

    _id_13068( var_0 );
}

playerwatchdisconnect( var_0 )
{
    self endon( "gulagLost" );
    self endon( "gulag_end" );
    self waittill( "death_or_disconnect" );

    if ( isdefined( self ) && istrue( self.gulagarena ) )
        return;

    if ( isdefined( self ) )
    {
        if ( istrue( self.gulagarena ) )
            var_0.arenaplayers = scripts\engine\utility::array_remove( var_0.arenaplayers, self );
        else if ( istrue( self.jailed ) )
            var_0.jailedplayers = scripts\engine\utility::array_remove( var_0.jailedplayers, self );

        playerdestroyhud( var_0 );
    }
    else
    {
        var_0.jailedplayers = scripts\engine\utility::array_removeundefined( var_0.jailedplayers );
        var_0.arenaplayers = scripts\engine\utility::array_removeundefined( var_0.arenaplayers );
    }

    updatematchqueuepositions( var_0 );
}

playerdestroyhud( var_0 )
{
    self setclientomnvar( "ui_br_gulag_match_end_time", 0 );

    if ( isdefined( var_0 ) )
        weapon_xp_iw8_ar_asierra12( var_0 );

    if ( isdefined( self.gulagjailbreakhud ) )
        self.gulagjailbreakhud destroy();

    self.pickupchecks = undefined;
}

setplayervargulag( var_0 )
{
    if ( isdefined( self.gulag ) && self.gulag == var_0 )
        return;

    self.gulag = var_0;
    level notify( "update_circle_hide" );
}

setplayervargulagarena( var_0, var_1 )
{
    if ( isdefined( self.gulagarena ) && self.gulagarena == var_0 )
        return;

    if ( !istrue( var_1 ) )
        _id_123BE( var_0 );

    self.gulagarena = var_0;
    level notify( "update_circle_hide" );
}

_id_123BE( var_0 )
{
    if ( istrue( var_0 ) )
        self.game_extrainfo = self.game_extrainfo | 256;
    else
        self.game_extrainfo = self.game_extrainfo & ~256;
}

_id_123C6( var_0 )
{
    if ( isdefined( self.jailed ) && self.jailed == var_0 )
        return;

    _id_123BF( var_0 );
    self.jailed = var_0;
    level notify( "update_circle_hide" );
}

_id_123BF( var_0 )
{
    if ( var_0 )
        self.game_extrainfo = self.game_extrainfo | 128;
    else
        self.game_extrainfo = self.game_extrainfo & ~128;
}

_id_123BC( var_0 )
{
    if ( var_0.pickup_saw_and_start_mission > 7 )
        return;

    var_1 = 3;
    var_2 = 3;
    var_3 = int( pow( 2, var_1 ) ) - 1;
    var_4 = ( var_0.pickup_saw_and_start_mission & var_3 ) << var_2;
    var_5 = ~( var_3 << var_2 );
    var_6 = self.game_extrainfo;
    var_7 = var_6 & var_5;
    var_8 = var_7 + var_4;
    self.game_extrainfo = var_8;
}

startbetting( var_0, var_1 )
{
    if ( !level.gulag.betting )
        return undefined;

    var_2 = spawnstruct();
    var_2.fighters = var_1;
    var_2.bets = [];
    var_2.bettingopen = 1;
    var_2 thread show_betting_to_players( var_0 );
    return var_2;
}

show_betting_to_players( var_0 )
{
    self endon( "end_betting" );

    for (;;)
    {
        var_1 = getbettingplayers( var_0, self );

        foreach ( var_3 in var_1 )
        {
            if ( isbot( var_3 ) )
                continue;

            if ( isdefined( self.bets[var_3.guid] ) )
                continue;

            thread showbettinghud( var_0, var_3 );
        }

        var_0 waittill( "player_added_to_jail" );
    }
}

showbettinghud( var_0, var_1 )
{
    self endon( "end_betting" );
    var_2 = spawnstruct();
    var_2.owner = var_1;
    self.bets[var_1.guid] = var_2;
    var_2.zombienumhitsheli = 0;
    var_2._id_11986 = 1;
    var_3 = 0;
    var_4 = 50;
    var_2.hudavailable = var_1 scripts\mp\hud_util::createfontstring( "default", 1.2 );
    var_2.hudavailable scripts\mp\hud_util::setpoint( "TOP", "TOP", var_3, var_4 );
    var_2.hudavailable.label = &"MP_GULAG_BETTING/AVAILABLE";
    var_2.hudavailable scripts\mp\hud::fontpulseinit();
    var_2.plunder_repositoryusecallbackinternal = var_1 scripts\mp\hud_util::createfontstring( "default", 1.2 );
    var_2.plunder_repositoryusecallbackinternal scripts\mp\hud_util::setpoint( "TOP", "TOP", var_3, var_4 - 15 );
    var_2.plunder_repositoryusecallbackinternal.label = &"MP_GULAG_BETTING/BET_CLEAR";
    var_2.plunder_repositoryusecallbackinternal.alpha = 0.0;
    var_5 = -90;
    var_6 = 65;
    var_2.plunder_repositorysendcountdownmessage = var_1 scripts\mp\hud_util::createfontstring( "default", 1.2 );
    var_2.plunder_repositorysendcountdownmessage scripts\mp\hud_util::setpoint( "TOP", "TOP", var_5, var_6 );
    var_2.plunder_repositorysendcountdownmessage.label = &"MP_GULAG_BETTING/BET_INCREASE_LEFT";
    var_2.plunder_repositorysendcountdownmessage.alpha = 1.0;
    var_2.plunderinstanceid = var_1 scripts\mp\hud_util::createfontstring( "default", 1.25 );
    var_2.plunderinstanceid scripts\mp\hud_util::setpoint( "TOP", "TOP", var_5 - 20, var_6 + 12 );
    var_2.plunderinstanceid.label = &"MP_GULAG_BETTING/ODDS_PERCENT";
    var_2.plunderinstanceid setvalue( randomint( 60 ) + 20 );
    var_2.plunderinstanceid.alpha = 1.0;
    var_2.plundermusicfirst = var_1 scripts\mp\hud_util::createfontstring( "default", 1.25 );
    var_2.plundermusicfirst scripts\mp\hud_util::setpoint( "TOP", "TOP", var_5 + 20, var_6 + 12 );
    var_2.plundermusicfirst.label = &"MP_GULAG_BETTING/ODDS_RATIO";
    var_2.plundermusicfirst setvalue( randomint( 10 ) + 1 );
    var_2.plundermusicfirst.alpha = 1.0;
    var_2.plundermusicsecond = var_1 scripts\mp\hud_util::createfontstring( "default", 1.5 );
    var_2.plundermusicsecond scripts\mp\hud_util::setpoint( "TOP", "TOP", var_5, var_6 + 25 );
    var_2.plundermusicsecond.label = &"";

    if ( isdefined( self.fighters[var_2.zombienumhitsheli] ) )
        var_2.plundermusicsecond setplayernamestring( self.fighters[var_2.zombienumhitsheli] );

    var_2.plundermusicsecond.alpha = 1.0;
    var_2.plunder_repositoryendcountdown = var_1 scripts\mp\hud_util::createfontstring( "default", 1.5 );
    var_2.plunder_repositoryendcountdown scripts\mp\hud_util::setpoint( "TOP", "TOP", var_5, var_6 + 40 );
    var_2.plunder_repositoryendcountdown.label = &"MP_GULAG_BETTING/CURRENT_BET";
    var_2.plunder_repositoryendcountdown.alpha = 0.0;
    var_2.plunder_repositoryendcountdown scripts\mp\hud::fontpulseinit();
    var_7 = 90;
    var_8 = 65;
    var_2.plunder_repositoryusecallback = var_1 scripts\mp\hud_util::createfontstring( "default", 1.2 );
    var_2.plunder_repositoryusecallback scripts\mp\hud_util::setpoint( "TOP", "TOP", var_7, var_8 );
    var_2.plunder_repositoryusecallback.label = &"MP_GULAG_BETTING/BET_INCREASE_RIGHT";
    var_2.plunder_repositoryusecallback.alpha = 1.0;
    var_2.plunderlimit = var_1 scripts\mp\hud_util::createfontstring( "default", 1.25 );
    var_2.plunderlimit scripts\mp\hud_util::setpoint( "TOP", "TOP", var_7 - 20, var_8 + 12 );
    var_2.plunderlimit.label = &"MP_GULAG_BETTING/ODDS_PERCENT";
    var_2.plunderlimit setvalue( randomint( 60 ) + 20 );
    var_2.plunderlimit.alpha = 1.0;
    var_2.plundermusicfourth = var_1 scripts\mp\hud_util::createfontstring( "default", 1.25 );
    var_2.plundermusicfourth scripts\mp\hud_util::setpoint( "TOP", "TOP", var_7 + 20, var_8 + 12 );
    var_2.plundermusicfourth.label = &"MP_GULAG_BETTING/ODDS_RATIO";
    var_2.plundermusicfourth setvalue( randomint( 10 ) + 1 );
    var_2.plundermusicfourth.alpha = 1.0;
    var_2.plundermusicthird = var_1 scripts\mp\hud_util::createfontstring( "default", 1.5 );
    var_2.plundermusicthird scripts\mp\hud_util::setpoint( "TOP", "TOP", var_7, var_8 + 25 );
    var_2.plundermusicthird.label = &"";

    if ( isdefined( self.fighters[var_2._id_11986] ) )
        var_2.plundermusicthird setplayernamestring( self.fighters[var_2._id_11986] );

    var_2.plundermusicthird.alpha = 1.0;
    var_2.plunder_repositoryextract = var_1 scripts\mp\hud_util::createfontstring( "default", 1.5 );
    var_2.plunder_repositoryextract scripts\mp\hud_util::setpoint( "TOP", "TOP", var_7, var_8 + 40 );
    var_2.plunder_repositoryextract.label = &"MP_GULAG_BETTING/CURRENT_BET";
    var_2.plunder_repositoryextract.alpha = 0.0;
    var_2.plunder_repositoryextract scripts\mp\hud::fontpulseinit();
    var_2.playerbeton = -1;
    var_2.amount = 0;
    updatebethud( var_2 );
    thread watchbetplaced( var_2 );
    thread watchbetclear( var_2 );
}

watchbetclear( var_0 )
{
    self endon( "end_betting" );
    var_0.owner endon( "disconnect" );
    var_1 = "betClear";
    thread notifyonplayercommandbetting( var_0.owner, var_1, "+special" );
    thread notifyonplayercommandbetting( var_0.owner, var_1, "+usereload" );

    for (;;)
    {
        var_0.owner waittill( var_1 );

        if ( var_0.playerbeton == -1 )
            continue;

        var_0.playerbeton = -1;
        var_0.amount = 0;
        updatebethud( var_0 );
    }
}

watchbetplaced( var_0 )
{
    self endon( "end_betting" );
    var_0.owner endon( "disconnect" );
    var_1 = "betPlacedLeft";
    var_2 = "betPlacedRight";
    thread notifyonplayercommandbetting( var_0.owner, var_1, "+smoke" );
    thread notifyonplayercommandbetting( var_0.owner, var_2, "+reload" );
    thread notifyonplayercommandbetting( var_0.owner, var_2, "+frag" );

    for (;;)
    {
        var_3 = var_0.owner scripts\engine\utility::_id_133F7( var_1, var_2 );
        var_4 = -1;

        if ( var_3 == var_1 )
            var_4 = var_0.zombienumhitsheli;
        else if ( var_3 == var_2 )
            var_4 = var_0._id_11986;

        if ( var_0.playerbeton == var_4 )
            var_5 = var_0.amount + 1;
        else
            var_5 = 1;

        if ( var_5 > var_0.owner.plundercount )
        {
            betchangefail( var_0 );
            continue;
        }

        var_0.amount = var_5;
        var_0.playerbeton = var_4;
        updatebethud( var_0 );
    }
}

notifyonplayercommandbetting( var_0, var_1, var_2 )
{
    var_0 notifyonplayercommand( var_1, var_2 );
    self waittill( "end_betting" );

    if ( isdefined( var_0 ) )
        var_0 notifyonplayercommandremove( var_1, var_2 );
}

betchangefail( var_0 )
{
    var_0.owner playlocalsound( "br_pickup_deny" );
    var_0.hudavailable thread scripts\mp\hud::fontpulse( var_0.owner );
}

updatebethud( var_0 )
{
    var_1 = 100;
    var_0.hudavailable setvalue( ( var_0.owner.plundercount - var_0.amount ) * var_1 );

    if ( var_0.playerbeton == -1 )
    {
        var_0.plunder_repositorysendcountdownmessage.label = &"MP_GULAG_BETTING/BET_CHANGE_LEFT";
        var_0.plunder_repositoryusecallback.label = &"MP_GULAG_BETTING/BET_CHANGE_RIGHT";
        var_0.plunder_repositoryusecallbackinternal.alpha = 0.0;
        var_0.plunder_repositoryendcountdown setvalue( 0 );
        var_0.plunder_repositoryextract setvalue( 0 );
        var_0.plunder_repositoryendcountdown.alpha = 0.0;
        var_0.plunder_repositoryextract.alpha = 0.0;
    }
    else if ( var_0.playerbeton == var_0.zombienumhitsheli )
    {
        var_0.plunder_repositorysendcountdownmessage.label = &"MP_GULAG_BETTING/BET_INCREASE_LEFT";
        var_0.plunder_repositoryusecallback.label = &"MP_GULAG_BETTING/BET_CHANGE_RIGHT";
        var_0.plunder_repositoryusecallbackinternal.alpha = 1.0;
        var_0.plunder_repositoryendcountdown setvalue( var_0.amount * var_1 );
        var_0.plunder_repositoryendcountdown.alpha = 1.0;
        var_0.plunder_repositoryextract.alpha = 0.0;
    }
    else if ( var_0.playerbeton == var_0._id_11986 )
    {
        var_0.plunder_repositorysendcountdownmessage.label = &"MP_GULAG_BETTING/BET_CHANGE_LEFT";
        var_0.plunder_repositoryusecallback.label = &"MP_GULAG_BETTING/BET_INCREASE_RIGHT";
        var_0.plunder_repositoryusecallbackinternal.alpha = 1.0;
        var_0.plunder_repositoryextract setvalue( var_0.amount * var_1 );
        var_0.plunder_repositoryextract.alpha = 1.0;
        var_0.plunder_repositoryendcountdown.alpha = 0.0;
    }
}

cleanupbethud( var_0, var_1 )
{
    var_0 notify( "cleanUpBetHud" );

    if ( isdefined( var_1 ) )
    {
        var_0 endon( "cleanUpBetHud" );
        wait( var_1 );
    }

    var_2 = [ var_0.plunder_repositorysendcountdownmessage, var_0.plunder_repositoryusecallback, var_0.plunder_repositoryendcountdown, var_0.plunder_repositoryextract, var_0.plundermusicsecond, var_0.plundermusicthird, var_0.plunderinstanceid, var_0.plundermusicfirst, var_0.plunderlimit, var_0.plundermusicfourth, var_0.hudavailable, var_0.plunder_repositoryusecallbackinternal ];

    foreach ( var_4 in var_2 )
    {
        if ( isdefined( var_4 ) )
            var_4 destroy();
    }
}

watchbetbutton( var_0, var_1, var_2, var_3 )
{
    self endon( "end_betting" );

    for (;;)
    {
        var_1 waittill( var_2 );
        var_0 notify( "betPlaced", var_3 );
    }
}

endbetting( var_0, var_1 )
{
    if ( !isdefined( var_1 ) || !istrue( var_1.bettingopen ) )
        return;

    var_1 notify( "end_betting" );
    var_1.bettingopen = 0;

    foreach ( var_3 in var_1.bets )
    {
        var_4 = [ var_3.plunder_repositoryusecallbackinternal, var_3.hudavailable, var_3.plunderlimit, var_3.plunderinstanceid, var_3.plundermusicfourth, var_3.plundermusicfirst, var_3.plunder_repositorysendcountdownmessage, var_3.plunder_repositoryusecallback ];

        if ( var_3.playerbeton != -1 )
        {
            if ( var_3.playerbeton == var_3.zombienumhitsheli )
            {
                var_4[var_4.size] = var_3.plundermusicthird;
                var_4[var_4.size] = var_3.plunder_repositoryusecallback;
                var_4[var_4.size] = var_3.plunder_repositoryextract;
            }
            else if ( var_3.playerbeton == var_3._id_11986 )
            {
                var_4[var_4.size] = var_3.plundermusicsecond;
                var_4[var_4.size] = var_3.plunder_repositorysendcountdownmessage;
                var_4[var_4.size] = var_3.plunder_repositoryendcountdown;
            }
        }
        else
            cleanupbethud( var_3, 0.0 );

        foreach ( var_6 in var_4 )
        {
            if ( isdefined( var_6 ) )
                var_6 destroy();
        }
    }

    updateoutlines( var_0 );
}

payoutremainingbets( var_0, var_1 )
{
    if ( !isdefined( var_1 ) )
        return;

    var_2 = -1;

    if ( isdefined( var_0 ) )
        var_2 = var_0.fighterindex;

    foreach ( var_4 in var_1.bets )
    {
        if ( var_4.playerbeton != -1 && isdefined( var_4.owner ) && !istrue( var_4.paidout ) )
        {
            var_5 = var_4.playerbeton == var_2;
            _completebet( var_1, var_4, var_5 );
        }

        thread cleanupbethud( var_4, 2.5 );
    }
}

_completebet( var_0, var_1, var_2 )
{
    var_3 = ( 0, 1, 0 );
    var_4 = ( 1, 0, 0 );
    var_1.paidout = 1;

    if ( var_2 )
    {
        var_1.owner scripts\mp\gametypes\br_plunder.gsc::playersetplundercount( var_1.owner.plundercount + var_1.amount );

        if ( var_1.playerbeton == var_1.zombienumhitsheli )
        {
            var_1.plundermusicsecond.color = var_3;
            var_1.plundermusicsecond.label = &"MP_GULAG_BETTING/FIGHER_WINNER";
            var_1.plunder_repositoryendcountdown.color = var_3;
            var_1.plunder_repositoryendcountdown.label = &"MP_GULAG_BETTING/AMOUNT_WON";
            var_1.owner playlocalsound( "ammo_crate_use" );
            var_1.plunder_repositoryendcountdown thread scripts\mp\hud::fontpulse( var_1.owner );
        }
        else if ( var_1.playerbeton == var_1._id_11986 )
        {
            var_1.plundermusicthird.color = var_3;
            var_1.plundermusicthird.label = &"MP_GULAG_BETTING/FIGHER_WINNER";
            var_1.plunder_repositoryextract.color = var_3;
            var_1.plunder_repositoryextract.label = &"MP_GULAG_BETTING/AMOUNT_WON";
            var_1.owner playlocalsound( "ammo_crate_use" );
            var_1.plunder_repositoryextract thread scripts\mp\hud::fontpulse( var_1.owner );
        }
    }
    else
    {
        if ( isalive( var_1.owner ) )
        {
            var_5 = var_1.owner.plundercount - var_1.amount;
            var_5 = int( max( 0, var_5 ) );
            var_1.owner scripts\mp\gametypes\br_plunder.gsc::playersetplundercount( var_5 );
        }

        if ( var_1.playerbeton == var_1.zombienumhitsheli )
        {
            var_1.plundermusicsecond.color = var_4;
            var_1.plundermusicsecond.label = &"MP_GULAG_BETTING/FIGHER_LOSER";
            var_1.plunder_repositoryendcountdown.color = var_4;
            var_1.plunder_repositoryendcountdown.label = &"MP_GULAG_BETTING/AMOUNT_LOST";
            var_1.plunder_repositoryendcountdown thread scripts\mp\hud::fontpulse( var_1.owner );
        }
        else if ( var_1.playerbeton == var_1._id_11986 )
        {
            var_1.plundermusicthird.color = var_4;
            var_1.plundermusicthird.label = &"MP_GULAG_BETTING/FIGHER_LOSER";
            var_1.plunder_repositoryextract.color = var_4;
            var_1.plunder_repositoryextract.label = &"MP_GULAG_BETTING/AMOUNT_LOST";
            var_1.plunder_repositoryextract thread scripts\mp\hud::fontpulse( var_1.owner );
        }
    }

    var_6 = var_0.fighters[var_1.playerbeton];

    if ( isdefined( var_6 ) )
        var_6 hudoutlinedisableforclient( var_1.owner );
}

getbettingplayers( var_0, var_1 )
{
    var_2 = var_0.jailedplayers;

    if ( level.gulag.betting > 1 )
    {
        foreach ( var_4 in var_1.fighters )
            var_2[var_2.size] = var_4;
    }

    return var_2;
}

payoutbet( var_0, var_1, var_2 )
{
    if ( !isdefined( var_0 ) )
        return;

    foreach ( var_4 in var_0.bets )
    {
        if ( var_4.playerbeton == var_1.fighterindex && isdefined( var_4.owner ) && !istrue( var_4.paidout ) )
        {
            _completebet( var_0, var_4, var_2 );
            thread cleanupbethud( var_4, 2.5 );
        }
    }
}

rock_used( var_0 )
{
    var_1 = self.arena;
    var_0 scripts\engine\utility::waittill_notify_or_timeout( "missile_stuck", 4 );
    wait 2;

    if ( isdefined( var_0 ) )
        var_0 delete();

    if ( istrue( level.usegulag ) && level.gulag._id_13113 )
        spawnrock( var_1 );
}

spawnrocks( var_0 )
{
    var_0.rocks = getentitylessscriptablearrayinradius( var_0.target, "targetname" );

    if ( var_0.rocks.size == 0 || !level.gulag._id_13113 )
    {
        for ( var_1 = 0; var_1 < var_0.rocks.size; var_1++ )
        {
            var_2 = var_0.rocks[var_1];
            var_2 setscriptablepartstate( "brloot_rock", "hidden" );
        }

        return;
    }

    var_3 = 20;

    if ( var_0.rocks.size < var_3 )
        var_3 = var_0.rocks.size;

    var_0.rocks = scripts\engine\utility::array_randomize( var_0.rocks );
    var_0.rockcounter = var_3;
    var_4 = getdvarint( "scr_br_fc_rocks", 1 ) == 0;

    for ( var_1 = 0; var_1 < var_0.rocks.size; var_1++ )
    {
        var_2 = var_0.rocks[var_1];
        var_2.arena = var_0;

        if ( var_1 >= var_3 || var_4 )
            var_2 setscriptablepartstate( "brloot_rock", "hidden" );
    }
}

rockused( var_0, var_1, var_2, var_3, var_4 )
{
    if ( !isdefined( var_0 ) || !isdefined( var_3 ) )
        return;

    var_5 = getcompleteweaponname( "rock_mp" );

    if ( var_3 hasweapon( var_5 ) && var_3 getammocount( var_5 ) > 0 )
        return;

    var_0 setscriptablepartstate( "brloot_rock", "hidden" );
    var_3 thread scripts\mp\gametypes\br_pickups.gsc::playerplaypickupanim();
    var_3 scripts\mp\equipment::giveequipment( "equip_rock", "primary" );
    var_3 playlocalsound( "br_rock_pickup" );
}

spawnrock( var_0 )
{
    if ( istrue( var_0.shutdown ) || var_0.rocks.size == 0 )
        return;

    var_1 = var_0.rocks[var_0.rockcounter];
    var_1 setscriptablepartstate( "brloot_rock", "visible" );
    var_0.rockcounter++;

    if ( var_0.rockcounter >= var_0.rocks.size )
        var_0.rockcounter = 0;
}

playertakeawayrock( var_0 )
{
    var_1 = getcompleteweaponname( "rock_mp" );

    if ( self hasweapon( var_1 ) )
    {
        self takeweapon( var_1 );
        self clearaccessory();

        if ( level.gulag._id_13113 )
            spawnrock( var_0 );
    }
}

gettangentoncirclefrompoint( var_0, var_1, var_2 )
{
    var_3 = var_2[0] - var_0[0];
    var_4 = var_2[1] - var_0[1];
    var_5 = var_1;
    var_6 = var_3 * var_3;
    var_7 = var_4 * var_4;
    var_8 = var_5 * var_5;
    var_9 = var_6 + var_7 - var_8;
    var_10 = undefined;
    var_11 = 1;

    if ( var_9 > 0 )
    {
        var_12 = ( var_8 * var_3 - var_5 * var_4 * sqrt( var_6 + var_7 - var_8 ) ) / ( var_6 + var_7 );
        var_13 = ( var_8 * var_4 + var_5 * var_3 * sqrt( var_6 + var_7 - var_8 ) ) / ( var_6 + var_7 );
        var_10 = ( var_12, var_13, var_2[2] ) + ( var_0[0], var_0[1], 0 );
    }
    else
    {
        var_14 = vectornormalize( ( var_3, var_4, 0 ) );
        var_15 = var_0 + var_14 * var_1;
        var_10 = ( var_15[0], var_15[1], var_2[2] );
        var_11 = 0;
    }

    return [ var_10, var_11 ];
}

spawnac130()
{
    if ( !istrue( level.gulag.planerespawn ) )
        return;

    level waittill( "prematch_started" );

    if ( !istrue( level.br_infils_disabled ) )
        wait 10;

    var_0 = undefined;
    var_1 = undefined;

    if ( isdefined( level.br_ac130 ) )
        var_0 = level.br_ac130.startpt;
    else
    {
        var_2 = scripts\mp\gametypes\br_c130.gsc::createtestc130path();
        var_0 = var_2.startpt;
    }

    if ( isdefined( level.br_circle ) && isdefined( level.br_circle.safecircleent ) )
        var_1 = level.br_circle.safecircleent.origin[2];
    else
        var_1 = level.br_level.br_circleradii[0];

    var_1 = var_1 - 100;
    [var_4, var_5] = gettangentoncirclefrompoint( level.br_level.br_mapcenter, var_1, var_0 );
    var_6 = 0;
    var_7 = 0;

    if ( var_5 )
    {
        var_6 = distance( var_0, var_4 );
        var_7 = var_6 / scripts\mp\gametypes\br_c130.gsc::getc130speed();
    }

    var_8 = ( level.br_level.br_mapcenter[0], level.br_level.br_mapcenter[1], var_0[2] );
    level.gulag.ac130linker = spawn( "script_model", var_8 );
    level.gulag.ac130linker setmodel( "tag_origin" );
    level.gulag.ac130linker.radius = var_1;
    level.gulag.ac130 = scripts\mp\gametypes\br_c130.gsc::gunship_spawn( var_0, var_4, var_7, 0, ::ac130handlemovement );
    level.gulag.ac130 thread ac130setupanim();
    level.gulag.ac130.riders = [];

    if ( var_7 <= 0 )
    {
        var_9 = var_4 - level.br_level.br_mapcenter;
        var_10 = vectornormalize( ( var_9[0], var_9[1], 0 ) );
        var_11 = vectortoangles( var_10 );
        level.gulag.ac130 unlink();
        level.gulag.ac130.angles = ( 0, var_11[1] + 90, 0 );
        level.gulag.ac130.origin = var_4;
        level.gulag.ac130 thread ac130linkandspin();
    }
}

ac130setupanim()
{
    var_0 = spawnstruct();
    self.animstruct = var_0;
    var_0.movingc130 = self;
    scripts\mp\gametypes\br_infils.gsc::spawnplayerpositionparentent( var_0, self );
    scripts\mp\gametypes\br_infils.gsc::spawnplayerpositionent( var_0, "j_prop_1" );
    scripts\mp\gametypes\br_infils.gsc::playac130infilloopanims( var_0 );
}

ac130handlemovement( var_0, var_1 )
{
    level endon( "game_ended" );
    self endon( "death" );
    self playloopsound( "br_ac130_lp" );

    if ( var_1 > 0 )
    {
        self moveto( var_0, var_1, 0, 0 );
        wait( var_1 );
    }

    thread ac130linkandspin();
}

ac130linkandspin()
{
    self notify( "ac130LinkAndSpin" );
    self endon( "ac130LinkAndSpin" );
    level.gulag.ac130linker endon( "death" );
    var_0 = 6.28318;
    var_1 = scripts\mp\gametypes\br_c130.gsc::getc130speed();
    var_2 = level.gulag.ac130linker.radius;
    var_3 = var_0 * var_2 / var_1;
    self linkto( level.gulag.ac130linker, "tag_origin" );

    if ( var_3 <= 0 )
        return;

    for (;;)
    {
        level.gulag.ac130linker rotateyaw( 360, var_3 );
        wait( var_3 );
    }
}

waittillallarenasshutdown()
{
    var_0 = level.gulag.arenas.size;

    if ( !istrue( level.gulag.multiarena ) )
        var_0 = 1;

    for (;;)
    {
        var_1 = 0;

        for ( var_2 = 0; var_2 < var_0; var_2++ )
        {
            var_3 = level.gulag.arenas[var_2];

            if ( !istrue( var_3.shutdown ) )
            {
                var_1 = 1;
                break;
            }
        }

        if ( !var_1 )
            return;

        waitframe();
    }
}

makeac130flyaway()
{
    if ( !istrue( level.gulag.planerespawn ) )
        return;

    var_0 = gettime();
    waittillallarenasshutdown();
    var_1 = gettime();
    wait( getdvarint( "scr_br_fc_respawn_wait", 15 ) );
    waittillframeend;

    foreach ( var_3 in level.gulag.ac130.riders )
    {
        if ( isdefined( var_3 ) )
        {
            var_3.jumptype = "solo";
            var_3 notify( "halo_kick_c130" );
        }
    }

    while ( level.gulag.ac130.riders.size > 0 )
        waitframe();

    var_5 = level.gulag.ac130.origin;
    var_6 = anglestoforward( level.gulag.ac130.angles );
    var_7 = level.br_level.br_circleradii[0] * 2;
    var_8 = var_5 + var_6 * var_7;
    var_8 = var_8 + var_6 * scripts\mp\gametypes\br_c130.gsc::getc130speed();
    var_9 = distance( var_5, var_8 );
    var_10 = var_9 / scripts\mp\gametypes\br_c130.gsc::getc130speed();
    level.gulag.ac130 notify( "ac130LinkAndSpin" );
    level.gulag.ac130 unlink();
    level.gulag.ac130 moveto( var_8, var_10, 0, 0 );
    wait( var_10 );
    scripts\mp\gametypes\br_public.gsc::cleanac130struct( level.gulag.ac130.animstruct );

    if ( isdefined( level.gulag.ac130 ) )
        level.gulag.ac130 delete();

    if ( isdefined( level.gulag.ac130linker ) )
        level.gulag.ac130linker delete();
}

transitioncircle( var_0, var_1 )
{
    if ( !istrue( level.gulag.planerespawn ) )
        return;

    if ( !isdefined( level.gulag.ac130 ) || !isdefined( level.gulag.ac130linker ) )
        return;

    var_2 = ( level.br_circle.safecircleent.origin[0], level.br_circle.safecircleent.origin[1], level.gulag.ac130linker.origin[2] );
    var_0 = var_0 - 100;

    if ( level.gulag.ac130linker.radius != var_0 )
    {
        var_3 = vectornormalize( level.gulag.ac130linker.origin - level.gulag.ac130.origin );
        var_4 = level.gulag.ac130.origin + var_3 * var_0;
        level.gulag.ac130 unlink();
        level.gulag.ac130linker.origin = var_4;
        level.gulag.ac130linker.radius = var_0;
        level.gulag.ac130linker dontinterpolate();
        level.gulag.ac130 thread ac130linkandspin();
    }

    level.gulag.ac130linker moveto( var_2, var_1 );
    wait( var_1 );
}

playersetupac130()
{
    self.infilanimindex = 1;
    self.isjumpmaster = 0;
    scripts\mp\gametypes\br_infils.gsc::playerlinktopositionent( level.gulag.ac130.animstruct );
    thread scripts\mp\gametypes\br_infils.gsc::playerplayinfilloopanim( level.gulag.ac130.animstruct );
    thread playerputinc130( level.gulag.ac130 );
    scripts\mp\gametypes\br_infils.gsc::playersetupcontrolsforinfil( 1 );
    thread playerac130cleanup();
    thread playerautodeployaftertime();
    thread playerspawnprotectionac130();
    level.gulag.ac130.riders[level.gulag.ac130.riders.size] = self;
}

playerputinc130( var_0 )
{
    self.angles = var_0.angles;
    thread listenjump( var_0 );
    thread scripts\mp\gametypes\br_c130.gsc::listenkick( var_0, 0 );
    scripts\mp\utility\game::_id_123C0( self, 1 );
    self.br_infil_type = "c130";
    thread scripts\mp\gametypes\br_c130.gsc::orbitcam( var_0 );
}

listenjump( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "cancel_c130" );
    self endon( "br_jump" );
    self.redeployenabled = 0;
    scripts\engine\utility::waittill_either( "halo_jump_c130", "halo_jump_solo_c130" );
    self.jumptype = "solo";
    thread scripts\mp\gametypes\br_c130.gsc::leaveplane( var_0, 0, self getplayerangles(), 0 );
}

playerspawnprotectionac130()
{
    self endon( "death_or_disconnect" );
    self.plotarmor = 1;
    scripts\mp\gametypes\br_c130.gsc::setplayervarinrespawnc130( 1 );
    waittillplayerdoneskydivingac130( self );
    self.plotarmor = undefined;
    scripts\mp\gametypes\br_c130.gsc::setplayervarinrespawnc130( 0 );
}

waittillplayerdoneskydivingac130( var_0 )
{
    var_0 endon( "timeout_gulag_ac130" );
    thread _waittillplayerdoneskydivingac130timeout( var_0 );
    var_0 waittill( "infil_jump_done" );

    while ( !var_0 isparachuting() && !var_0 isonground() )
        waitframe();
}

_waittillplayerdoneskydivingac130timeout( var_0 )
{
    var_0 endon( "death_or_disconnect" );
    var_0 scripts\engine\utility::_id_13404( getdvarint( "scr_br_fc_respawn_wait", 15 ), "halo_kick_c130", "halo_jump_solo_c130" );
    wait 15;
    var_0 notify( "timeout_gulag_ac130" );
}

playerautodeployaftertime()
{
    level endon( "game_ended" );
    self endon( "death" );
    self endon( "disconnect" );
    self endon( "cancel_c130" );
    self endon( "br_jump" );
    wait( getdvarint( "scr_br_fc_respawn_wait", 15 ) );
    self.jumptype = "solo";
    self notify( "halo_kick_c130" );
}

playerac130cleanup()
{
    level endon( "game_ended" );
    scripts\engine\utility::_id_133F1( "disconnect", "death", "cancel_c130", "infil_jump_done" );

    if ( !isdefined( level.gulag.ac130.riders ) )
        return;

    if ( isdefined( self ) )
        level.gulag.ac130.riders = scripts\engine\utility::array_remove( level.gulag.ac130.riders, self );
    else
        level.gulag.ac130.riders = scripts\engine\utility::array_removeundefined( level.gulag.ac130.riders );
}

playergulagautowin( var_0, var_1, var_2, var_3, var_4 )
{
    var_5 = self;
    level endon( "game_ended" );
    var_5 endon( "disconnect" );
    var_5 notify( "gulag_auto_win" );

    if ( istrue( var_5.respawningfromtoken ) )
        return;

    [var_7, var_8] = var_5 x1opsspawnnpc( var_1, var_2, var_4, undefined, var_0 );
    var_5.respawningfromtoken = 1;
    var_9 = var_5 _id_11A0E();
    var_10 = scripts\mp\gametypes\br_public.gsc::musictriggerthink() / 1000;
    var_11 = var_5 x1opsnpcweaponbarrelmodel( 0, var_10 );
    var_12 = var_5 _id_11977( var_11 );
    self.forcespawnorigin = var_12;
    var_13 = scripts\mp\gametypes\br_gametypes.gsc::_id_1209E( "playerGulagAutoWinWait", var_1, var_2 );

    if ( !istrue( var_13 ) )
    {
        var_14 = 1.0;
        wait( var_14 );
    }

    if ( var_9 )
        var_5 scripts\mp\utility\lower_message::setlowermessageomnvar( 0 );

    var_15 = 1.0;
    var_5 gulagfadetoblack( 1 );
    wait( var_15 );
    var_5 scripts\mp\hud_message::fire_rpg_to_target();
    var_5 scripts\mp\playerlogic::spawnplayer( undefined, 0 );
    var_5 scripts\cp_mp\execution::_clearexecution();
    var_5 scripts\mp\gametypes\br_pickups.gsc::initplayer();
    var_5 scripts\mp\gametypes\br_spectate.gsc::weapon_xp_iw8_ar_golf36();
    var_5.respawningfromtoken = undefined;

    if ( !isdefined( var_1 ) && !istrue( var_3 ) )
        var_5 thread _id_12E9D( 4 );

    var_5.plotarmor = undefined;
    var_5.c130 = undefined;
    var_5 gulagwinnerrespawn( 1, var_8, var_11, 1, var_12, undefined, var_7, var_4 );
}

x1opsspawnnpc( var_0, var_1, var_2, var_3, var_4 )
{
    var_5 = self;
    var_6 = var_5;
    var_7 = "token";

    if ( isdefined( var_0 ) )
    {
        var_8 = istrue( var_5.clean_up_search ) && !isalive( var_5 ) && istrue( var_5._id_13480 );
        var_6 = var_0;
        var_7 = "token_sponsored";

        if ( !istrue( var_3 ) )
        {
            if ( istrue( var_1 ) )
                var_9 = 6;
            else
                var_9 = 10;

            var_5 thread _id_12E9D( var_9 );
        }
    }

    if ( isdefined( var_0 ) || istrue( var_2 ) )
    {
        var_5 scripts\mp\playerlogic::addtoalivecount( var_4 );
        scripts\mp\gametypes\br.gsc::_id_12FD8( var_5, var_4 );
    }

    scripts\mp\gametypes\br_analytics.gsc::close_c130crate_gate( var_5, var_7 );
    scripts\mp\gametypes\br_analytics.gsc::cloudcoverfx( self, int( isdefined( var_0 ) ) );

    if ( istrue( var_6.hasrespawntoken ) )
        var_6 scripts\mp\gametypes\br_pickups.gsc::removerespawntoken();

    return [ var_6, var_7 ];
}

_id_11A0E()
{
    var_0 = self;
    var_1 = istrue( var_0._id_11B7E );

    if ( var_1 )
    {
        var_0 scripts\mp\utility\lower_message::setlowermessageomnvar( 76 );

        while ( istrue( var_0._id_11B7E ) )
            waitframe();
    }

    return var_1;
}

gulaginitloadouts()
{
    level.gulag.scriptable_damaged_funcs = get_heli_structs();
    get_highest_priority_goal_position();
}

get_heli_structs()
{
    var_0 = [];
    var_0["loadoutArchetype"] = "archetype_assault";
    var_0["loadoutPrimary"] = "iw8_fists";
    var_0["loadoutPrimaryAttachment"] = "none";
    var_0["loadoutPrimaryAttachment2"] = "none";
    var_0["loadoutPrimaryCamo"] = "none";
    var_0["loadoutPrimaryReticle"] = "none";
    var_0["loadoutSecondary"] = "none";
    var_0["loadoutSecondaryAttachment"] = "none";
    var_0["loadoutSecondaryAttachment2"] = "none";
    var_0["loadoutSecondaryCamo"] = "none";
    var_0["loadoutSecondaryReticle"] = "none";
    var_0["loadoutMeleeSlot"] = "none";
    var_0["loadoutEquipmentPrimary"] = "equip_rock";
    var_0["loadoutEquipmentSecondary"] = "none";
    var_0["loadoutStreakType"] = "assault";
    var_0["loadoutKillstreak1"] = "none";
    var_0["loadoutKillstreak2"] = "none";
    var_0["loadoutKillstreak3"] = "none";
    var_0["loadoutSuper"] = "super_br_extract";
    var_0["loadoutPerks"] = [ "specialty_null" ];
    var_0["loadoutGesture"] = "playerData";
    var_0["loadoutExecution"] = "none";
    return var_0;
}

get_highest_priority_goal_position()
{
    level.pickuptrigger = [];
    level.pilot_anim_loop = enter_numbers_init();

    if ( getdvar( "scr_br_gulag_loadout_override" ) != "" )
    {
        var_0 = strtok( getdvar( "scr_br_gulag_loadout_override" ), " " );
        var_1 = [];

        for ( var_2 = 0; var_2 < var_0.size; var_2++ )
            var_1[var_1.size] = int( var_0[var_1.size] );

        var_3 = var_1.size;

        for ( var_4 = 0; var_4 < var_3; var_4++ )
            level.pickuptrigger[level.pickuptrigger.size] = get_heli_intro_vo( var_1[var_4] );
    }
    else
    {
        var_3 = tablelookupgetnumcols( level.pilot_anim_loop ) - 1;

        for ( var_4 = 0; var_4 < var_3; var_4++ )
            level.pickuptrigger[level.pickuptrigger.size] = get_heli_intro_vo( var_4 );
    }
}

enter_numbers_init()
{
    var_0 = getdvarint( "scr_br_gulag_table_override", 0 );

    if ( var_0 )
    {
        if ( var_0 == 444 )
        {
            if ( randomint( 2 ) == 0 )
                return "mp/classtable_br_gulagdbd1.csv";
            else
                return "mp/classtable_br_gulagdbd2.csv";
        }
        else
            return "mp/classtable_br_gulag" + var_0 + ".csv";
    }

    var_1 = randomint( 1337 ) + 1;

    if ( var_1 == 1337 )
        return "mp/classtable_br_gulag99.csv";

    var_2 = randomint( 100 ) + 1;

    if ( var_2 > 90 )
        return "mp/classtable_br_gulag4.csv";
    else if ( var_2 > 65 )
        return "mp/classtable_br_gulag2.csv";
    else if ( var_2 > 40 )
        return "mp/classtable_br_gulag3.csv";
    else
        return "mp/classtable_br_gulag1.csv";

    return "mp/classtable_br_gulag1.csv";
}

get_heli_intro_vo( var_0 )
{
    var_1["loadoutArchetype"] = "archetype_assault";
    var_1["loadoutPrimary"] = tablelookup( level.pilot_anim_loop, 0, "loadoutPrimary", var_0 + 1 );
    var_1["loadoutPrimaryAttachment"] = tablelookup( level.pilot_anim_loop, 0, "loadoutPrimaryAttachment1", var_0 + 1 );
    var_1["loadoutPrimaryAttachment2"] = tablelookup( level.pilot_anim_loop, 0, "loadoutPrimaryAttachment2", var_0 + 1 );
    var_1["loadoutPrimaryAttachment3"] = tablelookup( level.pilot_anim_loop, 0, "loadoutPrimaryAttachment3", var_0 + 1 );
    var_1["loadoutPrimaryAttachment4"] = tablelookup( level.pilot_anim_loop, 0, "loadoutPrimaryAttachment4", var_0 + 1 );
    var_1["loadoutPrimaryAttachment5"] = tablelookup( level.pilot_anim_loop, 0, "loadoutPrimaryAttachment5", var_0 + 1 );
    var_1["loadoutPrimaryCamo"] = tablelookup( level.pilot_anim_loop, 0, "loadoutPrimaryCamo", var_0 + 1 );
    var_1["loadoutPrimaryReticle"] = tablelookup( level.pilot_anim_loop, 0, "loadoutPrimaryReticle", var_0 + 1 );
    var_1["loadoutSecondary"] = tablelookup( level.pilot_anim_loop, 0, "loadoutSecondary", var_0 + 1 );
    var_1["loadoutSecondaryAttachment"] = tablelookup( level.pilot_anim_loop, 0, "loadoutSecondaryAttachment1", var_0 + 1 );
    var_1["loadoutSecondaryAttachment2"] = tablelookup( level.pilot_anim_loop, 0, "loadoutSecondaryAttachment2", var_0 + 1 );
    var_1["loadoutSecondaryAttachment3"] = tablelookup( level.pilot_anim_loop, 0, "loadoutSecondaryAttachment3", var_0 + 1 );
    var_1["loadoutSecondaryAttachment4"] = tablelookup( level.pilot_anim_loop, 0, "loadoutSecondaryAttachment4", var_0 + 1 );
    var_1["loadoutSecondaryAttachment5"] = tablelookup( level.pilot_anim_loop, 0, "loadoutSecondaryAttachment5", var_0 + 1 );
    var_1["loadoutSecondaryCamo"] = tablelookup( level.pilot_anim_loop, 0, "loadoutSecondaryCamo", var_0 + 1 );
    var_1["loadoutSecondaryReticle"] = tablelookup( level.pilot_anim_loop, 0, "loadoutSecondaryReticle", var_0 + 1 );
    var_1["loadoutMeleeSlot"] = "none";
    var_1["loadoutEquipmentPrimary"] = tablelookup( level.pilot_anim_loop, 0, "loadoutEquipmentPrimary", var_0 + 1 );
    var_1["loadoutEquipmentSecondary"] = tablelookup( level.pilot_anim_loop, 0, "loadoutEquipmentSecondary", var_0 + 1 );
    var_1["loadoutStreakType"] = "assault";
    var_1["loadoutKillstreak1"] = "none";
    var_1["loadoutKillstreak2"] = "none";
    var_1["loadoutKillstreak3"] = "none";
    var_1["loadoutSuper"] = "none";
    var_1["loadoutPerks"] = [ tablelookup( level.pilot_anim_loop, 0, "loadoutPerk1", var_0 + 1 ), tablelookup( level.pilot_anim_loop, 0, "loadoutPerk2", var_0 + 1 ), tablelookup( level.pilot_anim_loop, 0, "loadoutPerk3", var_0 + 1 ), tablelookup( level.pilot_anim_loop, 0, "loadoutExtraPerk1", var_0 + 1 ), tablelookup( level.pilot_anim_loop, 0, "loadoutExtraPerk2", var_0 + 1 ), tablelookup( level.pilot_anim_loop, 0, "loadoutExtraPerk3", var_0 + 1 ) ];
    var_1["loadoutGesture"] = "playerData";
    var_1["tableColumn"] = var_0;
    return var_1;
}

playergivearenaloadout( var_0, var_1 )
{
    if ( getdvarint( "scr_br_fc_loadouts", 1 ) == 0 )
        return;

    self.pers["gamemodeLoadout"] = level.pickuptrigger[var_1];
    enablejuggernautcrateobjective( var_1 );
    self.class = "gamemode";
    self.prevweaponobj = undefined;
    var_2 = scripts\mp\class::loadout_getclassstruct();
    var_2 = scripts\mp\class::loadout_updateclass( var_2, "gamemode" );
    scripts\mp\class::preloadandqueueclassstruct( var_2, 1, 1 );
    scripts\mp\class::giveloadout( self.team, "gamemode", 0, 0 );
    self givestartammo( var_2.loadoutprimaryobject );

    if ( isdefined( var_2.loadoutsecondaryobject ) )
        self givestartammo( var_2.loadoutsecondaryobject );

    self.pickupchecks = level.pickuptrigger[var_1]["tableColumn"];
    _id_119B7( var_0, "loadoutRow", self.pickupchecks );
}

enablejuggernautcrateobjective( var_0 )
{
    if ( getdvarint( "scr_br_alt_mode_gg", 0 ) )
    {
        switch ( var_0 )
        {
            case 0:
                var_1 = "iw8_pi_decho";
                break;
            case 1:
                var_1 = "iw8_pi_cpapa";
                break;
            case 2:
                var_1 = "iw8_pi_decho";
                break;
            case 3:
                var_1 = "iw8_pi_cpapa";
                break;
            case 4:
                var_1 = "iw8_pi_decho";
                break;
            case 5:
                var_1 = "iw8_pi_cpapa";
                break;
            case 6:
                var_1 = "iw8_pi_decho";
                break;
            case 7:
                var_1 = "iw8_pi_cpapa";
                break;
            case 8:
                var_1 = "iw8_pi_decho";
                break;
            case 9:
            default:
                var_1 = "iw8_pi_cpapa";
        }

        self.pers["gamemodeLoadout"]["loadoutPrimary"] = var_1;
        self.pers["gamemodeLoadout"]["loadoutPrimaryAttachment"] = "none";
        self.pers["gamemodeLoadout"]["loadoutPrimaryAttachment2"] = "none";
        self.pers["gamemodeLoadout"]["loadoutPrimaryAttachment3"] = "none";
        self.pers["gamemodeLoadout"]["loadoutPrimaryAttachment4"] = "none";
        self.pers["gamemodeLoadout"]["loadoutPrimaryAttachment5"] = "none";
        self.pers["gamemodeLoadout"]["loadoutSecondary"] = "none";
        self.pers["gamemodeLoadout"]["loadoutSecondaryAttachment"] = "none";
        self.pers["gamemodeLoadout"]["loadoutSecondaryAttachment2"] = "none";
        self.pers["gamemodeLoadout"]["loadoutSecondaryAttachment3"] = "none";
        self.pers["gamemodeLoadout"]["loadoutSecondaryAttachment4"] = "none";
        self.pers["gamemodeLoadout"]["loadoutSecondaryAttachment5"] = "none";
        self.pers["gamemodeLoadout"]["loadoutPerks"] = [ "specialty_null" ];
    }
}

getloadoutindex()
{
    if ( getdvarint( "scr_br_fc_loadouts", 1 ) == 0 )
        return;

    var_0 = getdvarint( "scr_br_fc_loadoutOverride", -1 );

    if ( var_0 > -1 && var_0 < level.pickuptrigger.size )
        return var_0;

    if ( getdvar( "scr_br_gulag_loadout_override" ) != "" )
    {
        if ( !isdefined( level.pickupchecks ) || level.pickupchecks >= level.pickuptrigger.size )
            level.pickupchecks = 0;

        var_1 = level.pickupchecks;
        level.pickupchecks = level.pickupchecks + 1;
    }
    else
        var_1 = randomint( level.pickuptrigger.size );

    return var_1;
}

_id_132F2( var_0 )
{
    var_0 endon( "fight_over" );
    var_0 endon( "matchEnded" );
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    var_1 = level.gulag.timelimit;
    level.gulag.timelimit = 180;
    iprintln( "Loadout verification starting in 3 seconds." );
    wait 3.0;
    iprintln( "Verification start!" );

    for ( var_2 = 0; var_2 < level.pickuptrigger.size; var_2++ )
    {
        iprintln( "Loadout: " + var_2 );
        playergivearenaloadout( var_0, var_2 );
        wait 5.0;
        scripts\cp_mp\utility\inventory_utility::_switchtoweapon( self.secondaryweapon );
        wait 4.0;
    }

    playergivearenaloadout( var_0, 0 );
    level.gulag.timelimit = var_1;
    iprintln( "Verification done!" );
}

_id_12443( var_0 )
{
    var_1 = getdvarint( "scr_br_fc_flag_radius", 50 );
    var_0.i_see_player_vehicle_watcher = spawnstruct();
    var_2 = getgroundposition( var_0.center, 1 );
    var_0.i_see_player_vehicle_watcher.trigger = spawn( "trigger_radius", var_2, 0, int( var_1 ), int( level.classify_players_based_on_laststand ) );
    var_3 = scripts\mp\gametypes\obj_dom.gsc::setupobjective( var_0.i_see_player_vehicle_watcher.trigger, "neutral", undefined, 1 );
    var_3.onuse = ::arenaflag_onuse;
    var_3.onbeginuse = ::arenaflag_onusebegin;
    var_3.onenduse = ::arenaflag_onuseend;
    var_3.onuseupdate = ::arenaflag_onuseupdate;
    var_3.oncontested = ::arenaflag_oncontested;
    var_3.isarena = 1;
    var_3 scripts\mp\gameobjects::pinobjiconontriggertouch();
    var_3.id = "domFlag";
    var_3 scripts\mp\gameobjects::setcapturebehavior( "persistent" );
    var_3.scriptable delete();
    var_3.ignorestomp = 1;
    var_3 scripts\mp\gameobjects::requestid( 0, 1, undefined, 0, 0 );
    var_3.visibilitymanuallycontrolled = 1;
    var_3 br_add_player_commands( 0 );
    var_3 br_allowdropspawnafterprematch( var_0, 0 );
    var_3.arena = var_0;
    var_0.i_see_player_vehicle_watcher.arenaflag = var_3;
}

ignoregulagredeploysplash( var_0 )
{
    wait 1.0;

    if ( isdefined( var_0 ) && isdefined( var_0.i_see_player_vehicle_watcher ) && isdefined( var_0.i_see_player_vehicle_watcher.arenaflag ) && isdefined( var_0.i_see_player_vehicle_watcher.arenaflag.flagmodel ) )
        return;
}

br_add_player_commands( var_0 )
{
    if ( var_0 )
    {
        scripts\mp\gameobjects::allowuse( "any" );
        self.trigger scripts\engine\utility::trigger_on();
    }
    else
    {
        scripts\mp\gameobjects::allowuse( "none" );
        self.trigger scripts\engine\utility::trigger_off();
        scripts\mp\gameobjects::resetcaptureprogress();
    }
}

br_allowdropspawnafterprematch( var_0, var_1, var_2, var_3 )
{
    self notify( "arenaFlag_setVisible" );

    if ( var_1 )
    {
        var_4 = "waypoint_captureneutral";

        if ( istrue( var_2 ) )
            var_4 = level.prematchintiallandingcomplete;

        thread bounceshot( var_0 );
        thread scripts\mp\gameobjects::setobjectivestatusicons( var_4 );
        thread scripts\mp\gameobjects::setownerteam( "neutral" );
        thread scripts\mp\gametypes\obj_dom.gsc::updateflagstate( "idle", 0, "none" );
        self.flagmodel show();
        thread br_alt_mode_inflation( var_0, 1 );

        if ( !istrue( var_2 ) )
        {
            _id_123B2( var_0, 1 );
            return;
        }
    }
    else
        thread br_allowloadout( var_0, var_2, var_3 );
}

br_allowloadout( var_0, var_1, var_2 )
{
    self endon( "arenaFlag_setVisible" );

    if ( !istrue( var_2 ) )
    {
        objective_setpinned( self.objidnum, 0 );
        wait 1;
    }

    thread br_alt_mode_inflation( var_0, 0 );
    thread bottompercentagetoadjusteconomy( var_2 );
    thread scripts\mp\gametypes\obj_dom.gsc::updateflagstate( "off", 0, "none" );
    self.flagmodel hide( 1 );

    if ( !istrue( var_1 ) )
    {
        _id_123B2( var_0, 0 );
        _id_123B3( var_0, 0 );
    }
}

br_alt_mode_impulse_player( var_0, var_1 )
{
    var_1 endon( "death_or_disconnect" );

    if ( var_0 )
    {
        var_1 setclientomnvar( "ui_overtime_timer_show", 1 );
        objective_addclienttomask( self.objidnum, var_1 );
    }
    else
    {
        objective_unpinforclient( self.objidnum, var_1 );
        wait 1;
        var_1 setclientomnvar( "ui_overtime_timer_show", 0 );
        objective_removeclientfrommask( self.objidnum, var_1 );
    }

    thread br_ammo_player_is_maxed_out( var_0, var_1 );
}

box_used_common_setup( var_0, var_1 )
{
    thread br_allowdropspawnafterprematch( var_0, 1, 1 );
    wait( var_1 );
    thread br_allowdropspawnafterprematch( var_0, 0, 1, 1 );
}

bounceshot( var_0 )
{
    objective_removeallfrommask( self.objidnum );

    foreach ( var_2 in var_0.jailedplayers )
        objective_addclienttomask( self.objidnum, var_2 );

    foreach ( var_2 in var_0.arenaplayers )
        objective_addclienttomask( self.objidnum, var_2 );

    objective_showtoplayersinmask( self.objidnum );
}

bottompercentagetoadjusteconomy( var_0 )
{
    objective_setshowprogress( self.objidnum, 0 );
    objective_removeallfrommask( self.objidnum );
    objective_showtoplayersinmask( self.objidnum );
}

br_alt_mode_inflation( var_0, var_1 )
{
    if ( var_1 )
    {
        if ( var_0.jailedplayers.size > 0 )
            self.flagmodel hudoutlineenableforclients( var_0.jailedplayers, "outline_nodepth_orange" );

        if ( var_0.arenaplayers.size > 0 )
            self.flagmodel hudoutlineenableforclients( var_0.arenaplayers, "outline_nodepth_orange" );
    }
    else
    {
        if ( var_0.jailedplayers.size > 0 )
            self.flagmodel hudoutlinedisableforclients( var_0.jailedplayers );

        if ( var_0.arenaplayers.size > 0 )
            self.flagmodel hudoutlinedisableforclients( var_0.arenaplayers );
    }
}

br_ammo_player_is_maxed_out( var_0, var_1 )
{
    if ( var_0 )
        self.flagmodel hudoutlineenableforclient( var_1, "outline_nodepth_orange" );
    else
        self.flagmodel hudoutlinedisableforclient( var_1 );
}

arenaflag_onusebegin( var_0 )
{
    var_1 = getdvarint( "scr_br_fc_flag_capture_time", 3.0 );
    var_0.iscapturing = 1;
    var_2 = scripts\mp\gameobjects::getownerteam();

    if ( var_2 == "neutral" )
        var_0 setclientomnvar( "ui_objective_state", 1 );

    self.neutralizing = istrue( level.flagneutralization ) && var_2 != "neutral";

    if ( !istrue( self.neutralized ) )
        self.didstatusnotify = 0;

    var_3 = var_1;
    scripts\mp\gameobjects::setusetime( var_3 );

    if ( istrue( level.capturedecay ) )
        thread scripts\mp\gameobjects::useobjectdecay( var_0.team );

    if ( var_3 > 0 )
    {
        foreach ( var_5 in self.arena.arenaplayers )
        {
            if ( var_5 != var_0 && var_5.team != var_0.team )
            {
                self.prevownerteam = var_5.team;
                break;
            }
        }

        scripts\mp\gametypes\obj_dom.gsc::updateflagcapturestate( var_0.team );
        scripts\mp\gameobjects::setobjectivestatusicons( "waypoint_taking", "waypoint_losing" );
    }
}

arenaflag_onuseupdate( var_0, var_1, var_2, var_3 )
{
    var_4 = scripts\mp\gameobjects::getownerteam();

    if ( var_1 > 0.05 && var_2 && !self.didstatusnotify )
        self.didstatusnotify = 1;
}

arenaflag_onuseend( var_0, var_1, var_2 )
{
    self.didstatusnotify = 0;

    if ( var_2 )
        scripts\mp\objidpoolmanager::objective_show_progress( self.objidnum, 0 );

    if ( isplayer( var_1 ) )
    {
        var_1.iscapturing = 0;
        var_1 setclientomnvar( "ui_objective_state", 0 );
        var_1.ui_dom_securing = undefined;
    }

    var_3 = scripts\mp\gameobjects::getownerteam();

    if ( var_3 == "neutral" )
    {
        scripts\mp\gameobjects::setobjectivestatusicons( "waypoint_captureneutral" );
        thread scripts\mp\gametypes\obj_dom.gsc::updateflagstate( "idle", 0 );
    }
    else
    {
        scripts\mp\gameobjects::setobjectivestatusicons( "waypoint_defend", "waypoint_capture" );
        thread scripts\mp\gametypes\obj_dom.gsc::updateflagstate( var_3, 0 );
    }

    if ( !var_2 )
        self.neutralized = 0;
}

bpullout( var_0, var_1 )
{
    scripts\mp\gameobjects::setownerteam( var_0 );
    self notify( "capture", var_1 );
    self notify( "assault", var_1 );
    scripts\mp\gameobjects::setobjectivestatusicons( "waypoint_defending", "waypoint_capture" );
    self.neutralized = 0;
    thread scripts\mp\gametypes\obj_dom.gsc::updateflagstate( var_0, 0, var_0 );

    if ( self.touchlist[var_0].size == 0 && isdefined( self.oldtouchlist ) )
        self.touchlist = self.oldtouchlist;

    foreach ( var_3 in self.arena.arenaplayers )
    {
        if ( var_3 != var_1 && var_3.team != var_0 && isdefined( self.assisttouchlist[var_3.team] ) )
        {
            self.assisttouchlist[var_3.team] = [];
            break;
        }
    }
}

arenaflag_onuse( var_0 )
{
    var_1 = var_0.team;
    self.capturetime = gettime();
    self.neutralized = 0;
    bpullout( var_1, var_0 );

    if ( !self.neutralized )
    {
        foreach ( var_3 in self.arena.arenaplayers )
        {
            if ( isalive( var_3 ) && var_3.team != var_1 )
                var_3 thread pilot_linkto_angles_offset( self.arena );
        }

        thread handleendarena( self.arena );
        self.firstcapture = 0;
    }
}

arenaflag_oncontested()
{
    scripts\mp\gameobjects::setobjectivestatusicons( "waypoint_contested" );
    scripts\mp\objidpoolmanager::objective_set_progress_team( self.objidnum, undefined );
    thread scripts\mp\gametypes\obj_dom.gsc::updateflagstate( "contested", 0 );
}

move_closest_chopper_boss_vandalize_node_down( var_0, var_1 )
{
    var_2 = 0;
    var_3 = 0;
    var_4 = "";

    switch ( var_0 )
    {
        case "playerArena0":
            [var_2, var_3, var_4] = [ 0, 8, "ui_br_gulag_players_1" ];
            var_1 = var_1 + 1;
            break;
        case "playerArena1":
            [var_2, var_3, var_4] = [ 8, 8, "ui_br_gulag_players_1" ];
            var_1 = var_1 + 1;
            break;
        case "playerJail0":
            [var_2, var_3, var_4] = [ 16, 8, "ui_br_gulag_players_1" ];
            var_1 = var_1 + 1;
            break;
        case "playerJail1":
            [var_2, var_3, var_4] = [ 24, 8, "ui_br_gulag_players_1" ];
            var_1 = var_1 + 1;
            break;
        case "loadoutRow":
            [var_2, var_3, var_4] = [ 0, 8, "ui_br_gulag_data" ];
            var_1 = var_1 + 1;
            break;
        case "playerHealth0":
            [var_2, var_3, var_4] = [ 8, 8, "ui_br_gulag_data" ];
            break;
        case "playerHealth1":
            [var_2, var_3, var_4] = [ 16, 8, "ui_br_gulag_data" ];
            break;
        default:
            break;
    }

    return [ var_2, var_3, var_4, var_1 ];
}

using_self_revive( var_0, var_1, var_2, var_3, var_4 )
{
    var_5 = int( pow( 2, var_4 ) ) - 1;
    var_6 = ( var_2 & var_5 ) << var_3;
    var_7 = ~( var_5 << var_3 );
    var_8 = var_0.tutdmzonplayerkilled[var_1];
    var_9 = var_8 & var_7;
    var_10 = var_9 + var_6;
    var_0.tutdmzonplayerkilled[var_1] = var_10;
}

_id_12354( var_0, var_1, var_2 )
{
    [var_4, var_5, var_6, var_2] = move_closest_chopper_boss_vandalize_node_down( var_1, var_2 );

    if ( var_6 == "" )
        return;

    using_self_revive( var_0, var_6, var_2, var_4, var_5 );
}

_id_12356( var_0, var_1, var_2 )
{
    var_3 = -1;

    if ( isdefined( var_2 ) )
        var_3 = var_2 getentitynumber();

    _id_12354( var_0, var_1, var_3 );
}

_id_12355( var_0, var_1, var_2 )
{
    var_3 = 0;

    if ( isdefined( var_2 ) )
        var_3 = var_2.health;

    _id_12354( var_0, var_1, var_3 );
}

_id_13068( var_0 )
{
    var_0.tutdmzonplayerkilled["ui_br_gulag_players_1"] = 0;

    for ( var_1 = 0; var_1 < level.gulag.maxplayers; var_1++ )
    {
        var_2 = var_0.arenaplayers[var_1];
        _id_12356( var_0, "playerArena" + var_1, var_2 );
    }

    var_3 = var_0.matches[0];

    if ( !isdefined( var_3 ) )
        var_3 = [];

    _id_12356( var_0, "playerJail0", var_3[0] );
    _id_12356( var_0, "playerJail1", var_3[1] );
    var_4 = scripts\engine\utility::array_combine( var_0.jailedplayers, var_0.arenaplayers );

    foreach ( var_2 in var_4 )
    {
        var_2 setclientomnvar( "ui_br_gulag_players_1", var_0.tutdmzonplayerkilled["ui_br_gulag_players_1"] );

        foreach ( var_11, var_7 in var_0.matches )
        {
            if ( isdefined( var_7[0] ) && var_2 == var_7[0] || isdefined( var_7[1] ) && var_2 == var_7[1] )
            {
                var_8 = !runheliextraction( var_0, var_2 );
                var_9 = var_11 + 1;
                var_10 = var_8 + ( var_9 << 1 );
                var_2 setclientomnvar( "ui_br_gulag_queue_position", var_10 );
                break;
            }
        }
    }
}

_id_119AA( var_0 )
{
    self setclientomnvar( "ui_br_gulag_data", var_0.tutdmzonplayerkilled["ui_br_gulag_data"] );
}

_id_13067( var_0 )
{
    _id_11F22( var_0 );

    for ( var_1 = 0; var_1 < level.gulag.maxplayers; var_1++ )
    {
        var_2 = var_0.arenaplayers[var_1];
        _id_12355( var_0, "playerHealth" + var_1, var_2 );
    }

    foreach ( var_2 in var_0.jailedplayers )
        var_2 _id_119AA( var_0 );

    foreach ( var_2 in var_0.arenaplayers )
        var_2 _id_1199D( var_0 );
}

_id_11F22( var_0 )
{
    var_0.tutdmzonplayerkilled["ui_br_gulag_data"] = 0;
}

_id_1199D( var_0 )
{
    if ( !isdefined( self.pickupchecks ) )
        self setclientomnvar( "ui_br_gulag_data", var_0.tutdmzonplayerkilled["ui_br_gulag_data"] );
    else
        _id_119B7( var_0, "loadoutRow", self.pickupchecks );
}

_id_119B7( var_0, var_1, var_2 )
{
    [var_4, var_5, var_6, var_2] = move_closest_chopper_boss_vandalize_node_down( var_1, var_2 );

    if ( var_6 == "" )
        return;

    zone_get_node_nearest_2d_bounds( var_0, var_6, var_2, var_4, var_5 );
}

zone_get_node_nearest_2d_bounds( var_0, var_1, var_2, var_3, var_4 )
{
    var_5 = int( pow( 2, var_4 ) ) - 1;
    var_6 = ( var_2 & var_5 ) << var_3;
    var_7 = ~( var_5 << var_3 );
    var_8 = var_0.tutdmzonplayerkilled[var_1];
    var_9 = var_8 & var_7;
    var_10 = var_9 + var_6;
    self setclientomnvar( var_1, var_10 );
}

_id_130A7( var_0 )
{
    _id_13068( var_0 );
    _id_13067( var_0 );
}

weapon_xp_iw8_ar_asierra12( var_0 )
{
    var_1 = getarraykeys( var_0.tutdmzonplayerkilled );

    foreach ( var_3 in var_1 )
        self setclientomnvar( var_3, 0 );

    self setclientomnvar( "ui_overtime_timer", 0 );
    self setclientomnvar( "ui_overtime_timer_show", 0 );
}

_id_123B3( var_0, var_1 )
{
    foreach ( var_3 in var_0.arenaplayers )
        var_3 setclientomnvar( "ui_overtime_timer", var_1 );

    foreach ( var_3 in var_0.jailedplayers )
        var_3 setclientomnvar( "ui_overtime_timer", var_1 );
}

_id_123B2( var_0, var_1 )
{
    foreach ( var_3 in var_0.arenaplayers )
        var_3 setclientomnvar( "ui_overtime_timer_show", var_1 );

    foreach ( var_3 in var_0.jailedplayers )
        var_3 setclientomnvar( "ui_overtime_timer_show", var_1 );
}

x1playerspawnoverride( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "gulag_end" );
    var_1 = "playerHealth0";

    if ( var_0.arenaplayers[0] != self )
        var_1 = "playerHealth1";

    for (;;)
    {
        _id_13067( var_0 );

        if ( self.health <= 0 )
            return;

        scripts\engine\utility::_id_133F4( "damage", "force_regeneration", "removeAdrenaline", "healed", "healhRegenThink", "vampirism", "spawned_player" );
    }
}

_id_11975()
{
    if ( level.gulag.remove_on_death && !isbot( self ) )
    {
        var_0 = mp_hideout_patch();
        self preloadcinematicforplayer( var_0 );
    }
}

_id_11950()
{
    if ( level.gulag.remove_on_death && !isbot( self ) )
    {
        self setclientomnvar( "ui_br_bink_overlay_state", 1 );
        self setplayermusicstate( "br_gulag_intro" );

        if ( scripts\mp\gametypes\br_public.gsc::revive_or_disconnect_monitor() )
            self setsoundsubmix( "iw8_br_gulag_tutorial", 0.5 );
        else
            self setsoundsubmix( "fade_to_black_all_except_music_and_scripted5", 0.5 );

        var_0 = mp_hideout_patch();
        self playcinematicforplayer( var_0 );
        self._id_11A65 = 1;
    }
    else
        gulagloadingtext();
}

_id_119C3()
{
    self setclientomnvar( "ui_br_bink_overlay_state", 2 );
}

_id_11A10( var_0 )
{
    if ( level.gulag.remove_on_death && !isbot( self ) && !self isplayerheadless() )
    {
        self freezecontrols( 1 );
        addspecialistbonuspickup( var_0 );
        self freezecontrols( 0 );
        self setclientomnvar( "ui_br_bink_overlay_state", 5 );
        self stopcinematicforplayer();
        self._id_11A65 = undefined;
    }
}

addspecialistbonuspickup( var_0 )
{
    self endon( "bink_complete" );
    var_1 = mp_hardhat_patch();

    while ( gettime() - var_0 < var_1 && !self crouchbuttonpressed() && !self usebuttonpressed() && !self jumpbuttonpressed() )
        waitframe();
}

weapon_class( var_0, var_1 )
{
    if ( var_0 == "bink_complete" )
        self notify( "bink_complete" );
}

zlimit()
{
    if ( scripts\mp\utility\game::getgametype() != "br" )
        return 0;

    var_0 = self getclientomnvar( "ui_br_bink_overlay_state" );

    if ( var_0 != 0 && var_0 != 6 )
        return 1;

    return 0;
}

zdrop()
{
    var_0 = self getclientomnvar( "ui_br_bink_overlay_state" );
    return var_0 == 7;
}

weapon_pick_up_monitor()
{
    self setclientomnvar( "ui_br_bink_overlay_state", 7 );
}

weapon_should_not_get_ammo( var_0 )
{
    self endon( "disconnect" );

    if ( zlimit() )
    {
        if ( isdefined( var_0 ) )
            wait( var_0 );

        self setclientomnvar( "ui_br_bink_overlay_state", 6 );
        wait 1;
        self setclientomnvar( "ui_br_bink_overlay_state", 0 );
    }
}

mp_hideout_patch()
{
    if ( scripts\cp_mp\utility\game_utility::sat_piece() )
    {
        if ( level.spotlight_speed == "pm" )
            return "rebirth_pm_gulag_intro";
        else
            return "rebirth_gulag_intro";
    }
    else if ( istrue( level.gulag.trial_start_time ) )
        return "mp_donetsk_gulag_intro2";
    else
        return "mp_donetsk_gulag_intro";
}

mp_hardhat_patch()
{
    if ( istrue( level.gulag.trial_start_time ) )
        return 35000;
    else
        return 17000;
}

_id_12438( var_0, var_1 )
{
    if ( !level.gulag._id_130FD )
        return;

    if ( !isdefined( var_1.target ) )
        return;

    var_2 = getentarray( var_1.target, "targetname" );

    if ( var_2.size > 1 )
        level.gulag._id_130FD = 0;
    else
    {
        var_1.door = getent( var_1.target, "targetname" );

        if ( isdefined( var_1.door ) )
        {
            var_1.door.closed = 1;
            var_3 = getent( var_1.door.target, "targetname" );
            var_3 delete();
            var_4 = anglestoforward( var_1.door.angles );
            var_1.door.flagpickupchecks = var_1.door.origin;
            var_1.door.updatecallback = var_1.door.origin + var_4 * 60;
        }
    }
}

_id_130FD( var_0 )
{
    return level.gulag._id_130FD && var_0.dropoff.size > 0;
}

_id_11F30()
{
    var_0 = self;
    var_0.fastcrouchspeedmod = 0;
    var_0 scripts\mp\weapons::updatemovespeedscale();
}

#using_animtree("script_model");

waypoints_creation( var_0, var_1 )
{
    if ( !level.gulag.droporigin )
        return;

    self endon( "playerChairBreakoutCleanup" );
    var_2 = var_1.chair;
    self playerhide();
    self showtoplayer( self );
    var_3 = spawn( "script_arms", var_2.origin, 0, 0, self );
    var_3.angles = var_2.angles;
    var_3 useanimtree( #animtree );
    var_3 hide();
    var_3 showtoplayer( self );
    self._id_11985 = var_3;
    var_4 = spawn( "script_model", var_2.origin );
    var_4.angles = var_2.angles;
    var_4 setmodel( "misc_vm_gulag_cuffs" );
    var_4 useanimtree( #animtree );
    var_4 hide();
    var_4 showtoplayer( self );
    self.straps = var_4;
    self setorigin( var_2.origin );
    self playerlinktoabsolute( var_3, "tag_player" );
    waypoints_linear_flow( 1 );
    thread waypoints_reached( var_3, var_4 );
    self playanimscriptsceneevent( "scripted_scene", "gulag_chair_breakout_start" );
    var_3 animscripted( "chair", var_2.origin, var_2.angles, %sdr_mp_gulag_breakout_wz_2_start_plr );
    var_3 scriptmodelplayanim( "sdr_mp_gulag_breakout_wz_2_start_plr" );
    var_4 animscripted( "chair", var_2.origin, var_2.angles, %sdr_mp_gulag_breakout_wz_2_start_straps );
    var_4 scriptmodelplayanim( "sdr_mp_gulag_breakout_wz_2_start_straps" );
    var_3 waittillmatch( "chair", "end" );
    thread waypoints_structs();
    self playerlinkto( var_3, "tag_player", 0, 30, 30, 45, 60, 0 );
    var_3 hide();
    var_3 showtoplayer( self );
    zombiepowerscooldown( var_3, var_4, var_2 );
    self playanimscriptsceneevent( "scripted_scene", "gulag_chair_breakout_exit" );
    var_3 animscripted( "chair", var_2.origin, var_2.angles, %sdr_mp_gulag_breakout_wz_2_exit_plr );
    var_3 scriptmodelplayanim( "sdr_mp_gulag_breakout_wz_2_exit_plr" );
    var_4 animscripted( "chair", var_2.origin, var_2.angles, %sdr_mp_gulag_breakout_wz_2_exit_straps );
    var_4 scriptmodelplayanim( "sdr_mp_gulag_breakout_wz_2_exit_straps" );
    var_3 waittillmatch( "chair", "end" );
    thread waypoints_free_flow( var_3, var_4 );
}

zombiepowerscooldown( var_0, var_1, var_2 )
{
    self endon( "playerChairBreakoutCleanup" );
    self endon( "chairBreakout" );

    for (;;)
    {
        self playanimscriptsceneevent( "scripted_scene", "gulag_chair_breakout_loop" );
        var_0 animscripted( "chair", var_2.origin, var_2.angles, %sdr_mp_gulag_breakout_wz_2_loop_plr );
        var_0 scriptmodelplayanim( "sdr_mp_gulag_breakout_wz_2_loop_plr" );
        var_1 animscripted( "chair", var_2.origin, var_2.angles, %sdr_mp_gulag_breakout_wz_2_loop_straps );
        var_1 scriptmodelplayanim( "sdr_mp_gulag_breakout_wz_2_loop_straps" );
        var_0 waittillmatch( "chair", "end" );
    }
}

waypoints_structs()
{
    self endon( "playerChairBreakoutCleanup" );
    self endon( "disconnect" );
    wait 1;

    for (;;)
    {
        if ( isdefined( self ) )
        {
            var_0 = self getnormalizedmovement();

            if ( self usebuttonpressed() || self jumpbuttonpressed() || var_0[0] > 0.5 || var_0[1] > 0.5 )
                break;
        }

        waitframe();
    }

    self playerlinktoabsolute( self._id_11985, "tag_player" );
    self._id_11985 hide();
    self._id_11985 showtoplayer( self );
    self.straps hide();
    self.straps showtoplayer( self );
    self notify( "chairBreakout" );
}

weapon_box_cache_use()
{
    waypoints_free_flow( self._id_11985, self.straps );
}

waypoints_free_flow( var_0, var_1 )
{
    if ( !level.gulag.droporigin )
        return;

    if ( !isdefined( self._id_11985 ) )
        return;

    if ( isdefined( self ) )
    {
        self unlink();
        self stopanimscriptsceneevent();
        self playershow( 1 );
        waypoints_linear_flow( 0 );
        self._id_11985 = undefined;
        self.straps = undefined;
        self notify( "playerChairBreakoutCleanup" );
    }

    var_0 delete();
    var_1 delete();
}

waypoints_reached( var_0, var_1 )
{
    self endon( "playerChairBreakoutCleanup" );
    self waittill( "death_or_disconnect" );
    thread waypoints_free_flow( var_0, var_1 );
}

waypoints_linear_flow( var_0 )
{
    if ( var_0 )
        self disableweapons();
    else
        self enableweapons();

    var_1 = !var_0;
    self allowmelee( var_1 );
    self allowfire( var_1 );
}

num_nodes_search_player( var_0 )
{
    if ( isdefined( var_0.dropped_weapon ) )
    {
        var_0.dropped_weapon++;
        var_0.dropped_weapon = var_0.dropped_weapon % var_0.dropped_weapon_cleanup.size;
    }
    else
        var_0.dropped_weapon = 0;

    var_1 = var_0.dropped_weapon_cleanup[var_0.dropped_weapon];
    return var_1;
}

_id_12481()
{
    if ( !istrue( level.gulag._id_1334C ) )
        return;

    level.gulag.fx_model = [];
    var_0 = 0;
    level.gulag.fx_model[var_0] = spawnstruct();
    level.gulag.fx_model[var_0].binoculars_ontake = "dx_brm_rm1_gulag_muffled_chatter_";
    level.gulag.fx_model[var_0].aliases = [ 10, 20, 30, 40 ];
    level.gulag.fx_model[var_0].ground_trigger_pipes_room = [ 1, 1, 1, 0 ];
    var_0++;
    level.gulag.fx_model[var_0] = spawnstruct();
    level.gulag.fx_model[var_0].binoculars_ontake = "dx_brm_rm1_gulag_muffled_chatter_";
    level.gulag.fx_model[var_0].aliases = [ 90, 100, 110 ];
    level.gulag.fx_model[var_0].ground_trigger_pipes_room = [ 1, 1, 0 ];
    var_0++;
    level.gulag.fx_model[var_0] = spawnstruct();
    level.gulag.fx_model[var_0].binoculars_ontake = "dx_brm_rm2_gulag_announcement_";
    level.gulag.fx_model[var_0].aliases = [ 10 ];
    level.gulag.fx_model[var_0].ground_trigger_pipes_room = [ 0 ];
    var_0++;
    level.gulag.fx_model[var_0] = spawnstruct();
    level.gulag.fx_model[var_0].binoculars_ontake = "dx_brm_rm2_gulag_announcement_";
    level.gulag.fx_model[var_0].aliases = [ 20 ];
    level.gulag.fx_model[var_0].ground_trigger_pipes_room = [ 0 ];
    var_0++;
    level.gulag.fx_model[var_0] = spawnstruct();
    level.gulag.fx_model[var_0].binoculars_ontake = "dx_brm_rm2_gulag_announcement_";
    level.gulag.fx_model[var_0].aliases = [ 30 ];
    level.gulag.fx_model[var_0].ground_trigger_pipes_room = [ 0 ];
    var_0++;
    level.gulag.fx_model[var_0] = spawnstruct();
    level.gulag.fx_model[var_0].binoculars_ontake = "dx_brm_rm2_gulag_announcement_";
    level.gulag.fx_model[var_0].aliases = [ 40 ];
    level.gulag.fx_model[var_0].ground_trigger_pipes_room = [ 0 ];
    var_0++;
    level.gulag.fx_model[var_0] = spawnstruct();
    level.gulag.fx_model[var_0].binoculars_ontake = "dx_brm_rm2_gulag_recording_";
    level.gulag.fx_model[var_0].aliases = [ 10 ];
    level.gulag.fx_model[var_0].ground_trigger_pipes_room = [ 0 ];
    var_0++;
    level.gulag.fx_model[var_0] = spawnstruct();
    level.gulag.fx_model[var_0].binoculars_ontake = "dx_brm_rm2_gulag_recording_";
    level.gulag.fx_model[var_0].aliases = [ 20, 30, 40, 50, 60, 20, 70, 80, 90, 80, 20, 30, 100, 110 ];
    level.gulag.fx_model[var_0].ground_trigger_pipes_room = [ 0.5, 1.0, 1.5, 0.7, 0.3, 1.0, 0.4, 0.8, 1.0, 0.5, 1.0, 1.5, 2.0, 0 ];
    var_0++;
    level.gulag.fx_model = scripts\engine\utility::array_randomize( level.gulag.fx_model );
}

_id_129EA( var_0 )
{
    if ( !istrue( level.gulag._id_1334C ) || var_0._id_12033.size == 0 )
        return;

    var_0._id_1334B = spawn( "script_model", var_0.origin );
    var_0._id_1334B setmodel( "tag_origin" );
    var_1 = randomint( level.gulag.fx_model.size );
    var_2 = randomint( var_0._id_12033.size );

    for (;;)
    {
        _id_1344E();

        while ( var_0.jailedplayers.size == 0 )
            waitframe();

        var_5 = var_0._id_12033[var_2];
        var_6 = level.gulag.fx_model[var_1];
        var_0._id_1334B.origin = var_5.origin;
        var_0._id_1334B dontinterpolate();
        waitframe();

        for ( var_7 = 0; var_7 < var_6.aliases.size; var_7++ )
        {
            var_8 = var_6.binoculars_ontake + var_6.aliases[var_7];
            var_0._id_1334B playsoundonmovingent( var_8 );
            var_9 = lookupsoundlength( var_8, 1 ) / 1000.0;
            var_10 = var_6.ground_trigger_pipes_room[var_7] + var_9;
            wait( var_10 );
        }

        var_2 = randomint( var_0._id_12033.size );
        var_1++;

        if ( var_1 >= level.gulag.fx_model.size )
            var_1 = 0;
    }
}

_id_1344E()
{
    var_0 = getdvarint( "scr_br_gulag_voice_min", 90 );
    var_1 = getdvarint( "scr_br_gulag_voice_max", 180 );
    var_2 = randomfloatrange( var_0, var_1 );
    wait( var_2 );
}
