// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    level thread play_train_speaker_vo();

    if ( getdvarint( "scr_br_zombie_encounters", 0 ) < 1 )
        return;

    level._id_13693 = spawnstruct();
    level._id_13693._id_136E6 = getdvarint( "scr_br_zombie_plunder_on_death_amount_base", 1 );
    level._id_13693._id_136E7 = getdvarint( "scr_br_zombie_plunder_on_death_amount_emp", 2 );
    level._id_13693._id_136E8 = getdvarint( "scr_br_zombie_plunder_on_death_amount_explosion", 2 );
    level._id_13693._id_136E9 = getdvarint( "scr_br_zombie_plunder_on_death_amount_gas", 2 );
    level._id_13693._id_136EA = getdvarint( "scr_br_zombie_plunder_on_death_amount_weakpoint", 3 );
    level._id_13693._id_136E4 = getdvarint( "scr_br_zombie_plunder_multiplier", 50 );
    level._id_13693._id_135BA = getdvarint( "scr_br_zombie_ai_week_number", 1 );
    level._id_13693.votesys_new = getdvarfloat( "scr_br_zombie_ping_time", 0.5 );
    level._id_13693.votesys_think = getdvarfloat( "scr_br_zombie_ping_wait_time", 2.5 );
    level._id_13693.itemproxtriggerthink = getdvarfloat( "scr_br_zombie_explosion_damage", 35 );
    level._id_13693.itemsinworld = getdvarfloat( "scr_br_zombie_explosion_damage_vehicle_percent", 0.95 );
    level._id_13693.initial_timer = getdvarfloat( "scr_br_zombie_emp_radius", 275 );
    level._id_13693.justbecamehvt = 1;
    level._id_13693._id_136C3 = getdvarint( "scr_br_zombie_enable_variable_speed", 1 );
    level._id_13693._id_136C2 = getdvarint( "scr_br_zombie_enable_variable_health", 1 );
    level._id_13693._id_136C1 = getdvarint( "scr_br_zombie_enable_variable_damage", 1 );
    level._id_13693.spawn_techo_turret_2 = getdvarint( "scr_br_zombie_ai_damage_low", 15 );
    level._id_13693.stealth_alert_music = getdvarint( "scr_br_zombie_ai_damage_mid", 20 );
    level._id_13693.playerwaitforprestreaming = getdvarint( "scr_br_zombie_ai_damage_high", 35 );
    level._id_13693._id_136B1 = getdvarfloat( "scr_br_zombie_ammo_on_death_chance", 0.4 );
    level._id_13693._id_136B3 = getdvarfloat( "scr_br_zombie_armor_on_death_chance", 0.25 );
    level._id_13693._id_136B2 = getdvarint( "scr_br_zombie_ai_armor_drop_amount", 1 );
    level._id_13693.jailloadout = getdvarfloat( "scr_br_zombie_ai_explosive_mod_damage_modifier", 5.0 );
    level._id_13693._id_136D3 = 0;
    level._id_13693.spotlight_reach_goal_node_dist_sq = undefined;
    level._id_13693.spotlight_origin_offset = undefined;

    switch ( level._id_13693._id_135BA )
    {
        case 2:
        case 1:
            level._id_13693.spotlight_reach_goal_node_dist_sq = "shipwreck";
            level._id_13693.spotlight_origin_offset = "ship_tac";
            break;
        case 3:
            level._id_13693.spotlight_reach_goal_node_dist_sq = "prison";
            level._id_13693.spotlight_origin_offset = "gulag_tac";
            break;
        case 4:
            level._id_13693.spotlight_reach_goal_node_dist_sq = "hospital";
            level._id_13693.spotlight_origin_offset = "hospital_tac";
            break;
        case 5:
            level._id_13693.spotlight_reach_goal_node_dist_sq = "downtown";
            level._id_13693.spotlight_origin_offset = "downtown_tac";
            break;
        case 6:
            level._id_13693.spotlight_reach_goal_node_dist_sq = "tvstation";
            level._id_13693.spotlight_origin_offset = "tvstation_tac";
            break;
        case 7:
            level._id_13693.spotlight_reach_goal_node_dist_sq = "superstore";
            level._id_13693.spotlight_origin_offset = "super_tac";
            break;
        case 8:
            level._id_13693.spotlight_reach_goal_node_dist_sq = "dam";
            level._id_13693.spotlight_origin_offset = "dam_tac";
            break;
    }

    level._id_136AC = "gas_on_death";
    level._id_136AB = "explosion_on_death";
    level._id_136AA = "emp";
    level._id_136AE = "weakpoint";
    level._id_136A9 = "base";
    level._effect["zmb_ai_crawling_out_of_ground"] = loadfx( "vfx/iw8_br/gameplay/zombie_ai/vfx_zai_spawn_ground.vfx" );
    level._effect["zmb_ai_crawling_out_of_vent"] = loadfx( "vfx/iw8_br/gameplay/zombie_ai/vfx_zai_spawn_vent.vfx" );
    level._effect["zmb_ai_base_death"] = loadfx( "vfx/iw8/weap/_impact/flesh/vfx_imp_flesh_fatal_med.vfx" );
    level._effect["zmb_ai_gas_death"] = loadfx( "vfx/iw8_br/gameplay/zombie_ai/vfx_zai_gas_death.vfx" );
    level._effect["zmb_ai_explosion_death"] = loadfx( "vfx/iw8_br/gameplay/zombie_ai/vfx_zai_explode_death.vfx" );
    level._effect["zmb_ai_emp_charge"] = loadfx( "vfx/iw8_br/gameplay/zombie_ai/vfx_zai_emp_amb_pulse_chargeup.vfx" );
    level._effect["zmb_ai_emp_pulse"] = loadfx( "vfx/iw8_br/gameplay/zombie_ai/vfx_zai_emp_amb_pulse.vfx" );
    level._effect["zmb_ai_emp_death"] = loadfx( "vfx/iw8_br/gameplay/zombie_ai/vfx_zai_emp_death.vfx" );
    level._effect["zmb_ai_weakpoint_death"] = loadfx( "vfx/iw8/weap/_impact/flesh/vfx_imp_flesh_fatal_med.vfx" );
    level.activeuavs["team_two_hundred"] = 0;
    level.activeadvanceduavs["team_two_hundred"] = 0;
    level.activecounteruavs["team_two_hundred"] = 0;
    thread tv_station_fastrope_two_infil_start_targetname_array();
    thread fulton_cancreate();
    thread _id_12E72();
    thread _id_136B6();
    thread _id_13698();
    thread clearsoundsubmixfadetoblackamb();
    thread _id_1369A();
}

_id_1369A()
{
    level endon( "game_ended" );
    scripts\mp\flags::gameflagwait( "prematch_done" );

    if ( tableexists( "mp/map_callouts/mp_don3_callouts.csv" ) )
        var_0 = int( tablelookup( "mp/map_callouts/mp_don3_callouts.csv", 1, level._id_13693.spotlight_origin_offset, 0 ) );
    else
        var_0 = -1;

    setomnvar( "ui_br_zm_marked_area", var_0 );
}

play_train_speaker_vo()
{
    wait 0.1;

    if ( getdvarint( "scr_br_zombie_encounters", 0 ) < 1 )
        last_akimbo_ammo_taken();
    else
        last_akimbo_ammo_taken( level._id_136C4 );
}

last_akimbo_ammo_taken( var_0 )
{
    if ( !isdefined( var_0 ) )
    {
        level thread _id_13694();
        return;
    }

    switch ( var_0 )
    {
        case "br_zombies_zone1":
            break;
        case "br_zombies_zone7":
        case "br_zombies_zone6":
        case "br_zombies_zone_tvstation":
        case "br_zombies_zone5":
        case "br_zombies_zone4":
        case "br_zombies_zone3":
        default:
            level thread _id_13694();
            break;
    }
}

tv_station_fastrope_two_infil_start_targetname_array()
{
    for (;;)
        level waittill( "add_to_team", var_0 );
}

_id_136F7( var_0 )
{
    level notify( "zai_round_over" );
    level._id_136B9 _id_12E70();
    level._id_136B9 = undefined;
    _id_13713();
    thread _id_136F9( var_0 );
}

_id_136FA()
{
    _id_136F7();

    foreach ( var_1 in level._id_136FB )
    {
        if ( isalive( var_1 ) )
        {
            var_1.shutdown = 1;
            var_1 suicide();
        }
    }
}

_id_136F8( var_0 )
{
    if ( getdvarint( "scr_br_zombie_ai_enable_drop_loot", 1 ) )
    {
        var_1 = scripts\mp\gametypes\br_pickups.gsc::register_respawn_functions();
        var_2 = scripts\mp\gametypes\br_pickups.gsc::getitemdroporiginandangles( var_1, var_0.origin, var_0.angles, var_0 );
        scripts\mp\gametypes\br_pickups.gsc::spawnpickup( "brloot_access_card_green", var_2 );
    }

    var_3 = scripts\mp\utility\player::getplayersinradius( var_0.origin, 6000 );

    if ( level._id_13693.justbecamehvt == 1 )
    {
        foreach ( var_5 in var_3 )
            var_5 scripts\mp\hud_message::showsplash( "br_zai_round_over" );
    }
    else if ( level._id_13693.justbecamehvt == 2 )
    {
        foreach ( var_5 in var_3 )
            var_5 scripts\mp\hud_message::showsplash( "br_zai_round_over_multiple" );
    }

    level._id_13693.justbecamehvt = 0;
    _id_136F7( 6 );

    switch ( level._id_136C4 )
    {
        case "br_zombies_zone1":
            thread _id_13695();

            if ( getdvarint( "scr_br_zombie_open_all_doors", 1 ) )
                thread _id_13695();

            break;
        case "br_zombies_zone7":
        case "br_zombies_zone6":
        case "br_zombies_zone_tvstation":
        case "br_zombies_zone5":
        case "br_zombies_zone4":
        case "br_zombies_zone3":
        default:
            break;
    }
}

_id_136F9( var_0 )
{
    if ( isdefined( var_0 ) )
    {
        level endon( "game_ended" );
        level endon( "zai_computer_used" );
        wait( var_0 );
    }

    foreach ( var_2 in level.players )
    {
        var_2.roundkillexecute = 0;
        var_2 _id_11A05( level._id_13693._id_136D3 );
    }
}

_id_136C6()
{
    level endon( "game_ended" );
    level endon( "zai_computer_used" );

    for (;;)
    {
        if ( getdvarint( "scr_br_zai_force_round_over", 0 ) )
        {
            var_0 = level.player;

            foreach ( var_2 in level._id_136FB )
            {
                if ( isalive( var_2 ) )
                {
                    var_0 = var_2;
                    break;
                }
            }

            setdvar( "scr_br_zai_force_round_over", 0 );
            _id_136F8( var_0 );
        }

        wait 2;
    }
}

_id_13711( var_0 )
{
    var_1 = self;

    if ( !isdefined( var_1._id_1370F ) )
        var_1._id_1370F = "base";

    var_2 = level._id_13693._id_136E6;

    switch ( var_1._id_1370F )
    {
        case "gas_on_death":
            thread scripts\mp\equipment\gas_grenade::gas_createtrigger( self.origin, undefined, 5.5, 0.5 );
            playfx( level._effect["zmb_ai_gas_death"], var_1 gettagorigin( "j_spineupper" ) );
            var_2 = level._id_13693._id_136E9;
            break;
        case "explosion_on_death":
            playfx( level._effect["zmb_ai_explosion_death"], var_1 gettagorigin( "j_spineupper" ) );
            var_3 = scripts\mp\utility\player::getplayersinradius( var_1.origin, 200 );

            foreach ( var_5 in var_3 )
            {
                if ( var_5 scripts\cp_mp\utility\player_utility::isinvehicle() )
                {
                    if ( var_5.vehicle.health > var_5.vehicle.maxhealth * 0.05 )
                    {
                        var_6 = var_5.vehicle.maxhealth * level._id_13693.itemsinworld;
                        var_5.vehicle dodamage( var_6, var_5.vehicle.origin, undefined, undefined, "MOD_TRIGGER_HURT", "danger_circle_br" );
                    }
                }

                if ( var_5 scripts\mp\utility\perk::_hasperk( "specialty_br_eod" ) )
                    var_5 dodamage( int( level._id_13693.itemproxtriggerthink * 0.85 ), var_1.origin, var_1, var_5, "MOD_EXPLOSIVE" );
                else
                    var_5 dodamage( level._id_13693.itemproxtriggerthink, var_1.origin, var_1, var_5, "MOD_EXPLOSIVE" );

                var_5 earthquakeforplayer( 0.35, 0.9, self.origin, 200 );
            }

            var_2 = level._id_13693._id_136E8;
            break;
        case "emp":
            playfx( level._effect["zmb_ai_emp_death"], var_1 gettagorigin( "j_spine4" ) );
            var_2 = level._id_13693._id_136E7;
            break;
        case "weakpoint":
            playfx( level._effect["zmb_ai_weakpoint_death"], var_1 gettagorigin( "j_spineupper" ) );
            var_2 = level._id_13693._id_136EA;
            break;
        default:
            playfx( level._effect["zmb_ai_base_death"], var_1 gettagorigin( "j_spineupper" ) );
            var_2 = level._id_13693._id_136E6;
            break;
    }

    var_8 = scripts\mp\gametypes\br_pickups.gsc::register_respawn_functions();

    if ( var_2 > 0 )
    {
        if ( scripts\mp\utility\game::onfieldupgradeendbuffer() == "dmz" )
            var_2 = var_2 * level._id_13693._id_136E4;

        scripts\mp\gametypes\br_plunder.gsc::init_reach_pipe_room( var_2, var_8 );
    }

    if ( isalive( var_0 ) && isplayer( var_0 ) && randomfloat( 1.0 ) < level._id_13693._id_136B1 )
    {
        var_9 = var_0 getcurrentprimaryweapon();
        var_10 = scripts\mp\gametypes\br_weapons.gsc::br_ammo_type_for_weapon( var_9 );

        if ( !isdefined( var_10 ) )
            return;

        foreach ( var_12 in level.br_ammo_types )
            var_1.br_ammo[var_12] = 0;

        var_1.br_ammo[var_10] = level.br_ammo_clipsize[var_10];
        var_1 scripts\mp\gametypes\br_pickups.gsc::init_patches( var_8 );
    }

    if ( isalive( var_0 ) && isplayer( var_0 ) && randomfloat( 1.0 ) < level._id_13693._id_136B3 )
    {
        var_14 = scripts\mp\gametypes\br_pickups.gsc::getitemdroporiginandangles( var_8, var_1.origin, var_1.angles, var_1 );
        scripts\mp\gametypes\br_pickups.gsc::spawnpickup( "brloot_armor_plate", var_14, level._id_13693._id_136B2, 1 );
    }
}

_id_13713()
{
    level._id_136FC = 0;

    if ( isdefined( level._id_13693 ) )
        level._id_13693._id_136D3 = 0;

    level.clearsoundsubmixmpbrinfilanim = getdvarint( "scr_br_zombie_num", -1 );
    level.client_activate = getdvarint( "scr_br_zombie_total_num_type_gas", -1 );
    level.clearsplashqueue = getdvarint( "scr_br_zombie_total_num_type_explosion", -1 );
    level.clearspaceforscriptableinstance = getdvarint( "scr_br_zombie_total_num_type_emp", -1 );
    level.clientmatchdata_logplayerdeath = getdvarint( "scr_br_zombie_total_num_type_weakpoint", -1 );
}

_id_136E0()
{
    var_0 = self;
    level endon( "game_ended" );
    var_0 endon( "terminate_ai_threads" );
    var_0 endon( "death" );

    for (;;)
    {
        var_0 setperk( "specialty_radarblip", 1 );
        wait( level._id_13693.votesys_new );
        var_0 unsetperk( "specialty_radarblip", 1 );
        wait( level._id_13693.votesys_think );
    }
}

_id_13701( var_0 )
{
    var_1 = self;

    if ( !level._id_13693._id_136C3 )
        return;

    if ( !isdefined( var_1._id_1239A ) || !isdefined( var_1._id_123D4 ) )
        return;

    var_2 = randomfloat( 2.0 );

    if ( var_0 == level._id_136AC || var_0 == level._id_136AB )
    {
        var_1 [[ var_1._id_1239A ]]( "sprint" );
        var_2 = randomfloat( 1.0 );
    }
    else if ( var_0 == level._id_136AA || var_0 == level._id_136A9 )
        var_1 [[ var_1._id_1239A ]]( "run" );
    else if ( var_0 == level._id_136AE )
        var_1 [[ var_1._id_1239A ]]( "walk" );

    var_1 [[ var_1._id_123D4 ]]( var_2 );
}

_id_136FF( var_0 )
{
    var_1 = self;

    if ( !level._id_13693._id_136C2 )
        return;

    if ( var_0 == level._id_136AC || var_0 == level._id_136AB )
        var_1.health = 120;
}

_id_13700( var_0 )
{
    var_1 = self;

    if ( !level._id_13693._id_136C1 )
        return;

    if ( var_0 == level._id_136AE )
        var_1.startingcodephone = level._id_13693.playerwaitforprestreaming;
    else if ( var_0 == level._id_136A9 )
        var_1.startingcodephone = level._id_13693.stealth_alert_music;
    else if ( var_0 == level._id_136AA || var_0 == level._id_136AC || var_0 == level._id_136AB )
        var_1.startingcodephone = level._id_13693.spawn_techo_turret_2;
}

_id_136BB( var_0, var_1, var_2, var_3 )
{
    var_4 = self;

    if ( isdefined( var_4._id_1370F ) && isdefined( var_0 ) && isdefined( var_1 ) )
    {
        if ( istrue( var_3 ) )
        {
            if ( isdefined( var_2 ) && var_2 == "head" )
                var_1 thread scripts\mp\damagefeedback::updatedamagefeedback( "hitzombieheadshot", var_0 >= self.health, 1, "hitzombieheadshot" );
            else
                var_1 thread scripts\mp\damagefeedback::updatedamagefeedback( "hitzombieheadshot", var_0 >= self.health, 0, "hitzombieheadshot" );
        }
        else if ( var_4._id_1370F == level._id_136AE )
        {
            if ( isdefined( var_2 ) && var_2 == "head" )
                var_1 thread scripts\mp\damagefeedback::updatedamagefeedback( "hitarmorheavy", var_0 >= self.health, 1 );
            else
                var_1 thread scripts\mp\damagefeedback::updatedamagefeedback( "hitarmorheavy", var_0 >= self.health );
        }
        else if ( isdefined( var_2 ) && var_2 == "head" )
            var_1 thread scripts\mp\damagefeedback::updatedamagefeedback( "standard", var_0 >= self.health, 1 );
        else
            var_1 thread scripts\mp\damagefeedback::updatedamagefeedback( "standard", var_0 >= self.health );
    }
}

_id_13698()
{
    waittillframeend;
    level._id_13693.infectedairdroppositions = _id_13697();

    foreach ( var_1 in level._id_13693.infectedairdroppositions )
    {
        if ( isdefined( var_1.targetname ) )
        {
            if ( var_1.targetname == level._id_136C4 )
                continue;
        }

        var_1 delete();
    }

    if ( level.mapname == "mp_don3" && getdvarint( "scr_br_don3_ship_path_fix", 0 ) )
    {
        var_3 = getdvarvector( "scr_br_don3_ship_path_fix_side_a", ( 39256, -42265, -506 ) );
        var_4 = getdvarvector( "scr_br_don3_ship_path_fix_side_b", ( 39348, -42251, -508 ) );
        var_5 = ( 0, vectortoyaw( var_4 - var_3 ), 0 );
        var_6 = spawncovernode( var_3, var_5, "Begin", 0, undefined, undefined, "zombie" );
        createnavlink( "zombie_hack", var_3, var_4, var_6 );
        var_5 = ( 0, vectortoyaw( var_3 - var_4 ), 0 );
        var_6 = spawncovernode( var_4, var_5, "Begin", 0, undefined, undefined, "zombie" );
        createnavlink( "zombie_hack", var_4, var_3, var_6 );
    }

    if ( level.mapname == "mp_don3" )
    {
        if ( getdvarint( "scr_br_zombie_open_all_doors_at_start", 1 ) )
            _id_13695();
        else
        {
            var_7 = getdvarfloat( "scr_br_don3_ship_door_obstacle_size", 0.0 );

            if ( var_7 > 0.0 )
            {
                if ( level._id_136C4 == "br_zombies_zone1" || level._id_136C4 == "br_zombies_zone1" )
                {
                    var_8 = _id_13697( "boat_doors_round1" );

                    foreach ( var_10 in var_8 )
                    {
                        var_11 = anglestoforward( var_10.angles ) * 26.0;
                        var_10.tugofwar_hvt_placed = createnavbadplacebyshape( var_10.origin + var_11, 6, var_7, 20 );
                    }
                }
            }
        }
    }
}

_id_13697( var_0 )
{
    var_1 = getentarray( level._id_136C4, "targetname" );

    if ( !isdefined( var_0 ) )
        return var_1;

    if ( !var_1.size )
        return undefined;

    var_2 = [];

    foreach ( var_4 in var_1 )
    {
        if ( isdefined( var_4.script_noteworthy ) && var_4.script_noteworthy == var_0 )
            var_2[var_2.size] = var_4;
    }

    return var_2;
}

_id_13699( var_0 )
{
    if ( isdefined( var_0.script_linkto ) )
    {
        if ( isdefined( var_0.tugofwar_hvt_placed ) )
            destroynavobstacle( var_0.tugofwar_hvt_placed );

        var_0 setscriptablepartstate( "br_zai_door", "open" );
        var_0 moveto( scripts\engine\utility::getstruct( var_0.script_linkto, "script_linkname" ).origin, 2.5, 0.5, 0.5 );
    }
}

_id_11A05( var_0 )
{
    var_1 = self;

    if ( !isdefined( var_1.roundkillexecute ) )
        var_1.roundkillexecute = 0;

    var_2 = _id_13696( var_1.roundkillexecute, level._id_13693.justbecamehvt, var_0 );
    var_1 setclientomnvar( "ui_br_zai_counter", var_2 );
}

_id_13696( var_0, var_1, var_2 )
{
    var_3 = int( var_0 ) & 1;
    var_3 = var_3 + ( ( int( var_1 ) & 3 ) << 1 );
    var_3 = var_3 + ( ( int( var_2 ) & 63 ) << 3 );
    return var_3;
}

_id_11999( var_0 )
{
    level endon( "game_ended" );
    level endon( "zai_round_over" );

    for (;;)
    {
        var_1 = scripts\mp\utility\player::getplayersinradius( var_0, 6000 );

        foreach ( var_3 in level.players )
        {
            if ( !isalive( var_3 ) || var_3 scripts\mp\gametypes\br_public.gsc::isplayeringulag() )
                continue;

            if ( scripts\engine\utility::array_contains( var_1, var_3 ) )
            {
                if ( !istrue( var_3.roundkillexecute ) )
                    var_3 weapon_xp_iw8_lm_mgolf36();

                var_3.roundkillexecute = 1;
            }

            var_3 _id_11A05( level._id_13693._id_136D3 );
        }

        wait 3;
    }
}

weapon_xp_iw8_lm_mgolf36()
{
    var_0 = self;

    if ( level._id_13693.justbecamehvt == 1 )
        var_0 scripts\mp\hud_message::showsplash( "br_zai_entering_active_area" );
    else if ( level._id_13693.justbecamehvt == 2 )
        var_0 scripts\mp\hud_message::showsplash( "br_zai_entering_active_area_multiple" );
}

_id_136BF()
{
    var_0 = self;
    level endon( "game_ended" );
    var_0 endon( "death" );
    var_0 endon( "terminate_ai_threads" );

    for (;;)
    {
        var_1 = randomint( 5 );
        wait( 5 + var_1 - 2 );
        playfxontag( level._effect["zmb_ai_emp_charge"], var_0, "j_spine4" );
        wait 2;
        var_0 _id_136C0();
    }
}

_id_136C0()
{
    var_0 = 60;
    var_1 = 1;
    var_2 = 64;
    var_3 = var_2 * var_2;
    var_4 = level._id_13693.initial_timer * level._id_13693.initial_timer;
    var_5 = "zxp_emp_fire_plr";
    var_6 = self;
    var_7 = anglestoforward( var_6.angles );
    playfx( level._effect["zmb_ai_emp_pulse"], var_6 gettagorigin( "j_spineupper" ), var_7 );
    var_8 = getcompleteweaponname( "emp_drone_non_player_mp" );
    var_9 = getcompleteweaponname( "emp_drone_non_player_direct_mp" );
    var_10 = scripts\cp_mp\emp_debuff::get_emp_ents();

    foreach ( var_12 in var_10 )
    {
        var_13 = var_12.owner;

        if ( isdefined( var_13 ) )
        {
            if ( var_13 != var_6 && !scripts\cp_mp\utility\player_utility::playersareenemies( var_6, var_13 ) )
                continue;
        }

        var_14 = distancesquared( var_6.origin, var_12.origin );

        if ( var_14 > var_4 )
            continue;

        var_15 = scripts\engine\utility::ter_op( var_14 > var_3, var_8, var_9 );
        var_12 dodamage( 1, var_6.origin, var_6, var_6, "MOD_EXPLOSIVE", var_15 );
        var_16 = scripts\cp_mp\utility\damage_utility::packdamagedata( var_6, var_12, 1, var_15, "MOD_EXPLOSIVE", var_6, var_6.origin );
        thread _id_11A1D( var_16 );
    }

    var_18 = getcompleteweaponname( "emp_drone_player_mp" );
    var_19 = undefined;

    if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "player", "getPlayersInRadius" ) )
        var_19 = [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "player", "getPlayersInRadius" ) ]]( var_6.origin, level._id_13693.initial_timer );

    foreach ( var_21 in var_19 )
    {
        if ( !var_21 scripts\cp_mp\emp_debuff::can_emp_player() )
            continue;

        if ( var_21 != var_6 && !scripts\cp_mp\utility\player_utility::playersareenemies( var_6, var_21 ) )
            continue;

        var_21 dodamage( 1, var_6.origin, var_6, var_6, "MOD_EXPLOSIVE", var_18 );
        var_21 earthquakeforplayer( 0.2, 0.7, self.origin, level._id_13693.initial_timer );
        var_16 = scripts\cp_mp\utility\damage_utility::packdamagedata( var_6, var_21, 1, var_18, "MOD_EXPLOSIVE", var_6, var_6.origin );
        thread _id_11A1D( var_16 );
    }
}

_id_11A1D( var_0 )
{
    var_1 = 5;
    var_2 = 2;
    scripts\cp_mp\emp_debuff::apply_emp_struct( var_0 );
    var_3 = var_1;

    if ( isplayer( var_0.victim ) )
    {
        var_0.victim.risktokenstokeep = 1;

        if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "perk", "hasPerk" ) )
        {
            if ( var_0.victim != self && var_0.victim [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "perk", "hasPerk" ) ]]( "specialty_emp_resist" ) )
            {
                var_3 = var_2;

                if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "damage", "updateDamageFeedback" ) )
                    self [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "damage", "updateDamageFeedback" ) ]]( "hittacresist" );
            }
        }
    }

    initial_forward( var_0, var_3 );

    if ( isdefined( var_0.victim ) )
    {
        var_0.victim.risktokenstokeep = undefined;
        var_0.victim scripts\cp_mp\emp_debuff::remove_emp();
    }
}

initial_forward( var_0, var_1 )
{
    var_0.victim endon( "death_or_disconnect" );
    level endon( "game_ended" );
    var_2 = scripts\engine\utility::waittill_notify_or_timeout_return( "emp_cleared", var_1 );

    if ( var_2 != "emp_cleared" )
        var_0.empremoved = 1;
}

fulton_cancreate()
{
    level._id_136A2 = spawnstruct();
    level._id_136A2._id_12185 = [ "off", "offline", "low", "medium", "high", "critical" ];
    level._id_136A2._id_130D4 = [ "disabled", "enabled" ];
    level._id_136A2._id_12188 = getdvarfloat( "scr_br_zombie_con_comp_screen_update_time", 10.0 );
    level._id_136A2._id_12522 = getdvarint( "scr_br_zombie_con_comp_show_disabled_hint", 1 );
    waittillframeend;
    level._id_136A2.friendly_hvi_vehicle_extra_riders = getentitylessscriptablearrayinradius( "scriptable_containment_computer_01_screen_scripted", "classname" );
    scripts\engine\scriptable::_id_1219E( "containment_computer_usable", ::fulton_destroy );
    var_0 = getdvarint( "scr_br_zombie_con_comp_screen_prematch", 0 );
    var_1 = getdvarint( "scr_br_zombie_con_comp_usable_prematch", 0 );
    fulton_create( var_0, var_1 );

    if ( !getdvarint( "scr_br_enable_zai_button_in_prematch", 0 ) )
        scripts\mp\flags::gameflagwait( "prematch_done" );

    var_0 = getdvarint( "scr_br_zombie_con_comp_screen", 2 );
    var_1 = getdvarint( "scr_br_zombie_con_comp_usable", 0 );
    fulton_create( var_0, var_1 );
}

fulton_create( var_0, var_1 )
{
    level._id_136A2._id_12186 = var_0;

    foreach ( var_3 in level._id_136A2.friendly_hvi_vehicle_extra_riders )
    {
        var_3 notify( "containmentComputersScreenRestore" );
        fulton_crate_model_playclosedidle( var_3, var_0, var_1 );
    }
}

fulton_crate_model_playclosedidle( var_0, var_1, var_2 )
{
    var_0._id_12187 = var_1;
    var_3 = level._id_136A2._id_12185[var_1];
    var_0 setscriptablepartstate( "containment_computer_screen", var_3 );

    if ( isdefined( var_2 ) )
    {
        var_0._id_130D5 = var_2;
        var_4 = level._id_136A2._id_130D4[var_2];
        var_0 setscriptablepartstate( "containment_computer_usable", var_4 );

        if ( level._id_136A2._id_12522 )
            var_0 setscriptablepartstate( "containment_computer_not_usable", var_4 );
    }
}

fulton_destroy( var_0, var_1, var_2, var_3, var_4 )
{
    if ( isdefined( level.br_circle ) )
        var_5 = 2;
    else
        var_5 = 3;

    var_3 setclientomnvar( "ui_br_purchase_file_override", var_5 );
    var_3 thread scripts\mp\gametypes\br_armory_kiosk.gsc::_runpurchasemenu( var_0, 1 );
    var_3 waittill( "purchase_menu_closed", var_6 );

    if ( var_6 == 1 )
        fulton_actors_players( var_0 );
}

fulton_actors( var_0 )
{
    var_1 = level.teamdata[var_0]["players"];

    foreach ( var_3 in var_1 )
        fulton_ac130_model( var_3 );
}

fulton_ac130_model( var_0 )
{
    if ( !isdefined( var_0.clean_up_vandalize ) )
        return;

    if ( var_0.clean_up_vandalize.classname != "scriptable_containment_computer_01_screen_scripted" )
        return;

    var_0 notify( "force_exit" );
}

fulton_actors_players( var_0 )
{
    if ( var_0._id_12187 <= 1 )
        return;

    fulton_crate_model_playclosedidle( var_0, var_0._id_12187 - 1 );
    fulton_check_for_moving_platform( var_0 );
}

fulton_check_for_moving_platform( var_0 )
{
    var_0 notify( "containmentComputersScreenRestore" );
    var_0 endon( "containmentComputersScreenRestore" );

    while ( var_0._id_12187 < level._id_136A2._id_12186 )
    {
        wait( level._id_136A2._id_12188 );
        fulton_crate_model_playclosedidle( var_0, var_0._id_12187 + 1 );
    }
}

fulton_deletenextframe( var_0 )
{
    var_1 = var_0 scripts\mp\gametypes\br_public.gsc::player_give_intel_3_ks( "brloot_access_card_green" );

    foreach ( var_3 in level._id_136A2.friendly_hvi_vehicle_extra_riders )
    {
        if ( var_1 )
        {
            var_3 enablescriptablepartplayeruse( "containment_computer_usable", var_0 );
            var_3 disablescriptablepartplayeruse( "containment_computer_not_usable", var_0 );
            continue;
        }

        var_3 disablescriptablepartplayeruse( "containment_computer_usable", var_0 );
        var_3 enablescriptablepartplayeruse( "containment_computer_not_usable", var_0 );
    }
}

tv_station_fastrope_two_infil_rider_start_targetname( var_0 )
{
    var_1 = self;

    if ( !isdefined( level._id_13693 ) )
        return;

    if ( !isdefined( var_0 ) )
        return;

    if ( var_0 == "brloot_access_card_green" )
    {
        var_2 = 225000000;

        for ( var_3 = 0; var_3 < level._id_13693.deletex1stashhud.size; var_3++ )
        {
            if ( distancesquared( level._id_13693.denyascendmessagelaststand[var_3].origin, var_1.origin ) < var_2 )
            {
                scripts\mp\objidpoolmanager::objective_playermask_addshowplayer( level._id_13693.deletex1stashhud[var_3], var_1 );
                return;
            }
        }
    }
}

unset_relic_nuketimer( var_0 )
{
    if ( !isdefined( level._id_13693 ) )
        return;

    if ( !isdefined( var_0 ) )
        return;

    if ( var_0 == "brloot_access_card_green" )
    {
        foreach ( var_2 in level._id_13693.deletex1stashhud )
            scripts\mp\objidpoolmanager::objective_playermask_hidefrom( var_2, self );
    }
}

_id_12E72()
{
    var_0 = getentitylessscriptablearrayinradius( "scriptable_scriptable_test_victor_event_button", "classname" );

    if ( !getdvarint( "scr_br_enable_zai_button_in_prematch", 0 ) )
        scripts\mp\flags::gameflagwait( "prematch_fade_done" );

    wait 4;

    foreach ( var_2 in var_0 )
    {
        if ( var_2.targetname == level._id_136C4 )
        {
            var_2 setscriptablepartstate( "button", "usable" );
            var_3 = anglestoforward( var_2.angles );
            var_2._id_12184 = easepower( "scriptable_test_victor_event_button_screen", var_2.origin + var_3, var_2.angles );
            var_2 _id_12E70();
        }
    }
}

_id_12E70()
{
    if ( isdefined( self._id_12184 ) )
        self._id_12184 setscriptablepartstate( "screen", "green" );
}

_id_12E6F()
{
    if ( isdefined( self._id_12184 ) )
        self._id_12184 setscriptablepartstate( "screen", "red_100" );
}

_id_136B6()
{
    level._id_13693.demo_update_hint_logic = scripts\engine\utility::getstructarray( "zombie_cache_loc", "targetname" );

    switch ( level.script )
    {
        case "mp_br_mechanics":
            break;
        default:
            break;
    }

    level._id_13693.denyascendmessagelaststand = [];
    level._id_13693.deletex1stashhud = [];
    scripts\mp\flags::gameflagwait( "prematch_done" );

    foreach ( var_1 in level._id_13693.demo_update_hint_logic )
    {
        if ( isdefined( var_1.script_noteworthy ) && level._id_136C4 != var_1.script_noteworthy )
            continue;

        if ( !isdefined( var_1.angles ) )
            var_1.angles = ( 0, 0, 0 );

        var_2 = easepower( "br_loot_cache_zom", var_1.origin, var_1.angles );
        var_2.dmztut_endgametransition = ::_id_136B5;
        var_2._id_13100 = ::_id_136B7;
        var_2._id_121C0 = "cache_zom";
        var_2.spawn_smoke_bombers = 1;
        var_3 = scripts\mp\objidpoolmanager::requestobjectiveid( 1 );

        if ( var_3 != -1 )
        {
            scripts\mp\objidpoolmanager::objective_add_objective( var_3, "current", var_2.origin + ( 0, 0, 15 ), "ui_mp_br_mapmenu_icon_zmb_event_dropbox" );
            scripts\mp\objidpoolmanager::update_objective_setbackground( var_3, 1 );
            scripts\mp\objidpoolmanager::objective_playermask_hidefromall( var_3 );
            level._id_13693.deletex1stashhud[level._id_13693.deletex1stashhud.size] = var_3;
        }
        else
        {

        }

        level._id_13693.denyascendmessagelaststand[level._id_13693.denyascendmessagelaststand.size] = var_2;
    }
}

_id_136B4( var_0, var_1, var_2 )
{
    var_3 = spawnstruct();
    var_3.origin = var_0;
    var_3.angles = var_1;
    var_3.script_noteworthy = var_2;
    level._id_13693.demo_update_hint_logic[level._id_13693.demo_update_hint_logic.size] = var_3;
}

_id_136B5( var_0, var_1, var_2, var_3, var_4 )
{
    if ( !var_3 scripts\mp\gametypes\br_public.gsc::player_give_intel_3_ks( "brloot_access_card_green" ) )
    {
        var_3 scripts\mp\hud_message::showerrormessage( "MP_BR_INGAME/ZOMBIE_CACHE_DENY_CARD" );
        var_3 playlocalsound( "br_pickup_deny" );
        return 0;
    }

    return 1;
}

_id_136B7( var_0, var_1, var_2, var_3, var_4 )
{
    var_3 scripts\mp\gametypes\br_pickups.gsc::_id_11EC0();

    if ( !isdefined( var_0._id_121C1 ) )
        var_0._id_121C1 = 0;
    else
        var_0._id_121C1 = ( var_0._id_121C1 + 1 ) % 10;

    for ( var_5 = 0; var_5 < level._id_13693.deletex1stashhud.size; var_5++ )
    {
        if ( var_0 == level._id_13693.denyascendmessagelaststand[var_5] )
            scripts\mp\objidpoolmanager::objective_playermask_hidefrom( level._id_13693.deletex1stashhud[var_5], var_3 );
    }

    ai_juggernaut_think( var_0.origin );

    if ( getdvarint( "scr_bombardment_killswitch", 0 ) == 0 )
        var_0 scripts\mp\gametypes\br.gsc::spawninfo( "brloot_access_card_purple" );

    wait( getdvarfloat( "scr_br_zombie_cache_wait", 5.0 ) );
    var_0 setscriptablepartstate( var_1, "closing" );
}

ai_juggernaut_think( var_0 )
{
    var_1 = getdvarint( "scr_br_zombie_cache_delete_nearby_loot_radius", 128 );

    if ( var_1 == 0 )
        return;

    var_2 = canceljoins( undefined, undefined, var_0, var_1 );

    if ( isdefined( var_2 ) )
    {
        foreach ( var_4 in var_2 )
        {
            if ( var_4.type == "br_loot_cache" || var_4.type == "br_loot_cache_lege" || var_4.type == "brloot_escape_radio" || var_4.type == "br_cargotrain" || var_4.type == "br_cargotrain_engine" )
                continue;

            if ( var_4 getscriptableisreserved() && !isdefined( var_4.createflagstart ) )
                continue;

            scripts\mp\gametypes\br_pickups.gsc::spawn_overwatch_soldiers_01( var_4 );
        }
    }
}

_id_13695()
{
    if ( !isdefined( level._id_13693.lastteamused ) )
        level._id_13693.lastteamused = 1;

    if ( !isdefined( level._id_13693.infectparachuteheightoffset ) )
        level._id_13693.infectparachuteheightoffset = 0;

    var_0 = [];

    if ( !level._id_13693.infectparachuteheightoffset )
    {
        if ( level._id_13693.lastteamused )
        {
            var_0 = _id_13697( "boat_doors_round1" );
            level._id_13693.lastteamused = 0;
        }
        else
        {
            var_0 = _id_13697( "boat_doors_round2" );
            level._id_13693.infectparachuteheightoffset = 1;
        }

        if ( isdefined( var_0 ) )
        {
            foreach ( var_2 in var_0 )
                thread _id_13699( var_2 );
        }
    }
}

_id_13694()
{
    var_0 = getentarray( "boat_doors_round1", "script_noteworthy" );
    var_0 scripts\engine\utility::array_combine( var_0, getentarray( "boat_doors_round2", "script_noteworthy" ) );

    foreach ( var_2 in var_0 )
        var_2 delete();
}

clearsoundsubmixfadetoblackamb()
{
    wait 5.0;
    scripts\mp\utility\sound::apc_target_enemies( "br_zmb_sfx" );
}
